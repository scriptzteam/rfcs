<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-ietf-stir-passport-rcd-26" number="9795" submissionType="IETF" category="std" consensus="true" tocInclude="true" sortRefs="true" symRefs="true"
updates="" obsoletes="" xml:lang="en" version="3">

  <front>
    <title abbrev="RCD">Personal Assertion Token (PASSporT) Extension for Rich Call Data</title>
    <seriesInfo name="RFC" value="9795"/>
    <author initials="C." surname="Wendt" fullname="Chris Wendt">
      <organization>Somos Inc.</organization>
      <address>
        <email>chris-ietf@chriswendt.net</email>
      </address>
    </author>
    <author initials="J." surname="Peterson" fullname="Jon Peterson">
      <organization>TransUnion</organization>
      <address>
        <email>jon.peterson@transunion.com</email>
      </address>
    </author>
    <date year="2025" month="July"/>
    <area>art</area>
    <workgroup>stir</workgroup>
    <keyword>Identity</keyword>
    <abstract>
      <t>This document extends Personal Assertion Token (PASSporT), a token for conveying cryptographically signed call information about personal communications, to include rich metadata about a call and caller that can be signed and integrity protected, transmitted, and subsequently rendered to the called party. This framework is intended to include and extend caller- and call-specific information beyond human-readable display name, comparable to the "Caller ID" function common on the telephone network. It is also enhanced with an integrity mechanism that is designed to protect the authoring and transport of this information for different authoritative use cases.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="introduction">
      <name>Introduction</name>
      <t>PASSporT <xref target="RFC8225"/> is a token format based on JSON Web Token (JWT) <xref target="RFC7519"/> for conveying cryptographically signed information about the parties involved in personal communications; it is used to convey a signed assertion of the identity of the participants in real-time communications established via a protocol like SIP <xref target="RFC8224"/>. The Secure Telephone Identity Revisited (STIR) problem statement <xref target="RFC7340"/> declared securing the display name of callers outside of STIR's initial scope. This document extends the use of JWT and PASSporT in the overall STIR framework by defining a PASSporT extension and the associated STIR procedures to protect additional caller- and call-related information.  This is information beyond the calling party originating identity (e.g., telephone number or SIP URI) that is intended to be rendered to assist a called party in determining whether to accept or trust incoming communications. This includes information such as the name of the person or entity on one side of a communications session, for example, the traditional "Caller ID" of the telephone network along with related display information that would be rendered to the called party during alerting or potentially used by an automaton to determine whether and how to alert a called party to a call and whom is calling.</t>
      <t>Traditional telephone network signaling protocols have long supported delivering a 'calling name' from the originating side, though in practice the terminating side is often left to determine a name from the calling party number by consulting a local address book or an external database. SIP, for example, similarly can carry this information in a display-name in the From header field value (or alternatively the Call-Info header field) from the originating to terminating side. In this document, we utilize the STIR framework to more generally extend the assertion of an extensible set of identity information not limited to but including calling name.</t>
      <t>This document extends PASSporT to provide cryptographic protection for the "display-name" field of SIP requests, or similar name fields in other protocols, as well as further "rich call data" (RCD) about the caller, which includes the contents of the Call-Info header field or other data structures that can be added to the PASSporT. In addition, <xref target="use"/> describes use cases that enable external third-party authorities to convey rich information associated with a calling number via an "rcd" PASSporT while clearly identifying the third-party as the source of the Rich Call Data information.
Finally, this document describes how to preserve the integrity of the RCD in scenarios where there may be non-authoritative users initiating and signing RCD, therefore limiting a PASSporT and the RCD claims it asserts via certificate-level controls.</t>
    </section>
    <section anchor="terminoloygy">
      <name>Terminology</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
    </section>
    <section anchor="overview-of-the-use-of-the-rich-call-data-passport-extension">
      <name>Overview of the Use of the Rich Call Data PASSporT Extension</name>
      <t>This document defines Rich Call Data (RCD), which is a PASSporT extension <xref target="RFC8225"/> that defines an extensible claim for asserting information about the call beyond the telephone number. This includes more detailed information about the calling party, calling number, or the purpose of the call. There are many use cases that this document describes around the entities responsible for the signing and integrity of this information, whether it is the entity that originates a call, a service provider acting on behalf of a caller, or when third-party services may be authoritative over the RCD on behalf of the caller. In general, PASSporT <xref target="RFC8225"/> has been defined to be independent of the communications protocol, but its initial usage as detailed in <xref target="RFC8224"/> is with the SIP protocol <xref target="RFC3261"/>.  There are many SIP-specific references and definitions in this document, but future specifications may extend the usage of RCD PASSporTs and claims to other protocol-specific usage and definitions.</t>
      <t>The RCD associated with the identity of the calling party described in this document is of two main categories. The first data is a more traditional set of information about a caller associated with "display-name" in SIP <xref target="RFC3261"/>, typically a textual description of the caller, or alternate presentation numbers often used in the From header field <xref target="RFC3261"/> or P-Asserted-Identity header field <xref target="RFC3325"/>, or an icon associated with the caller. The second category is a set of RCD that is defined as part of the jCard definitions or extensions to that data. <xref target="RFC9796"/> describes the optional use of jCard in the Call-Info header field as RCD with the "jcard" Call-Info purpose token. Either or both of these two types of data can be incorporated into an "rcd" claim as defined in this document.</t>
      <t>Additionally, in relation to the description of the specific communications event itself (versus the identity description in the previous paragraph), <xref target="RFC9796"/> also describes a "call-reason" parameter intended for description of the intent or reason for a particular call. A new PASSporT claim "crn", or call reason, can contain a string that describes the intent of the call. This claim is intentionally kept separate from the "rcd" claim because it is envisioned that call reason is not the same as information associated with the caller and may change on a more frequent, per-call basis.</t>
    </section>
    <section anchor="rcdintegrity">
      <name>Overview of Rich Call Data Integrity</name>
      <t>When incorporating call data that represents a user, even in traditional calling name services today, often there are policy and restrictions around what data elements are allowed to be used. Whether preventing offensive language or icons, enforcing uniqueness, notifying about potential trademark or copyright violations, or enforcing other policies, there might be the desire to pre-certify or "vet" the specific use of RCD. 
   This document defines a mechanism that allows for a direct or 
   indirect party that (a) enforces
   the policies to approve or certify the content, (b) creates a
   cryptographic digest that can be used to validate that data, and
   (c) applies a constraint in the certificate to allow the recipient and
   verifier to validate that the specific content of the RCD is as
   intended at its creation and its approval or certification.</t>
      <t>There are two mechanisms that are defined to accomplish that for two distinct categories of purposes. The first of the mechanisms include the definition of an integrity claim. The RCD integrity mechanism is a process of generating a cryptographic digest for each resource referenced by a URI within a claim value (e.g., an image file referenced by "jcd" or a jCard referenced by "jcl"). This mechanism is inspired by and based on the W3C Subresource Integrity specification <xref target="W3C-SubresourceIntegrity"/>. The second of the mechanisms uses the capability called JWT Claim Constraints, defined in <xref target="RFC8226"/> and extended in <xref target="RFC9118"/>. The JWT Claim Constraints specifically guide the verifier within the certificate used to compute the signature in the PASSporT for the inclusion (or exclusion) of specific claims and their values, so that the content intended by the signer can be verified to be accurate.</t>
      <t>Both of these mechanisms, integrity digests and JWT Claims Constraints, can be used together or separately depending on the intended purpose. The first category of purpose is whether the RCD conveyed in the PASSporT claims is passed by value or passed by reference; i.e., is the information contained in the PASSporT claims and therefore integrity protected by the PASSporT signature, or is the information contained in an external resource referenced by a URI in the PASSporT? The second category of purpose is whether the signer is authoritative or has responsibility for the accuracy of the RCD based on the policies of the ecosystem the "rcd" PASSporTs or "rcd" claims are being used.</t>
      <t>The following table provides an overview of the framework for how integrity should be used with RCD. ("Auth" represents "authoritative" in this table.)</t>

<table>
  <thead>
    <tr>
      <th>Modes</th>
      <th>No URI refs</th>
      <th>Includes URI refs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Auth</th>
      <td>1: No integrity req</td>
      <td>2: RCD Integrity</td>
    </tr>
    <tr>
      <th>Non-Auth</th>
      <td>3: JWT Claim Const.</td>
      <td>4: RCD Integ. / JWT Claim Const.</td>
    </tr>
  </tbody>
</table>

      <t>The first and simplest mode is exclusively for when all RCD content is directly included as part of the claims (i.e., no URIs referencing external content are included in the content) and when the signer is authoritative over the content. In this mode, integrity protection is not required, and the set of claims is simply protected by the signature of the standard PASSporT <xref target="RFC8225"/> and SIP identity header <xref target="RFC8224"/> procedures. The second mode is an extension of the first where the signer is authoritative, and an "rcd" claim contents include a URI identifying external resources. In this mode, an RCD Integrity or "rcdi" claim <bcp14>MUST</bcp14> be included. This integrity claim is defined later in this document and provides a digest of the "rcd" claim content so that, particularly for the case where there are URI references in the RCD, the content of that RCD can be comprehensively validated that it was received as intended by the signer of the PASSporT.</t>
      <t>The third and fourth modes cover cases where there is a different authoritative entity responsible for the content of the RCD, separate from the signer of the PASSporT itself, allowing the ability, in particular when delegating signing authority for PASSporT, for agreed or vetted content to be included in or referenced by the RCD claim contents. The primary framework for allowing the separation of authority and the signing of PASSporTs by non-authorized entities is detailed in <xref target="RFC9060"/>, although other cases may apply. As with the first and second modes, the third and fourth modes differ with the absence or inclusion of referenced external content using URIs.</t>
    </section>
    <section anchor="rcd_define">
      <name>"rcd" PASSporT Claim: Definition and Usage</name>
      <section anchor="syntax">
        <name>PASSporT "rcd" Claim</name>
        <t>This document defines a new JSON Web Token claim for "rcd", Rich Call Data, the value of which is a JSON object that can contain one or more key value pairs. This document defines a default set of key values.</t>
        <section anchor="nam-key">
          <name>"nam" key</name>
          <t>The "nam" key value is a display name, associated with the originator of personal communications, which may, for example, match the display-name component of the From header field value of a SIP request <xref target="RFC3261"/> or alternatively of the P-Asserted-Identity header field value <xref target="RFC3325"/>, or a similar field in other PASSporT using protocols. This key <bcp14>MUST</bcp14> be included once as part of the "rcd" claim value JSON object. The key syntax of "nam" <bcp14>MUST</bcp14> follow the display-name ABNF given in <xref target="RFC3261"/>. If there is no string associated with a display name, the claim value <bcp14>MUST</bcp14> be an empty string.</t>
        </section>
        <section anchor="apn-key">
          <name>"apn" key</name>
          <t>The "apn" key value is an optional alternate presentation number associated with the originator of personal communications, which may, for example, match the user component of the From header field value of a SIP request (in cases where a network number is carried in the P-Asserted-Identity <xref target="RFC3325"/>), or alternatively of the Additional-Identity header field value <xref target="TS.3GPP.24.229"/>, or a similar field in other PASSporT-using protocols. Its intended semantics are to convey a number that the originating user is authorized to show to called parties in lieu of their default number, such as cases where a remote call agent uses the main number of a call center instead of their personal telephone number. The "apn" key value is a canonicalized telephone number per <xref section="8.3" target="RFC8224" sectionFormat="comma"/>. If present, this key <bcp14>MUST</bcp14> be included once as part of the "rcd" claim value JSON object.</t>
          <t>The use of the optional "apn" key is intended for cases where the signer of an "rcd" PASSporT or "rcd" claims authorizes the use of an alternate presentation number by the user. How the signer determines that a user is authorized to present the number in question is a policy decision outside the scope of this document. However, the vetting of the alternate presentation number should follow the same level of vetting as telephone identities or any other information contained in an "rcd" PASSporT or "rcd" claims.
The use of the "apn" key is intended as an alternative to conveying the presentation number in the "tel" key value of a jCard, in situations where no other rich jCard data needs to be conveyed with the call. Only one "apn" key may be present. "apn" <bcp14>MUST</bcp14> be used when it is the intent of the caller or signer to display the alternate presentation number even if "jcd" or "jcl" keys are present in a PASSporT with a "tel" key value.</t>
        </section>
        <section anchor="icn-key">
          <name>"icn" key</name>
          <t>The "icn" key value is an optional HTTPS URL reference to an image resource that can be used to pictorially represent the originator of personal communications. This icon key value should be used as a base or default method of associating an image with a calling party.</t>
          <t>When being used for SIP <xref target="RFC3261"/>, this claim key value is used to protect the Call-Info header field with a purpose parameter value of "icon" as described in <xref section="20.9" target="RFC3261"/>.  For example:</t>
          <artwork><![CDATA[
Call-Info: <http://wwww.example.com/alice/photo.jpg>; 
  purpose=icon
]]></artwork>
          <t>Note that <xref target="RFC9796"/> extends the specific usage of "icon" in SIP in the context of the larger rich call data framework with specific guidance on referencing images and image types, sizes, and formats.</t>
          <t>It should be also noted that with jCard, as described for "jcd" and "jcl" key values (Sections <xref target="jcd-key" format="counter"/> and <xref target="jcl-key" format="counter"/>) and in <xref target="RFC9796"/>, there are alternative ways of including photos and logos as HTTPS URL references. The "icn" key should be considered a base or default image, and jCard usage should be considered for profiles and extensions that provide more direct guidance on the usage of what each image type represents for the proper rendering to end users.</t>
        </section>
        <section anchor="jcd-key">
          <name>"jcd" key</name>
          <t>The "jcd" key value is defined to contain a jCard JSON object <xref target="RFC7095"/>. The jCard is defined in this specification as an extensible object format used to contain RCD information about the call initiator. This object is intended to directly match the Call-Info header field value defined in <xref target="RFC9796"/> with a type of "jcard", where the format of the jCard and properties used should follow the normative usage and formatting rules and procedures in that document. It is an extensible object where the calling party can provide both the standard types of information defined in jCard or can use the built-in extensibility of the jCard specification to add additional information. The "jcd" key is optional. Either a "jcd" or "jcl" <bcp14>MAY</bcp14> appear in the "rcd" claim, but not both.</t>
          <t>The jCard object value for "jcd" <bcp14>MUST</bcp14> be a jCard JSON object that <bcp14>MAY</bcp14> have URI-referenced content, but that URI-referenced content <bcp14>MUST NOT</bcp14> further reference URIs. Future specifications may extend this capability, but <xref target="RFC9796"/> constrains the security properties of RCD information and the integrity of the content referenced by URIs.</t>
          <aside><t>Note: Even though we refer to <xref target="RFC9796"/> as the definition of the jCard properties for usage in "rcd" claims, using the Call-Info header field with RCD information in a SIP request beyond the use of identity header as defined in this document is not required. Identity header fields are generally encouraged for all transport of authenticated and protected RCD information over Network-to-Network Interfaces (NNIs) between untrusted parties or over untrusted networks. The use of Call-Info header fields to carry RCD information as defined in <xref target="RFC9796"/> is suggested for use in trusted networks relationships, generally for User-Network Interfaces (UNIs).</t></aside>
        </section>
        <section anchor="jcl-key">
          <name>"jcl" key</name>
          <t>The "jcl" key value is an HTTPS URL that refers to a jCard JSON object <xref target="RFC7095"/> on a web server. The web server <bcp14>MUST</bcp14> use the media type for JSON text as application/json with a default encoding of UTF-8 <xref target="RFC8259"/>. This link may correspond to the Call-Info header field value defined in <xref target="RFC9796"/> with a type of "jcard". As also defined in <xref target="RFC9796"/>, the format of the jCard and properties used should follow the normative usage and formatting rules and procedures. The "jcl" key is optional. The "jcd" or "jcl" keys <bcp14>MAY</bcp14> only appear once in the "rcd" claim but <bcp14>MUST</bcp14> be mutually exclusive.</t>
          <t>The jCard object referenced by the URI value for "jcl" <bcp14>MUST</bcp14> be a jCard JSON object that <bcp14>MAY</bcp14> have URI-referenced content, but that URI-referenced content <bcp14>MUST NOT</bcp14> further reference URIs. Future specifications may extend this capability, but <xref target="RFC9796"/> constrains the security properties of RCD information and the integrity of the content referenced by URIs.</t>
        </section>
      </section>
    </section>
    <section anchor="rcdi_define">
      <name>"rcdi" PASSporT Claim: Definition and Usage</name>
      <t>The "rcdi" claim is included for the second and fourth modes described in the integrity overview (<xref target="rcdintegrity"/>). "rcdi" and "rcd" claims <bcp14>MAY</bcp14> each appear once in a PASSporT, but if "rcdi" is included, the "rcd" <bcp14>MUST</bcp14> be present correspondingly. The value of the "rcdi" claim is a JSON object that is defined as follows.</t>
      <t>The claim value of the "rcdi" claim key is a JSON object with a set of JSON key/value pairs. Each "rcdi" claim key/value pair corresponds to each of the elements of the "rcd" claim object that require integrity protection with an associated digest over the content referenced by the key string. The individual digest of different elements of the "rcd" claim data and URI-referenced external content is kept specifically separate to allow the ability to verify the integrity of only the elements that are ultimately retrieved, downloaded, or rendered to the end user.</t>
      <t>The key value references a specific object within the "rcd" claim value using a JSON pointer defined in <xref target="RFC6901"/> with a minor additional rule to support URI references to external content that include JSON objects themselves, for the specific case of the use of "jcl", defined in <xref target="jcl_element"/>. JSON pointer syntax is the key value that documents exactly the part of JSON that is used to generate the digest that produces the resulting string that makes up the value for the corresponding key. Detailed procedures are provided below, but an example "rcdi" is provided here:</t>
      <sourcecode type="json"><![CDATA[
"rcdi" : {
  "/jcl": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
  "/jcl/1/2/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI"
}
]]></sourcecode>
      <t>The values of each key/value pair consists of a digest across one of the following objects referenced by the JSON pointer key:</t>
      <ul spacing="normal">
        <li>the content inline to the referenced object, </li>
        <li>the content of a resource referenced by an inline URI object, or</li>
        <li>the content of a resource specified by a URI that is in embedded in content specified by an inline URI object (e.g., "jcl")</li>
      </ul>
      <t>This is combined with a string that defines the cryptographic algorithm used to generate the digest. RCD implementations <bcp14>MUST</bcp14> support the hash algorithms SHA-256, SHA-384, and SHA-512.  These hash algorithms are identified by "sha256", "sha384", and "sha512", respectively.  SHA-256, SHA-384, and SHA-512 are part of the SHA-2 set of cryptographic hash functions <xref target="RFC6234"/> defined by the US National Institute of Standards and Technology (NIST).  Implementations <bcp14>MAY</bcp14> support additional recommended hash algorithms in <xref target="IANA-COSE-ALG"/>, that is, the hash algorithms with "Yes" in the "Recommended" column of the IANA registry.  Hash algorithm identifiers <bcp14>MUST</bcp14> use only lowercase letters, and they <bcp14>MUST NOT</bcp14> contain hyphen characters. The character following the algorithm string <bcp14>MUST</bcp14> be a hyphen character ("-", %x2D). The subsequent characters are the base64 encoded <xref target="RFC4648"/> digest of a canonicalized and concatenated string or binary data based on the JSON pointer referenced elements of the "rcd" claim or the URI-referenced content contained in the claim. The next section covers the details of the determination of the input string used to determine the digest.</t>

      <section anchor="creation-of-the-rcd-element-digests">
        <name>Creation of the "rcd" Element Digests</name>
        <t>"rcd" claim objects can contain "nam", "apn", "icn", "jcd", or "jcl" keys as part of the "rcd" JSON object claim value. This document defines the use of JSON pointer <xref target="RFC6901"/> as a mechanism to reference specific "rcd" claim elements.</t>
        <t>In order to facilitate proper verification of the digests and to determine whether the "rcd" elements or content referenced by URIs were modified, the input to the digest must be completely deterministic at three points in the process. First, it must be deterministic at the certification point when the content is evaluated to conform to the application policy and when the JWT Claim Constraints are applied to the certificate containing the digest. Second, when the call is signed at the Authentication Service, there may be a local policy to verify that the provided "rcd" claim corresponds to each digest. Third, when the "rcd" data is verified at the verification service, the verification is performed for each digest by constructing the input digest string for the element being verified and referenced by the JSON pointer string.</t>
        <t>The procedure for the creation of each "rcd" element digest string corresponding to a JSON pointer string key is as follows.</t>
        <ol spacing="normal" type="1"><li>The JSON pointer either refers to a value that is a part or the whole of a JSON object or to a string that is a URI referencing an external resource.</li>
          <li>For a JSON value, serialize the JSON to remove all white space and line breaks.  The procedures of this deterministic JSON serialization are defined in <xref section="9" target="RFC8225" sectionFormat="comma"/>.  The resulting string is the input for the hash function.</li>
          <li>For any URI-referenced content, the bytes of the body of the HTTP response are the input for the hash function.</li>
        </ol>
        <t>Note that the digest is computed on the JSON representation of the string, which necessarily includes the beginning and ending double-quote characters.</t>
        <section anchor="nam_apn_element">
          <name>"nam" and "apn" Elements</name>
          <t>In the case of "nam" and "apn", the only allowed value is a string. For both of these key values, an "rcdi" JSON pointer or integrity digest is optional because the direct value is protected by the signature and can be constrained directly with JWT Claim Constraints.</t>
        </section>
        <section anchor="icn_element">
          <name>"icn" Elements</name>
          <t>In the case of "icn", the only allowed value is a URI value that references an image file. If the URI references externally linked content, there <bcp14>MUST</bcp14> be a JSON pointer and digest entry for the content in that linked resource. When creating a key/value representing "icn", the key is the JSON pointer string "/icn", and the digest value string is created using the image file byte data referenced in the URI.</t>
        </section>
        <section anchor="jcd_element">
          <name>"jcd" Elements</name>
          <t>In the case of "jcd", the value associated is a jCard JSON object, which happens to be a JSON array with sub-arrays. JSON pointer notation uses numeric indices into elements of arrays, including when those elements are arrays themselves.</t>
          <t>As an example, we have the following "rcd" claim:</t>
          <sourcecode type="json"><![CDATA[
"rcd": {
  "jcd": ["vcard",
    [ ["version",{},"text","4.0"],
      ["fn",{},"text","Q Branch"],
      ["org",{},"text","MI6;Q Branch Spy Gadgets"],
      ["photo",{},"uri",
        "https://example.com/photos/quartermaster-256x256.png"],
      ["logo",{},"uri",
        "https://example.com/logos/mi6-256x256.jpg"],
      ["logo",{},"uri",
        "https://example.com/logos/mi6-64x64.jpg"]
    ]
  ],
  "nam": "Q Branch Spy Gadgets"
}
]]></sourcecode>
          <t>In order to use a JSON pointer to refer to the URIs, the following example "rcdi" claim includes a digest for the entire "jcd" array string as well as three additional digests for the URIs, where, as defined in <xref target="RFC6901"/>, zero-based array indices are used to reference the URI strings.</t>
          <sourcecode type="json"><![CDATA[
"rcdi": {
  "/jcd": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
  "/jcd/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
  "/jcd/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
  "/jcd/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
]]></sourcecode>
          <t>The use of a JSON pointer and integrity digest for the "jcd" claim key and value is optional. The "jcd" value is the directly included jCard array; it can be protected by the signature and can be constrained directly with JWT Claim Constraints.  However, for data length reasons (as with "icn" above) or more importantly for potential privacy and/or security considerations with a publicly accessible certificate, the use of the "rcdi" JSON pointer and integrity digest as the constraint value in JWT Claim Constraints over the jCard data is <bcp14>RECOMMENDED</bcp14>.</t>
          <t>It is important to remember the array indices for JSON pointer are dependent on the order of the elements in the jCard. The use of digest for the "/jcd" corresponding to the entire jCard array string can be included as a redundant mechanism to avoid any possibility of substitution, insertion attacks, or other potential techniques to undermine integrity detection.</t>
          <t>Each URI referenced in the jCard array string <bcp14>MUST</bcp14> have a corresponding JSON pointer string key and digest value.</t>
        </section>
        <section anchor="jcl_element">
          <name>"jcl" Elements</name>
<t>
   In the case of the use of a "jcl" URI reference to an external jCard,
   the procedures are similar to "jcd" with the minor
   modification to the JSON pointer, where "/jcl" is used to refer to the
   external jCard array string.  Also, any following numeric array indices
   added to the "jcl" (e.g., "/jcl/1/2/3") are treated as if the
   external content referenced by the jCard were directly part of the
   overall "rcd" claim JSON object. The following example illustrates a "jcl" version of the above "jcd" example.</t>
          <sourcecode type="json"><![CDATA[
"rcd": {
  "jcl": "https://example.com/qbranch.json",
  "nam": "Q Branch Spy Gadgets"
},
"rcdi": {
  "/jcl": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
  "/jcl/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
  "/jcl/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
  "/jcl/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
}
]]></sourcecode>
          <t>The "rcdi" <bcp14>MUST</bcp14> have a "/jcl" key value and digest value to protect the referenced jCard object, and each URI referenced in the referenced jCard array string <bcp14>MUST</bcp14> have a corresponding JSON pointer string key and digest value.</t>
          <t>The following is the example contents of the resource pointed to by https://example.com/qbranch.json; it is used to calculate the above digest for "/jcl"</t>
          <sourcecode type="json"><![CDATA[
["vcard",
  [ ["version",{},"text","4.0"],
    ["fn",{},"text","Q Branch"],
    ["org",{},"text","MI6;Q Branch Spy Gadgets"],
    ["photo",{},"uri",
      "https://example.com/photos/quartermaster-256x256.png"],
    ["logo",{},"uri",
      "https://example.com/logos/mi6-256x256.jpg"],
    ["logo",{},"uri",
      "https://example.com/logos/mi6-64x64.jpg"]
  ]
]
]]></sourcecode>
        </section>
      </section>
      <section anchor="jwt-claim-constraints-for-rcd-claims">
        <name>JWT Claim Constraints for "rcd" Claims</name>
        <t>When using JWT Claim Constraints for "rcd" claims, the procedure when creating the signing certificate should adhere to the following guidelines.</t>
        <t>The "permittedValues" for the "rcd" claim <bcp14>MAY</bcp14> contain a single entry or optionally <bcp14>MAY</bcp14> contain multiple entries with the intent of supporting cases where the certificate holder is authorized to use different sets of rich call data corresponding to different call scenarios.</t>
        <t>Only including "permittedValues" for "rcd", with no "mustInclude", provides the ability for the construction a valid PASSporT that can either have no "rcd" claim within or only the set of constrained "permittedValues" values for an included "rcd" claim.</t>
      </section>
      <section anchor="jwt-claim-constraints-usage-for-rcd-and-rcdi-claims">
        <name>JWT Claim Constraints for "rcd" and "rcdi" Claims</name>
<t>The use of JWT Claim Constraints with an "rcdi" claim is for cases where URI-referenced content is to be protected by the authoritative certificate issuer. The objective for the use of JWT Claim Constraints for the combination of both "rcd" and "rcdi" claims is to constrain the signer to only construct the "rcd" and "rcdi" claims inside a PASSporT to contain and reference only a predetermined set of content. Once both the contents of the "rcd" claim and any referenced content are certified by the party that is authoritative for the certificate being issued to the signer, the "rcdi" claim is constructed and linked to the STIR certificate associated with the signature in the PASSporT via the JWT Claim Constraints extension as defined in <xref section="8" target="RFC8226" sectionFormat="comma"/> and extended in <xref target="RFC9118"/>. It should be recognized that the "rcdi" set of digests is intended to be unique for only a specific combination of "rcd" content and URI-referenced external content, and therefore the set provides a robust integrity mechanism for an authentication service being performed by a non-authoritative party. 
   For example, this may be used with delegate certificates [RFC9060]
   for the signing of calls by the calling party directly, even though
   the "authorized party" is not necessarily the subject of a STIR
   certificate.</t>
        <t>For the cases where both "rcd" and "rcdi" claims should always be included in the PASSporT, the certificate JWT Claims Constraint extension <bcp14>MUST</bcp14> include both of the following:</t>
        <ul spacing="normal">
          <li>a "mustInclude" for the "rcd" claim, which simply constrains the fact that an "rcd" must be included</li>
          <li>a "mustInclude" for the "rcdi" claim and a "permittedValues" equal to the created "rcdi" claim value string.</li>
        </ul>
        <t>Note that optionally the "rcd" claims may be included in the "permittedValues"; however, it is recognized that this may be redundant with the "rcdi" permittedValues because the "rcdi" digest will imply the content of the "rcd" claims themselves.</t>
        <t>The "permittedValues" for the "rcdi" claims (or "rcd" claims more generally) may contain multiple entries to support the case where the certificate holder is authorized to use different sets of RCD.</t>
      </section>
    </section>
    <section anchor="crn_define">
      <name>"crn" PASSporT Claim: Definition and Usage</name>  
      <t>This document defines a new JSON Web Token claim for "crn", Call Reason, the value of which is a single string that can contain information as defined in <xref target="RFC9796"/> and corresponding to the "call-reason" parameter for the Call-Info header. This claim is optional.</t>
      <sourcecode type="json"><![CDATA[
Example "crn" claim with "rcd":

"crn" : "For your ears only",
"rcd": { "nam": "James Bond",
         "jcl": "https://example.org/james_bond.json"}
]]></sourcecode>
      <section anchor="jwt-constraint-for-crn-claim">
        <name>JWT Constraint for "crn" Claim</name>
        <t>The integrity of the "crn" claim contents can optionally be protected by the authoritative certificate issuer using JWT Claim Constraints in the certificate. When the signer of the PASSporT intends to always include a call reason string of any value, a "mustInclude" for the "crn" claim in the JWT Claim Constraints indicates that a "crn" claim must always be present and is <bcp14>RECOMMENDED</bcp14> to be included by the certificate issuer. If the signer of the "crn" claim wants to constrain the contents of "crn", then "permittedValues" for "crn" in JWT Claim Constraints should match the contents of the allowed strings and is <bcp14>RECOMMENDED</bcp14> to be included by the certificate issuer.</t>
      </section>
    </section>
    <section anchor="rich-call-data-claims-usage-rules">
      <name>Rich Call Data Claims Usage Rules</name>
      <t>The "rcd" or "crn" claims <bcp14>MAY</bcp14> appear in any PASSporT claims object as optional elements. The creator of a PASSporT <bcp14>MAY</bcp14> also add a PASSporT extension ("ppt") value, defined in <xref section="8.1" target="RFC8225" sectionFormat="comma"/>, of "rcd" to the header of a PASSporT. In that case, the PASSporT claims <bcp14>MUST</bcp14> contain at least one "rcd" or "crn" claim (or both). Any entities verifying the PASSporT claims defined in this document are required to understand the PASSporT extension in order to process the PASSporT in question. An example PASSporT header with the PASSporT extension ("ppt") value of "rcd" included is shown as follows:</t>
      <sourcecode type=""><![CDATA[
{ "typ":"passport",
  "ppt":"rcd",
  "alg":"ES256",
  "x5u":"https://www.example.com/cert.cer" }
]]></sourcecode>
      <t>The PASSporT claims object contains the "rcd" key with its corresponding value. The value of "rcd" is an array of JSON objects, of which one, the "nam" key and value, is mandatory.</t>
      <t>After the header and claims PASSporT objects have been constructed, their signature is computed normally per the guidance in <xref target="RFC8225"/>.</t>
      <section anchor="rcd_passport_verification">
        <name>"rcd" PASSporT Verification</name>
        <t>A verifier that successfully verifies a PASSporT that contains an "rcd" claim <bcp14>MUST</bcp14> ensure the following about the PASSporT:</t>
        <ul spacing="normal">
          <li>It has a valid signature per the verification procedures detailed in <xref target="RFC8225"/>.</li>
          <li>It abides by all rules set forth in the proper construction of the claims defined in <xref target="rcd_define"/>.</li>
          <li>It abides by JWT Claims Constraint rules defined in <xref section="8" target="RFC8226" sectionFormat="comma"/> or extended by <xref target="RFC9118"/> if present in the certificate used to compute the signature in the PASSporT.</li>
        </ul>
        <t>In addition, if the "iss" claim is included in the PASSporT, verification should follow procedures described in <xref target="thirdsignverify"/>.</t>
        <t>Consistent with the verification rules of PASSporTs more generally <xref target="RFC8225"/>, if any of the above criteria is not met, relying parties <bcp14>MUST NOT</bcp14> use any of the claims in the PASSporT.</t>
      </section>
      <section anchor="rcdi-integrity-verification">
        <name>"rcdi" Integrity Verification</name>
        <t>When the "rcdi" claim exists, the verifier should verify the digest for each JSON pointer key.  Any digest string that doesn't match a generated digest <bcp14>MUST</bcp14> be considered a failure of the verification of the content referenced by the JSON pointer.</t>
        <t>If there is any issue with completing the integrity verification procedures for referenced external content, including HTTP or HTTPS errors, the referenced content <bcp14>MUST</bcp14> be considered not verified.  However, this <bcp14>SHOULD NOT</bcp14> impact the result of base PASSporT verification for claims content that is directly included in the claims of the PASSporT.</t>
        <t>As a potential optimization of verification procedures, an entity that does not otherwise need to dereference a URI from the "rcd" claim for display to the end user is <bcp14>NOT RECOMMENDED</bcp14> to unnecessarily dereference the URI solely to perform integrity verification.</t>
      </section>
      <section anchor="example-rcd-passports">
        <name>Example "rcd" PASSporTs</name>
        <t>An example of a "nam"-only PASSporT claims object is shown next (with line breaks for readability only).</t>
        <sourcecode type=""><![CDATA[
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "rcd":{"nam":"James Bond"} }
]]></sourcecode>
        <t>An example of a "nam", "apn", and "icn" using an https URI PASSporT claims object is shown next (with line breaks for readability only). Note, in this example, there is no integrity protection over the "icn" element in the "rcd" claim.</t>
        <sourcecode type=""><![CDATA[
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12155551001"]},
   "iat":1443208345,
   "rcd":{
     "apn":"12025559990",
     "icn":"https://example.com/photos/quartermaster-256x256.png",
     "nam":"Her Majesty's Secret Service" } }
]]></sourcecode>
        <t>An example of a "nam", "apn", and "icn" using data URI PASSporT claims object is shown next (with line breaks for readability only). Note, in this example, the "icn" data is incorporated directly in the "rcd" claim, and therefore separate integrity protection is not required.</t>
        <sourcecode type=""><![CDATA[
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12155551001"]},
   "iat":1443208345,
   "rcd":{
     "apn":"12025559990",
     "icn":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAY
       AAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OH
       wAAAABJRU5ErkJggg==",
     "nam":"Her Majesty's Secret Service" } }
]]></sourcecode>
        <t>An example of an "rcd" claims object that includes the "jcd" and also contains URI references to content, which require the inclusion of an "rcdi" claim and corresponding digests. Note, in this example, the "rcdi" claim includes integrity protection of the URI-referenced content.</t>
        <sourcecode type=""><![CDATA[
{
  "crn": "Rendezvous for Little Nellie",
  "orig": { "tn": "12025551000"},
  "dest": { "tn": ["12155551001"]},
  "iat": 1443208345,
  "rcd": {
    "jcd": ["vcard",
    [ ["version",{},"text","4.0"],
      ["fn",{},"text","Q Branch"],
      ["org",{},"text","MI6;Q Branch Spy Gadgets"],
      ["photo",{},"uri","https://example.com/photos/q-256x256.png"],
      ["logo",{},"uri","https://example.com/logos/mi6-256x256.jpg"],
      ["logo",{},"uri","https://example.com/logos/mi6-64x64.jpg"]
    ] ],
    "nam": "Q Branch Spy Gadgets"
  },
  "rcdi": {
   "/jcd/1/3/3":"sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
   "/jcd/1/4/3":"sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
   "/jcd/1/5/3":"sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
]]></sourcecode>

        <t>In the following PASSporT example, a jCard is linked via HTTPS URL 
   using "jcl", and a jCard file is served at a particular URL.</t>

  <t>Example jCard JSON file hosted at https://example.com/qbranch.json:</t>
        <sourcecode type="json"><![CDATA[
["vcard",
  [ ["version",{},"text","4.0"],
    ["fn",{},"text","Q Branch"],
    ["org",{},"text","MI6;Q Branch Spy Gadgets"],
    ["photo",{},"uri","https://example.com/photos/q-256x256.png"],
    ["logo",{},"uri","https://example.com/logos/mi6-256x256.jpg"],
    ["logo",{},"uri","https://example.com/logos/mi6-64x64.jpg"]
  ]
]
]]></sourcecode>
        <t>For the above referenced jCard, the corresponding PASSporT claims object would be as follows:</t>
        <sourcecode type=""><![CDATA[
{
  "crn": "Rendezvous for Little Nellie",
  "orig": {"tn": "12025551000"},
  "dest": {"tn": ["12155551001"]},
  "iat": 1443208345,
  "rcd": {
    "nam": "Q Branch Spy Gadgets",
    "jcl": "https://example.com/qbranch.json"
  },
  "rcdi": {
   "/jcl":"sha256-qCn4pEH6BJu7zXndLFuAP6DwlTv5fRmJ1AFkqftwnCs",
   "/jcl/1/3/3":"sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
   "/jcl/1/4/3":"sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
   "/jcl/1/5/3":"sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
]]></sourcecode>
        <t>An example "rcd" PASSporT that uses "nam" and "icn" keys with "rcdi" for calling name and referenced icon image content:</t>
        <sourcecode type=""><![CDATA[
{
  "crn": "Rendezvous for Little Nellie",
  "orig": {"tn": "12025551000"},
  "dest": {"tn": ["12155551001"]},
  "iat": 1443208345,
  "rcd": {
    "nam": "Q Branch Spy Gadgets",
    "icn": "https://example.com/photos/q-256x256.png"
  },
  "rcdi": {
    "/nam": "sha256-sM275lTgzCte+LHOKHtU4SxG8shlOo6OS4ot8IJQImY",
    "/icn": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4"
  }
}
]]></sourcecode>
      </section>
    </section>
    <section anchor="compact-form-of-rcd-passport">
      <name>Compact Form of "rcd" PASSporT</name>
      <section anchor="compact-form-of-the-rcd-passport-claim">
        <name>Compact Form of the "rcd" PASSporT Claim</name>
        <t>The specific usage of the compact form of an "rcd" PASSporT claim, defined in <xref section="7" target="RFC8225" sectionFormat="comma"/>, has some restrictions that will be enumerated below, but it mainly follows standard PASSporT compact form procedures. Compact form only provides the signature from the PASSporT, requiring the reconstruction of the other PASSporT claims from the SIP header fields as discussed in <xref section="4.1" target="RFC8224"/>.</t>
        <t>The reconstruction of the "nam" claim, if using the SIP protocol, should use the display-name string in the From header field. For other protocols, if there is a display name field that exists, the string should be used; otherwise, the string should be an empty string, e.g., "". The claims "jcl" and "jcd" <bcp14>MUST NOT</bcp14> be used with compact form because the integrity rules and URI reference rules defined in this document would lead  a set of constraints that is too restrictive. Future specifications may revisit this to propose a consistent and comprehensive way of addressing integrity and security of information and to provide specific guidance for other protocol usage.</t>
      </section>
      <section anchor="compact-form-of-the-rcdi-passport-claim">
        <name>Compact Form of the "rcdi" PASSporT Claim</name>
        <t>The use of the compact form of a PASSporT using an "rcdi" claim is not supported, so if "rcdi" is required, compact form <bcp14>MUST NOT</bcp14> be used.</t>
      </section>
      <section anchor="compact-form-of-the-crn-passport-claim">
        <name>Compact Form of the "crn" PASSporT Claim</name>
        <t>Compact form of a "crn" PASSporT claim shall be reconstructed using the "call-reason" parameter of a Call-Info header as defined by <xref target="RFC9796"/>.</t>
      </section>
    </section>
    <section anchor="parties">
      <name>Third-Party Uses</name>
      <t>While rich data about the call can be provided by an originating authentication service, an intermediary in the call path could also acquire rich call data by querying a third-party service. Such a service effectively acts as a STIR Authentication Service, generating its own PASSporT, and that PASSporT could be attached to a call by either the originating or terminating side. This third-party PASSporT attests information about the calling number, rather than the call or caller itself, and as such its RCD <bcp14>MUST NOT</bcp14> be used when a call lacks a first-party PASSporT that assures verification services that the calling party number is not spoofed. A third-party PASSporT is intended to be used in cases when the originating side does not supply a display-name for the caller, so instead some entity in the call path invokes a third-party service to provide rich caller data for a call.</t>
      <t>In telephone operations today, a third-party information service is commonly queried with the calling party's number in order to learn the name of the calling party, and potentially other helpful information could also be passed over that interface. The value of using a PASSporT to convey this information from third parties lies largely in the preservation of the third party's signature over the data, and the potential for the PASSporT to be conveyed from intermediaries to endpoint devices. Effectively, these use cases form a sub-case of out-of-band use cases <xref target="RFC8816"/>. The manner in which third-party services are discovered is outside the scope of this document.</t>
      <t>An intermediary use case might look as follows using the SIP protocol for this example: a SIP INVITE carries a display name in its From header field value and an initial PASSporT object without the "rcd" claim. When a terminating verification service implemented at a SIP proxy server receives this request and determines that the signature is valid, it might query a third-party service that maps telephone numbers to calling party names. Upon receiving the PASSporT in a response from that third-party service, the terminating side could add a new Identity header field to the request for the PASSporT object provided by the third-party service. It would then forward the INVITE to the terminating user agent. If the display name in the PASSporT object matches, or is string-equivalent to, the display name in the INVITE, then the name would presumably be rendered to the end user by the terminating user agent.</t>
      <t>A very similar flow could be followed by an intermediary closer to the origination of the call. Presumably such a service could be implemented at an originating network in order to decouple the systems that sign for calling party numbers from the systems that provide rich data about calls.</t>
      <t>In an alternative use case, the terminating user agent might query a third-party service. In this case, no new Identity header field would be generated, though the terminating user agent might receive a PASSporT object in return from the third-party service, and use the "rcd" field in the object as a calling name to render to users while alerting.</t>
      <t>While in the traditional telephone network, the business relationship between calling customers and their telephone service providers is the ultimate root of information about a calling party's name, some other forms of data like crowdsourced reputation scores might derive from third parties. When those elements are present, they <bcp14>MUST</bcp14> be in a third-party "rcd" PASSporT using the "iss" claim described in the next section.</t>
      <section anchor="thirdsign">
        <name>Signing as a Third Party</name>
        <t>A third-party PASSporT contains an "iss" element to distinguish its PASSporTs from first-party PASSporTs. Third-party "rcd" PASSporTs are signed with credentials that do not have authority over the identity that appears in the "orig" element of the PASSporT claims. The presence of "iss" signifies that a different category of credential is being used to sign a PASSporT than the certificates (as defined in <xref target="RFC8226"/>) used to sign STIR calls; it is instead a certificate that identifies the source of the "rcd" data. How those credentials are issued and managed is outside the scope of this document; however, the value of "iss" <bcp14>MUST</bcp14> reflect the Subject of the certificate used to sign a third-party PASSporT. The explicit mechanism for reflecting the Subject field of the certificate is out of scope of this document and left to the certificate governance policies that define how to map the "iss" value in the PASSporT to the Subject field in the certificate. Relying parties in STIR have always been left to make their own authorization decisions about whether to trust the signers of PASSporTs; in the third-party case, where an entity has explicitly queried a service to acquire the PASSporT object, it may be some external trust or business relationship that induces the relying party to trust a PASSporT.</t>
        <t>An example of a PASSporT claims object issued by a third party is as follows.</t>
        <sourcecode type=""><![CDATA[
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "iss":"Zorin Industries",
   "rcd":{"nam":"James St. John Smythe"} }
]]></sourcecode>
      </section>
      <section anchor="thirdsignverify">
        <name>Verification Using Third-Party RCD</name>
        <t>The third-party "rcd" PASSporT cases must be considered in the verification service, as an attacker could attempt to cut and paste such a third-party PASSporT into a SIP request in an effort to get the terminating user agent to render the display name or confidence values it contains to a call that should have no such assurance. Following the rules of <xref target="RFC8225"/> and in particular if there are multiple identity headers (as in the case of the inclusion of an "rcd" and "shaken" PASSporTs from two different signing providers), a verification service <bcp14>MUST</bcp14> determine that the calling party number shown in the "orig" of the "rcd" PASSporT corresponds to the calling party number of the call it has received, and that the "iat" field of the "rcd" PASSporT is within the date interval that the verification service would ordinarily accept for a PASSporT. It is possible that if multiple identity headers are present, only the verified identity information should be considered when presenting call information to an end user.</t>
        <t>Verification services may alter their authorization policies for the credentials accepted to sign PASSporTs when third parties generate PASSporT objects, per <xref target="thirdsign"/>. This may include accepting a valid signature over a PASSporT even if it is signed with a credential that does not attest authority over the identity in the "orig" claim of the PASSporT, provided that the verification service has some other reason to trust the signer. No further guidance on verification service authorization policy is given here.</t>
      </section>
    </section>
    <section anchor="loa">
      <name>Levels of Assurance</name>
      <t>A set of "rcd" claims can be provided by either first-party providers that are directly authorized to sign PASSporTs in the STIR ecosystem or third-party providers that are indirectly or delegated authority to sign PASSporTs. Relying parties could benefit from an additional claim that indicates the identification, in the form of a uniquely identifiable name, of the attesting party to the caller. Even in first-party cases, the Communications Service Provider (CSP) to which a number was assigned might in turn delegate the number to a reseller, who would then sell the number to an enterprise, in which case the CSP might have little insight into the caller's name. In third-party cases, a caller's name could be determined from any number of data sources, on a spectrum between public data scraped from web searches to a direct business relationship to the caller. As multiple PASSporTs can be associated with the same call, potentially a verification service could receive attestations of the caller name from multiple sources, which have different levels of granularity or accuracy. Therefore, third-party PASSporTs that carry "rcd" data are <bcp14>RECOMMENDED</bcp14> to also carry an indication of the identity of the generator of the PASSporT in the form of the 'iss' claim.</t>
    </section>
    <section anchor="use">
      <name>Use of "rcd" PASSporTs in SIP</name>
      <t>This section documents SIP-specific usage for "rcd" PASSporTs in the SIP Identity header field value. Other protocols using PASSporT may define their own guidance for "rcd" PASSporTs.</t>
      <section anchor="authentication-service-behavior-for-sip-protocol">
        <name>Authentication Service Behavior for SIP Protocol</name>
        <t>An authentication service creating a PASSporT containing an "rcd" claim <bcp14>MAY</bcp14> include a PASSporT extension ("ppt" value) of "rcd". Third-party authentication services following the behavior in <xref target="thirdsign"/> <bcp14>MUST</bcp14> include a PASSporT extension value of "rcd". If the PASSporT extension does contain an "rcd", then any SIP authentication services <bcp14>MUST</bcp14> add a PASSporT extension "ppt" parameter to the Identity header field containing that PASSporT with a value of "rcd". The resulting Identity header field might look as follows:</t>
        <sourcecode type=""><![CDATA[
Identity: sv5CTo05KqpSmtHt3dcEiO/1CWTSZtnG3iV+1nmurLXV/HmtyNS7Ltrg9
       dlxkWzoeU7d7OV8HweTTDobV3itTmgPwCFjaEmMyEI3d7SyN21yNDo2ER/Ovgt
       w0Lu5csIppPqOg1uXndzHbG7mR6Rl9BnUhHufVRbp51Mn3w0gfUs=;
       info=<https://biloxi.example.org/biloxi.cer>;alg=ES256;
       ppt="rcd"
]]></sourcecode>
        <t>This document assumes that by default when using the SIP protocol, an authentication service determines the value of "rcd", specifically only for the "nam" key value, from the display-name component of the From header field value of the request. Alternatively, for some calls this may come from the P-Asserted-ID header. It is however a matter of authentication service policy to decide how it populates the value of the "nam" key, which <bcp14>MAY</bcp14> also match or be determined by other fields in the request, from customer profile data or from access to external services. If the authentication service generates an "rcd" claim containing "nam" with a value that is not string-equivalent to the From header field display-name value, it <bcp14>MUST</bcp14> use the full form of the PASSporT object in SIP.</t>
        <t>In addition, <xref target="RFC9796"/>  defines a Call-Info header field that <bcp14>MAY</bcp14> be used as a source of RCD information that an authentication service uses to construct the appropriate PASSporT RCD claim types used.</t>
        <t>Note also that, as a best practice, the accuracy and legitimacy of Rich Call Data information that is included in the claims is <bcp14>RECOMMENDED</bcp14> to follow a trust framework that is out of scope of this document. As with telephone numbers for the STIR framework, the authentication of Rich Call Data should follow some type of vetting process by an entity that is authoritative over determining the accuracy and legitimacy of that information. This includes the mechanisms for how and from whom that information is received by the authentication service. For example, the general use of Call-Info via SIP as a trusted source of RCD information on the authentication side is <bcp14>NOT RECOMMENDED</bcp14>.</t>
      </section>
      <section anchor="verification-service-behavior-for-sip-protocol">
        <name>Verification Service Behavior for SIP Protocol</name>
        <t><xref section="6.2" target="RFC8224" sectionFormat="comma"/>, Step 5 requires that future specifications defining PASSporT extension ("ppt") values describe any additional verifier behavior specific to the SIP protocol. The general verification procedures defined in <xref target="rcd_passport_verification"/>
should be followed, but the following paragraphs describe some of the specifics needed to implement a verification service using the SIP protocol.</t>
        <t>If the PASSporT is in compact form, then the verification service <bcp14>MUST</bcp14> extract the display-name from the From header field value, if any, and <bcp14>MUST</bcp14> use that as the string value for the "nam" key when it recomputes the header and claims of the PASSporT object. Additionally, if there exists a Call-Info header field as defined in <xref target="RFC9796"/>, the "jcard" JSON object value <bcp14>MUST</bcp14> be used to construct the "jcd" key value when it recomputes the header and claims of the PASSporT object. If the signature validates over the recomputed object, then the verification is considered successful.</t>
        <t>If the PASSporT is in full form with a PASSporT extension value of "rcd", then the verification service <bcp14>MUST</bcp14> extract the value associated with the "rcd" claim "nam" key in the object. If the PASSporT signature is verified successfully, then the verification service <bcp14>MUST</bcp14> additionally compare the string value of the "rcd" claim "nam" key value with the From header field value or the preferred value.  The preferred value depends on local policy of the SIP network technique that conveys the display name string through a field other than the From header field to interoperate with this specification (e.g., P-Asserted-Identity) as discussed in <xref target="RFC8224"/>. 
Similarly, "jcd", "jcl", "icn", "apn", or "crn" elements
can be used optionally (based on local policy for devices that support it)
to populate a Call-Info header field following the format of
<xref target="RFC9796"/>. If PASSporT RCD claims types defined in the future are present, they should follow similar defined procedures and policies.</t>
        <t>The behavior of a SIP User Agent Server (UAS) upon receiving an INVITE or other type of session initiation request containing a PASSporT object with an "rcd" claim largely remains a matter of implementation policy. In most cases, implementations would render this calling party name information to the user while alerting. Any user interface additions to express confidence in the veracity of this information are outside the scope of this specification.</t>
      </section>
    </section>
    <section anchor="using-rcd-rcdi-crn-as-additional-claims-to-other-passport-extensions">
      <name>Using "rcd", "rcdi", and "crn" as Additional Claims to Other PASSporT Extensions</name>
      <t>Rich Call Data, including calling name information, as a common example, is often data that is additive to the personal communications information defined in the core PASSporT data required to support the security properties defined in <xref target="RFC8225"/>. For cases where the entity originating the personal communications is supporting the authentication service for the calling identity and is the authority of the Rich Call Data, rather than creating multiple Identity header fields corresponding to multiple PASSporT extensions, the authentication service can alternatively directly add the "rcd" claim to a PASSporT that authenticates the calling identity.</t>
      <section anchor="procedures-for-applying-rcd-claims-as-claims-only">
        <name>Procedures for Applying RCD Claims as Claims Only</name>
        <t>For a given PASSporT using some other extension than "rcd", the Authentication Service <bcp14>MAY</bcp14> additionally include the "rcd" defined in <xref target="rcd_define"/>, "rcdi" defined in <xref target="rcdi_define"/>, and "crn" defined in <xref target="crn_define"/> claims. This would result in a set of claims that correspond to the original intended extension with the addition of the "rcd" claim.</t>
        <t>The verification service that receives the PASSporT, if it supports this specification and chooses to, should interpret the "rcd" claim as simply just an additional claim intended to deliver and/or validate delivered Rich Call Data.</t>
      </section>
      <section anchor="example-for-applying-rcd-claims-as-claims-only">
        <name>Example for Applying RCD Claims as Claims Only</name>
        <t>In the case of <xref target="RFC8588"/>, which is the PASSporT extension supporting the Signature-based Handling of Asserted information using toKENs (SHAKEN) specification <xref target="ATIS-1000074.v003"/>, a common case is for an authentication service to coexist in a CSP network along with the authority over the calling name used for the call. Rather than require two identity headers, the CSP authentication service can apply both the SHAKEN PASSporT claims and extension and simply add the "rcd" required claims defined in this document.</t>
        <t>For example, the PASSporT claims for the "shaken" PASSporT with "rcd" claims would be as follows:</t>
        <sourcecode type=""><![CDATA[
Protected Header
{
   "alg":"ES256",
   "typ":"passport",
   "ppt":"shaken",
   "x5u":"https://cert.example.org/passport.cer"
}
Payload
{
   "attest":"A",
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "orig":{"tn":"12025551000"},
   "origid":"123e4567-e89b-12d3-a456-426655440000",
   "rcd":{"nam":"James Bond"}
}
]]></sourcecode>
        <t>A verification service that understands and supports claims defined in the "rcd" and "shaken" PASSporT extensions is able to receive the above PASSporT and interpret both the "shaken" claims as well as the "rcd" claims.</t>
        <t>If the verification service only understands the "shaken" PASSporT extension claims and doesn't support the "rcd" PASSporT extension or claims, then the "rcd" claim in this example is used during PASSporT signature validation but is otherwise ignored and disregarded.</t>
      </section>
    </section>
    <section anchor="extend">
      <name>Further Information Associated with Callers</name>
      <t>Beyond naming information and the information that can be contained in a jCard object <xref target="RFC7095"/>, there may be additional human-readable information about the calling party that should be rendered to the end user in order to help the called party decide whether or not to pick up the phone. This is not limited to information about the caller; it includes information about the call itself, which may derive from analytics that determine (based on call patterns or similar data) if the call is likely to be one the called party wants to receive. Such data could include:</t>
      <ul spacing="normal">
        <li>information related to the location of the caller, or</li>
        <li>any organizations or institutions that the caller is associated with, or even categories of institutions (whether this a government agency, a bank, or what have you), or</li>
        <li>hyperlinks to images, such as logos or pictures of faces, or to similar external profile information, or</li>
        <li>information processed by an application before rendering it to a user, like social networking data that shows that an unknown caller is a friend-of-a-friend, or reputation scores derived from crowdsourcing, or confidence scores based on broader analytics about the caller and callee.</li>
      </ul>
      <t>All of these data elements would benefit from the secure attestations provided by the STIR and PASSporT frameworks. A new IANA registry has been defined to hold potential values of the "rcd" array; see <xref target="rcdtypes"/>. Specific extensions to the "rcd" PASSporT claim are left for future specification.</t>
      <t>There are a few ways RCD can be extended in the future; jCard is an extensible object and the key/values in the RCD claim object can also be extended. General guidance for future extensibility that was followed by the authors is that jCard typically should refer to data that references the caller as an individual or entity, whereas other claims, such as "crn", refer to data regarding the specific call. There may be other considerations discovered in the future, but this logical grouping of data should be followed to the extent possible for future extensibility.</t>
    </section>
    <section anchor="IANA">
      <name>IANA Considerations</name>
      <section anchor="json-web-token-claim">
        <name>JSON Web Token Claim</name>
        <t>Per this document, IANA has added three new claims to the "JSON Web Token Claims" registry as defined in <xref target="RFC7519"/>.</t>
<dl spacing="compact" newline="false">
        <dt>Claim Name:</dt><dd>"rcd"</dd>
        <dt>Claim Description:</dt><dd>Rich Call Data Information</dd>
        <dt>Change Controller:</dt><dd>IETF</dd>
        <dt>Reference:</dt><dd>RFC 9795</dd>
</dl>
<dl spacing="compact" newline="false">
        <dt>Claim Name:</dt><dd>"rcdi"</dd>
        <dt>Claim Description:</dt><dd>Rich Call Data Integrity Information</dd>
        <dt>Change Controller:</dt><dd>IETF</dd>
        <dt>Reference:</dt><dd>RFC 9795</dd>
</dl>
<dl spacing="compact" newline="false">
        <dt>Claim Name:</dt><dd>"crn"</dd>
        <dt>Claim Description:</dt><dd>Call Reason</dd>
        <dt>Change Controller:</dt><dd>IETF</dd>
        <dt>Reference:</dt><dd>RFC 9795</dd>
</dl>
      </section>
      <section anchor="personal-assertion-token-passport-extensions">
        <name>Personal Assertion Token (PASSporT) Extensions</name>
        <t>Per this document, IANA has added a new entry to the "Personal Assertion Token (PASSporT) Extensions" registry for the type "rcd" which is specified in this document.</t>
      </section>
      <section anchor="rcdtypes">
        <name>PASSporT RCD Claim Types</name>
        <t>IANA has created a new "PASSporT RCD Claim Types" registry in the "Personal Assertion Token (PASSporT)" registry group. Registration of new PASSporT RCD claim types shall be under the Specification Required policy <xref target="RFC8126"/>.</t>
        <t>This registry is initially populated with five claim name values, "nam", "apn", "icn", "jcd", and "jcl", which are specified in this document. The columns are "Name" and "Reference". Any new registrations should consist of only of the name and the reference document. There is an obligation for expert review, where the designated expert should validate that the proposed new PASSporT RCD claim type has a scope that doesn't potentially conflict or overlap with the usage or interpretation of the other existing types in the registry.</t>
      </section>
    </section>
    <section anchor="Security">
      <name>Security Considerations</name>
      <t>The process of signing information contained in a "rcd" PASSporT (whether the identities, identifiers, alternate identities or identifiers, images, logos, physical addresses, or otherwise) should follow some vetting process in which an authoritative entity follows an appropriate consistent policy defined and governed by the ecosystem using RCD and the STIR framework. This can be of many forms, depending on the setup and constraints of the policy requirements of the ecosystem, and is therefore out of scope of this document. However, the general chain of trust that signers of "rcd" PASSporT are either directly authoritative or have been delegated authority through certificates using JWT Claim Constraints and integrity mechanisms defined in this and related documents is critical to maintain the integrity of the ecosystem utilizing this and other STIR-related specifications.</t>
      <t>Revealing information such as the name, location, and affiliation of a person necessarily entails certain privacy risks. Baseline PASSporT has no particular confidentiality requirement, as the information it signs in many current base communications protocols (for example, SIP) is information that is carried in the clear anyway. Transport-level security can hide those SIP fields from eavesdroppers, and the same confidentiality mechanisms would protect any PASSporT(s) carried in SIP.</t>
      <t>The dereferencing and download of any RCD URI-linked resources as part of verification either in-network or on device could provide some level of information about calling patterns, so this should be considered when making these resources available.</t>
      <t>The use of JWT Claim Constraints, a mechanism defined in <xref target="RFC8226"/> and extended in <xref target="RFC9118"/>, to constrain any of the RCD information in the public certificate by including that information in the certificate, depending on the availability in the deployment of the PKI system, may present a privacy issue. The use of the "rcdi" claim and digests for representing JWT claim contents is <bcp14>RECOMMENDED</bcp14> for the prevention of the exposure of that information through the certificates that are often publicly accessible and available.</t>
      <t>Since computation of "rcdi" digests for URIs requires the loading of referenced content, it would be best practice to validate that content at the creation of the "rcdi" or corresponding JWT claim constraint value by checking for content that may cause issues for verification services or that doesn't follow the behavior defined in this document, e.g., unreasonably sized data, the inclusion of recursive URI references, etc. Along the same lines, the verification service should also use precautionary best practices to avoid attacks when accessing URI-linked content.</t>
      <t>As general guidance, the use of URLs and URIs that reference potentially dangerous or intentionally harmful content should be considered in implementing this specification.  <xref section="7" target="RFC3986" sectionFormat="comma"/> contains good additional guidance to consider when communicating or dereferencing URLs and URIs.</t>
      <section anchor="the-use-of-jwt-claim-constraints-in-delegate-certificates-to-exclude-unauthorized-claims">
        <name>Use of JWT Claim Constraints in Delegate Certificates to Exclude Unauthorized Claims</name>
        <t>While this can apply to any PASSporT that is signed with a STIR Delegate Certificate <xref target="RFC9060"/>, it is important to note that when constraining PASSporTs to include specific claims or contents of claims, it is also important to consider potential attacks by non-authorized signers that may include other potential PASSporT claims that weren't originally vetted by the authorized entity providing the delegate certificate. The use of JWT claims constraints (as defined in <xref target="RFC9118"/>) for preventing the ability to include claims beyond the claims defined in this document may need to be considered.</t>
      </section>
    </section>
  </middle>
  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>

<reference anchor="RFC9796" target="https://www.rfc-editor.org/info/rfc9796">
<front>
<title>SIP Call-Info Parameters for Rich Call Data</title>
<author initials='C' surname='Wendt' fullname='Chris Wendt'>
<organization />
</author>
<author initials='J' surname='Peterson' fullname='Jon Peterson'>
<organization />
</author>
<date year='2025' month='July'/>
</front>
<seriesInfo name="RFC" value="9796"/>
<seriesInfo name="DOI" value="10.17487/RFC9796"/>
</reference>

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3261.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3986.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4648.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6234.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6901.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7095.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7519.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8224.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8225.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8226.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8259.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8588.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9060.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9118.xml"/>


        <reference anchor="IANA-COSE-ALG" target="https://www.iana.org/assignments/cose">
          <front>
            <title>COSE Algorithms</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>

      </references>
      <references>
        <name>Informative References</name>

        <reference anchor="TS.3GPP.24.229"                                                
target="https://www.3gpp.org/ftp/Specs/html-info/24229.htm">
          <front>
            <title>IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3</title>
            <author>
              <organization abbrev="3GPP">3rd Generation Partnership Project</organization>
            </author>
            <date month="September" year="2020"/>
	  </front>
          <seriesInfo name="3GPP TS" value="24.229"/>
	  <refcontent>16.7.0</refcontent>
        </reference>

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3325.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7340.xml"/>
	<xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8816.xml"/>


        <reference anchor="ATIS-1000074.v003" target="https://access.atis.org/higherlogic/ws/public/download/67436">
          <front>
            <title>Signature-based Handling of Asserted information using toKENs (SHAKEN)</title>
            <author>
              <organization>Alliance for Telecommunications Industry Solutions</organization>
            </author>
            <date year="2022" month="August"/>
          </front>
          <refcontent>ATIS-1000074.v003</refcontent>
        </reference>

        <reference anchor="W3C-SubresourceIntegrity" target="https://www.w3.org/TR/2025/WD-sri-2-20250422/">
          <front>
            <title>Subresource Integrity</title>
            <author fullname="Frederik Braun" role="editor" />
            <date year="2025" month="April" day="25"/>
          </front>
          <refcontent>W3C First Public Working Draft</refcontent>
        </reference>

      </references>
    </references>
    <section anchor="acknowledgements" numbered="false">
      <name>Acknowledgements</name>
      <t>We would like to thank <contact fullname="David Hancock"/>, <contact fullname="Robert Sparks"/>, <contact fullname="Russ Housley"/>, <contact fullname="Eric Burger"/>, <contact fullname="Alec Fenichel"/>, <contact fullname="Ben Campbell"/>, <contact fullname="Jack Rickard"/>, <contact fullname="Jordan Simpson"/> for helpful suggestions, review, and comments.</t>
    </section>

</back>

</rfc>
