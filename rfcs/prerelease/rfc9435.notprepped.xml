<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" submissionType="IETF" category="info" consensus="true" docName="draft-ietf-tsvwg-dscp-considerations-13" number="9435" ipr="trust200902" tocInclude="true" tocDepth="4" symRefs="true" sortRefs="true" updates="" obsoletes="" xml:lang="en" version="3">

  <front>
    <title abbrev="Assigning a New DSCP">Considerations for Assigning a New
    Recommended Differentiated Services Code Point (DSCP)</title>
    <seriesInfo name="RFC" value="9435"/>
    <author fullname="Ana Custura" initials="A" surname="Custura">
      <organization>University of Aberdeen</organization>
      <address>
        <postal>
          <extaddr>School of Engineering</extaddr>
          <street>Fraser Noble Building</street>
          <city>Aberdeen</city>
          <region/>
          <code>AB24 3UE</code>
          <country>United Kingdom</country>
        </postal>
        <email>ana@erg.abdn.ac.uk</email>
      </address>
    </author>
    <author fullname="Godred Fairhurst" initials="G" surname="Fairhurst">
      <organization>University of Aberdeen</organization>
      <address>
        <postal>
          <extaddr>School of Engineering</extaddr>
          <street>Fraser Noble Building</street>
          <city>Aberdeen</city>
          <region/>
          <code>AB24 3UE</code>
          <country>United Kingdom</country>
        </postal>
        <email>gorry@erg.abdn.ac.uk</email>
      </address>
    </author>
    <author fullname="Raffaello Secchi" initials="R" surname="Secchi">
      <organization>University of Aberdeen</organization>
      <address>
        <postal>
          <extaddr>School of Engineering</extaddr>
          <street>Fraser Noble Building</street>
          <city>Aberdeen</city>
          <region/>
          <code>AB24 3UE</code>
          <country>United Kingdom</country>
        </postal>
        <email>r.secchi@abdn.ac.uk</email>
      </address>
    </author>
    <date month="July" year="2023"/>
    <area>tsv</area>
    <workgroup>tsvwg</workgroup>
    <keyword>DSCP</keyword>
    <keyword>Diffserv Codepoints</keyword>
    
    <abstract>
      <t>This document discusses considerations for assigning a new
      recommended Differentiated Services Code Point (DSCP) for a standard
      Per-Hop Behavior (PHB). It considers the common observed re-marking
      behaviors that the Diffserv field might be subjected to along an
      Internet path. It also notes some implications of using a specific
      DSCP.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="introduction">
      <name>Introduction</name>
      <t>The Differentiated Services (Diffserv) architecture has been deployed
      in many networks. It provides differentiated traffic forwarding based on
      the DSCP carried in the Diffserv field of the IP packet header <xref
      target="RFC2474"/>.  A common set of DSCPs are defined for both IPv4 and
      IPv6, and both network protocols use a common IANA registry <xref
      target="DSCP-registry"/>.</t>
      <t>Diffserv associates traffic with a service class and categorizes it
      into Behavior Aggregates (BAs) <xref target="RFC4594"/>.  Configuration
      guidelines for service classes are provided in <xref target="RFC4594"/>.
      BAs are associated with a DSCP, which in turn maps to a Per-Hop Behavior
      (PHB).  Treatment differentiation can be achieved by using a variety of
      schedulers and queues and also algorithms that implement access to the
      physical media.</t>
      <t>Within a Diffserv domain, operators can set Service Level
      Specifications <xref target="RFC3086"/>, each of which maps to a
      particular Per-Domain Behavior (PDB) that is based on one or more PHBs.
      The PDB defines which PHB (or set of PHBs) and, hence, for a specific
      operator, which DSCP (or set of DSCPs) will be associated with specific
      BAs as the packets pass through a Diffserv domain. It also defines
      whether the packets are re-marked as they are forwarded (i.e.,
      changing the DSCP of a packet <xref target="RFC2475"/>).</t>

<figure anchor="fig1">
<name>The Role of DSCPs in Classifying IP Traffic for Differential Network
Treatment by a Diffserv Node</name>
<artwork><![CDATA[
Application -> Service
Traffic        Class 
                 |
               Behavior  -> Diffserv -> Per Hop
               Aggregate    Codepoint   Behavior
                                          |
                                        Schedule,
                                        Queue, Drop    
]]></artwork>
</figure>

      <t>This document discusses considerations for assigning a new DSCP for a
      standard PHB. It considers some commonly observed DSCP re-marking
      behaviors that might be experienced along an Internet path. It also
      describes some packet forwarding treatments that a packet with a
      specific DSCP can expect to receive when forwarded across a link or
      subnetwork.</t>

      <t>The document is motivated by new opportunities to use Diffserv
      end-to-end across multiple domains, such as <xref
      target="I-D.ietf-tsvwg-nqb"/>, proposals to build mechanisms using DSCPs
      in other standards-setting organizations, and the desire to use a common
      set of DSCPs across a range of infrastructure (e.g., <xref
      target="RFC8622"/>, <xref target="I-D.ietf-tsvwg-nqb"/>, <xref
      target="I-D.learmonth-intarea-rfc1226-bis"/>).</t>
    </section>
    <section>
      <name>Terminology</name>
        <t> The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
        "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
        NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
        "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
        "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document
        are to be interpreted as described in BCP&nbsp;14 <xref
        target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
        appear in all capitals, as shown here.
        </t>
      <t>DSCPs are specified in the IANA registry <xref
      target="DSCP-registry"/>, where a variety of different formats are
      described.  A DSCP can sometimes be referred to by name, such as "CS1",
      and sometimes by a decimal, hex, or binary value. Hex values are
      represented in text using prefix "0x". Binary values use prefix "0b".
      </t>
   <t>In this document, the symbol "&amp;" denotes a bitwise AND of two unsigned values.</t>
    </section>
    <section>
      <name>Current Usage of DSCPs</name>
      <t>This section describes the current usage of DSCPs.</t>
      <section>
        <name>IP-Layer Semantics</name>
        <t>The Diffserv architecture specifies the use of the Diffserv field
        in the IPv4 and IPv6 packet headers to carry one of 64 distinct DSCP
        values. Within a given administrative boundary, each DSCP value can be
        mapped to a distinct PHB <xref target="RFC2474"/>. When a new PHB is
        specified, a recommended DSCP value among those 64 values is normally
        reserved for that PHB and is assigned by IANA. An operator is not
        formally required to use the recommended value; indeed, <xref
        target="RFC2474"/> states that "the mapping of codepoints to PHBs
        <bcp14>MUST</bcp14> be configurable." However, use of the recommended
        value is usually convenient and avoids confusion.</t>
        <t>The DSCP space is divided into three pools for the purpose of
        assignment and management <xref target="DSCP-registry"/>. A
        summary of the pools is provided in a table (where 'x' refers to a
        bit position with value either '0' or '1').
        </t>
        <dl newline="false" spacing="normal">
          <dt>DSCP Pool 1:</dt>
          <dd>A pool of 32 codepoints with a format of 0bxxxxx0, to be assigned
          by IANA Standards Action <xref target="RFC8126"/>.</dd>
          <dt>DSCP Pool 2:</dt>
          <dd>A pool of 16 codepoints with a format of 0bxxxx11, reserved for
          Experimental or Local (Private) Use by network operators (see
          Sections <xref target="RFC8126" sectionFormat="bare" section="4.1"/>
          and <xref target="RFC8126" sectionFormat="bare" section="4.2"/> of
          <xref target="RFC8126"/>.</dd>
          <dt>DSCP Pool 3:</dt>
          <dd>A pool of 16 codepoints with a format of 0bxxxx01.  This was
          initially available for Experimental (EXP) Use or Local Use (LU) but
          was originally specified to be "preferentially utilized for
          standardized assignments if Pool 1 is ever exhausted" <xref target="RFC2474"/>. 

 Pool 3
          codepoints are now "utilized for standardized assignments (replacing
          the previous availability for experimental or local use)" <xref
          target="RFC8436"/>.  <xref target="RFC8622"/> assigned 0x01 from
          this pool and consequentially updated <xref target="RFC4594"/>. Any
          future request to assign 0x05 would be expected to similarly update
          <xref target="RFC4594"/>.</dd>
        </dl>
        <t> Note that <xref target="RFC4594"/> previously recommended a Local
        Use of DSCP values 0x01, 0x03, 0x05, and 0x07 (codepoints with the
        format of 0b000xx1), until this was updated by <xref
        target="RFC8436"/>.
        </t>
        <t>The DSCP space is shown in the following table. Each row corresponds to one setting of the first three bits of the DSCP field, and each column to one setting of the last three bits of the DSCP field.
	</t>

<table anchor="table1" align="center">
  <name>Currently Assigned DSCPs and Their Assigned PHBs</name>
  <tbody>
    <tr>
      <td>56/CS7</td>
      <td>57</td>
      <td>58</td>
      <td>59</td>
      <td>60</td>
      <td>61</td>
      <td>62</td>
      <td>63</td>
    </tr>
    <tr>
      <td>48/CS6</td>
      <td>49</td>
      <td>50</td>
      <td>51</td>
      <td>52</td>
      <td>53</td>
      <td>54</td>
      <td>55</td>
    </tr>
    <tr>
      <td>40/CS5</td>
      <td>41</td>
      <td>42</td>
      <td>43</td>
      <td>44/VA</td>
      <td>45</td>
      <td>46/EF</td>
      <td>47</td>
    </tr>
    <tr>
      <td>32/CS4</td>
      <td>33</td>
      <td>34/AF41</td>
      <td>35</td>
      <td>36/AF42</td>
      <td>37</td>
      <td>38/AF43</td>
      <td>39</td>
    </tr>
    <tr>
      <td>24/CS3</td>
      <td>25</td>
      <td>26/AF31</td>
      <td>27</td>
      <td>28/AF32</td>
      <td>29</td>
      <td>30/AF33</td>
      <td>31</td>
    </tr>
    <tr>
      <td>16/CS2</td>
      <td>17</td>
      <td>18/AF21</td>
      <td>19</td>
      <td>20/AF22</td>
      <td>21</td>
      <td>22/AF23</td>
      <td>23</td>
    </tr>
    <tr>
      <td>8/CS1</td>
      <td>9</td>
      <td>10/AF11</td>
      <td>11</td>
      <td>12/AF12</td>
      <td>13</td>
      <td>14/AF13</td>
      <td>15</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <th>0/CS0</th>
      <th>1/LE</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </tfoot>
</table>

<table anchor="table2" align="center">
<name>Abbreviations for DSCPs and PHB Groups</name>
<tbody>
  <tr>
    <td>CS</td>
    <td>Class Selector</td>
    <td><xref target="RFC2474"/></td>
  </tr>
  <tr>
    <td>BE</td>
    <td>Best Effort (CS0)</td>
    <td><xref target="RFC2474"/></td>
  </tr>
  <tr>
    <td>AF</td>
    <td>Assured Forwarding</td>
    <td><xref target="RFC2597"/></td>
  </tr>
  <tr>
    <td>EF</td>
    <td>Expedited Forwarding</td>
    <td><xref target="RFC3246"/></td>
  </tr>
  <tr>
    <td>VA</td>
    <td>Voice Admit</td>
    <td><xref target="RFC5865"/></td>
  </tr>
  <tr>
    <td>LE</td>
    <td>Lower Effort</td>
    <td><xref target="RFC8622"/></td>
  </tr>
</tbody>
</table>

        <t><xref target="table2"/> summarizes the DSCP abbreviations used in
        currently published RFCs, <xref target="RFC2474"/> <xref
        target="RFC2597"/> <xref target="RFC3246"/> <xref target="RFC5865"/>
        <xref target="RFC8622"/>, as described in the IANA registry <xref
        target="DSCP-registry"/>. 
The Default PHB is defined in <xref target="RFC2474" section="4.1" sectionFormat="of"/>. This provides Best Effort (BE) forwarding, and the recommended DSCP of '000000' (<xref target="RFC2474" section="4.2.2.1" sectionFormat="of"/>). This
is the lowest value in the set of Class Selector (CS) DSCPs, and hence is also known as "CS0" <xref target="DSCP-registry"/>.

        </t>
        <t> NOTE: <xref target="RFC4594"/> specified a now deprecated use of
        Class Selector 1 (CS1) as the codepoint for the Lower Effort
        PHB. <xref target="RFC8622"/> updated <xref target="RFC4594"/> and
        <xref target="RFC8325"/> and obsoleted <xref target="RFC3662"/>,
        assigning the LE DSCP codepoint to the Lower Effort PHB.</t>
        <t>The Diffserv architecture allows forwarding treatments to be
        associated with each DSCP, and the RFC series describes some of these
        as PHBs. Although DSCPs are intended to identify specific treatment
        requirements, multiple DSCPs might also be mapped (aggregated) to the
        same forwarding treatment. DSCPs can be mapped to Treatment Aggregates (TAs)
        that might result in re-marking (e.g., <xref target="RFC5160"/>
        suggests Meta-QoS-Classes to help enable deployment of standard
        end-to-end QoS classes).</t>
      </section>
      <section>
        <name>DSCPs Used for Network Control Traffic</name>
        <t>Network control traffic is defined as packet flows that are
        essential for stable operation of the administered network (see <xref
        target="RFC4594" sectionFormat="comma" section="3"/>). The traffic
        consists of the network control service class and the OAM service
        class.  This traffic is marked with a value from a set of CS DSCPs.  This traffic is often a special case within a
        provider network, and ingress traffic with these DSCP markings can be
        re-marked.</t>
        <t>DSCP CS2 is recommended for the OAM (Operations, Administration,
        and Maintenance) service class (see <xref target="RFC4594"
        sectionFormat="comma" section="3.3"/>).</t>
        <t>DSCP CS6 is recommended for local network control traffic. This
        includes routing protocols and OAM traffic that are essential to
        network operation administration, control, and management.  <xref
        target="RFC4594" sectionFormat="of" section="3.2"/> recommends that
        "CS6 marked packet flows from untrusted sources (for example, end user
        devices) <bcp14>SHOULD</bcp14> be dropped or remarked at ingress to
        the Diffserv network".</t>
        <t>DSCP CS7 is reserved for future use by network control traffic.
        "CS7 marked packets <bcp14>SHOULD NOT</bcp14> be sent across peering
        points" <xref target="RFC4594" sectionFormat="comma" section="3.1"/>.</t>
        <t><xref target="RFC2474" sectionFormat="of" section="4.2.2.2"/>
        recommends PHBs selected by CS6 and CS7 "<bcp14>MUST</bcp14> give
        packets a preferential forwarding treatment by comparison to the PHB
        selected by codepoint '000000'".</t>
        <t> At the time of writing, there is evidence to suggest CS6 is
        actively used by network operators for control traffic. A study of
        traffic at a large Internet Exchange showed around 40% of ICMP traffic
        carried this mark <xref target="IETF115-IEPG"/>. Similarly, another
        study found many routers re-mark all traffic, except for packets
        carrying a DSCP with the format 0b11xxxx (i.e., setting the higher
        order bits to 0b11, see <xref target="tos-prec-bleach-impact"/> of
        this document).</t>
      </section>
    </section>
    <section anchor="observed-re-marking">
      <name>Re-marking the DSCP</name>
      <t>It is a feature of the Diffserv architecture that the Diffserv field
      of packets can be re-marked at the Diffserv domain boundaries (see <xref
      target="RFC2475" sectionFormat="of" section="2.3.4.2"/>). A DSCP can be
      re-marked at the ingress of a domain. This re-marking can change the
      DSCP value used on the remainder of an IP path, or the network can
      restore the initial DSCP marking at the egress of the domain. The
      Diffserv field can also be re-marked based on common semantics and
      agreements between providers at a Diffserv domain boundary. Furthermore, <xref
      target="RFC2474"/> states that re-marking must occur when there is a
      possibility of theft or denial-of-service attack.</t>
      <t>A packet that arrives with a DSCP that is not associated with a PHB,
      results in an "unknown DSCP." A node could receive a packet with an
      "unexpected DSCP" due to misconfiguration, or because there is no
      consistent policy in place. The treatment of packets that are marked
      with an unknown or an unexpected DSCP at Diffserv domain boundaries is
      determined by the policy for a Diffserv domain.  If packets are received
      that are marked with an unknown or an unexpected DSCP by a Diffserv
      domain interior node, <xref target="RFC2474"/> recommends forwarding the
      packet using a default (Best Effort) treatment but without changing the
      DSCP.  This seeks to support incremental Diffserv deployment in existing
      networks as well as preserve DSCP markings by routers that have not been
      configured to support Diffserv (see also <xref target="re-mark"/>).
      <xref target="RFC3260"/> clarifies that this re-marking specified by
      <xref target="RFC2474"/> is intended for interior nodes within a
      Diffserv domain. For Diffserv ingress nodes, the traffic conditioning
      required by <xref target="RFC2475"/> applies first.</t>
      <t>Reports measuring existing deployments have defined a set of
      categories for DSCP re-marking <xref target="Cus17"/> <xref
      target="Bar18"/> in the following seven observed
      re-marking behaviors:</t>
      <dl newline="false" spacing="normal">
        <dt>Bleach-DSCP:</dt>
        <dd>bleaches all traffic (sets the DSCP to zero)</dd>
        <dt>Bleach-ToS-Precedence:</dt>
        <dd>set the first three bits of the DSCP field to 0b000 (reset the
        three bits of the former ToS Precedence field, defined in <xref
        target="RFC0791"/> and clarified in <xref target="RFC1122"/>)</dd>
        <dt>Bleach-some-ToS:</dt>
        <dd>set the first three bits of the DSCP field to 0b000 (reset the
        three bits of the former ToS Precedence field), unless the first two
        bits of the DSCP field are 0b11</dd>
        <dt>Re-mark-ToS:</dt>
        <dd>set the first three bits of the DSCP field to any value different
        from 0b000 (replace the three bits of the former ToS Precedence
        field)</dd>
        <dt>Bleach-low:</dt>
        <dd>set the last three bits of the DSCP field to 0b000</dd>
        <dt>Bleach-some-low:</dt>
        <dd>set the last three bits of the DSCP field to 0b000, unless the
        first two bits of the DSCP field are 0b11</dd>
        <dt>Re-mark-DSCP:</dt>
        <dd>re-marks all traffic to one or more particular (non-zero) DSCP
        values</dd>
      </dl>
      <t>These behaviors are explained in the following subsections and
      cross-referenced in the remainder of the document.</t>
      <t> The network nodes forming a particular path might or might not have
      supported Diffserv.  It is not generally possible for an external
      observer to determine which mechanism results in a specific re-marking
      solely from the change in an observed DSCP value.</t>
      <t>NOTE: More than one mechanism could result in the same DSCP
      re-marking (see below). These behaviors were measured on both IPv4 and
      IPv6 Internet paths between 2017 and 2021 <xref target="Cus17"/>.
      IPv6 routers were found to perform all the types of re-marking described
      above to a lesser extent than IPv4 ones.</t>
      <section anchor="Bleaching">
        <name>Bleaching the DSCP Field</name>
        <t>A specific form of re-marking occurs when the Diffserv field is
        re-assigned to the default treatment: CS0 (0x00). This results in
        traffic being forwarded using the BE PHB. For example, AF31 (0x1a)
        would be bleached to CS0.</t>
        <t>A survey reported that resetting all the bits of the Diffserv field
        to 0 was seen to be more prevalent at the edge of the network and
        rather less common in core networks <xref target="Cus17"/>.</t>
      </section>
      <section>
        <name>IP Type of Service Manipulations</name>
        <t>The IETF first defined ToS precedence for IP packets in <xref
        target="RFC0791"/> and updated it to be part of the ToS field in
        <xref target="RFC1349"/>. Since 1998, this practice has been
        deprecated by <xref target="RFC2474"/>.  <xref target="RFC2474"/>
        defines DSCPs 0bxxx000 as the Class Selector codepoints, where PHBs
        selected by these codepoints <bcp14>MUST</bcp14> meet the "Class
        Selector PHB Requirements" described in <xref target="RFC2474"
        sectionFormat="of" section="4.2.2.2"/>.</t>
        <t>A recent survey reports practices based on ToS semantics
        have not yet been eliminated from the Internet and need to still be
        considered when making new DSCP assignments <xref
        target="Cus17"/>.</t>
        <section anchor="tos-prec-bleach-impact">
          <name>Impact of ToS Precedence Bleaching</name>
          <t>Bleaching of the ToS Precedence field (see <xref
          target="observed-re-marking"/>) resets
          the first three bits of the DSCP field to zero (the former ToS
          Precedence field), leaving the last three bits unchanged (see <xref
          target="RFC2474" sectionFormat="of" section="4.2.1"/>). A Diffserv
          node can be configured in a way that results in this
          re-marking. This re-marking can also occur when packets are
          processed by a router that is not configured with Diffserv (e.g.,
          configured to operate on the former ToS Precedence field <xref
          target="RFC0791"/>). At the time of writing, this is a common
          manipulation of the Diffserv field. The following Figure depicts
          this re-marking.</t>


<figure anchor="fig2">
<name>Bits in the Diffserv Field Modified by Bleaching of the ToS Precedence</name>
<artwork><![CDATA[
+-+-+-+-+-+-+
|5|4|3|2|1|0|
+-+-+-+-+-+-+
|0 0 0|x x x|
+-+-+-+-+-+-+
]]></artwork>
</figure>

          <t><xref target="fig2"/> shows bleaching of the ToS Precedence (see
          <xref target="observed-re-marking"/>), based on <xref
          target="RFC1349" sectionFormat="of" section="3"/>. The bit positions
          marked 'x' are not changed.</t>

<table anchor="table3" align="center">
<name>DSCP Values</name>
  <tbody>
    <tr>
      <td>56/CS7</td>
      <td>57</td>
      <td>58</td>
      <td>59</td>
      <td>60</td>
      <td>61</td>
      <td>62</td>
      <td>63</td>
    </tr>
    <tr>
      <td>48/CS6</td>
      <td>49</td>
      <td>50</td>
      <td>51</td>
      <td>52</td>
      <td>53</td>
      <td>54</td>
      <td>55</td>
    </tr>
    <tr>
      <td>40/CS5</td>
      <td>41</td>
      <td>42</td>
      <td>43</td>
      <td>44/VA</td>
      <td>45</td>
      <td>46/EF</td>
      <td>47</td>
    </tr>
    <tr>
      <td>32/CS4</td>
      <td>33</td>
      <td>34/AF41</td>
      <td>35</td>
      <td>36/AF42</td>
      <td>37</td>
      <td>38/AF43</td>
      <td>39</td>
    </tr>
    <tr>
      <td>24/CS3</td>
      <td>25</td>
      <td>26/AF31</td>
      <td>27</td>
      <td>28/AF32</td>
      <td>29</td>
      <td>30/AF33</td>
      <td>31</td>
    </tr>
    <tr>
      <td>16/CS2</td>
      <td>17</td>
      <td>18/AF21</td>
      <td>19</td>
      <td>20/AF22</td>
      <td>21</td>
      <td>22/AF23</td>
      <td>23</td>
    </tr>
    <tr>
      <td>8/CS1</td>
      <td>9</td>
      <td>10/AF11</td>
      <td>11</td>
      <td>12/AF12</td>
      <td>13</td>
      <td>14/AF13</td>
      <td>15</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <th>0/CS0</th>
      <th>1/LE</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </tfoot>
</table>

          <t>As a result of ToS Precedence Bleaching, each of the DSCPs in a
          column are re-marked to the smallest DSCP in that column.
          Therefore, the DSCPs in the bottom row have higher survivability
          across an end-to-end Internet path.
          </t>
          <t>Data on the observed re-marking at the time of writing was
          presented in <xref target="IETF115-IEPG"/>.</t>

<table anchor="table4" align="center">
<name>0b000xxx DSCPs</name>
  <thead>
    <tr>
      <th>0/&wj;CS0</th>
      <th>1/&wj;LE</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="1" colspan="2">Assigned</td>
      <td>Re-marked from AF11..41</td>
      <td>EXP/LU</td>
      <td>*</td>
      <td></td>
      <td>Re-marked from AF13..EF</td>
      <td>EXP/LU</td>
    </tr>
  </tbody>
</table>

<dl spacing="normal" newline="false">
  <dt>*</dt>
  <dd>DSCP 4 has been historically used by the SSH application <xref
  target="Kol10"/></dd>
</dl>

          <t><xref target="table4"/> shows 0b000xxx DSCPs. This highlights
          any current assignments and whether they are affected by any known
          re-marking behaviors, such as ToS Precedence Bleaching.</t>

          <t>DSCPs of the form 0b000xxx can be impacted by known re-marking
          behaviors of other assigned DSCPs.  For example, ToS Precedence
          Bleaching of popular DSCPs AF11, AF21, AF31, and AF41 would result in
          traffic being re-marked with DSCP 2 in the Internet core.  The
          Lower Effort (LE) Per-Hop Behavior PHB uses a DSCP of 1. The DSCP
          value of 4 has been historically used by the SSH application,
          following semantics that precede Diffserv <xref
          target="Kol10"/>.</t>

          <t>Bleach-ToS-Precedence (see <xref target="observed-re-marking"/>)
          of packets with a DSCP 'x' results in the DSCP being re-marked to 'x'
          &amp; 0x07 and then forwarded using the PHB specified for the
          resulting DSCP in that Diffserv domain.  In subsequent networks, the
          packet will receive treatment as specified by the domain's operator
          corresponding to the re-marked codepoint.</t>
          <t>A variation of this observed re-marking behavior clears the top
          three bits of a DSCP, unless these have values 0b110 or 0b111
          (corresponding to the CS6 and CS7 DSCPs). As a result, a DSCP value
          greater than 48 decimal (0x30) is less likely to be impacted by ToS
          Precedence Bleaching.</t>
        </section>
        <section>
          <name>Impact of ToS Precedence Re-marking</name>
          <t><xref target="RFC2474"/> states:</t>
	  <blockquote>Implementors should note that the DSCP field is six bits
	  wide. DS-compliant nodes <bcp14>MUST</bcp14> select PHBs by matching
	  against the entire 6-bit DSCP field, e.g., by treating the value of
	  the field as a table index which is used to select a particular
	  packet handling mechanism which has been implemented in that
	  device.</blockquote> 

	  <t>This replaced re-marking according to ToS precedence (see <xref
	  target="observed-re-marking"/>) <xref target="RFC1349"/>. These
	  practices based on ToS semantics have not yet been eliminated from
	  deployed networks.</t>

<figure anchor="fig3">
<name>Bits in the Diffserv Field Modified by ToS Precedence Re-marking</name>
<artwork><![CDATA[
+-+-+-+-+-+-+
|5|4|3|2|1|0|
+-+-+-+-+-+-+
|0 0 1|x x x|
+-+-+-+-+-+-+
]]></artwork>
</figure>

          <t><xref target="fig3"/> shows the ToS Precedence Re-marking
          (see <xref target="observed-re-marking"/>) observed
          behavior, based on <xref target="RFC1349" sectionFormat="of"
          section="3"/>. The bit positions marked 'x' remain unchanged.</t>
          <t>A less common re-marking, ToS Precedence Re-marking sets the
          first three bits of the DSCP to a non-zero value corresponding to a
          CS PHB. This re-marking occurs when routers are not configured to
          perform Diffserv re-marking.
          </t>
          <t>If ToS Precedence Re-marking occurs, packets are forwarded using
          the PHB specified for the resulting DSCP in that domain.  For
          example, the AF31 DSCP (0x1a) could be re-marked to either AF11 or
          AF21.  If such a re-marked packet further traverses other Diffserv
          domains, it would receive treatment as specified by each domain's
          operator corresponding to the re-marked codepoint.</t>
        </section>
      </section>
      <section anchor="re-mark">
        <name>Re-marking to a Particular DSCP</name>
        <t>A network device might re-mark the Diffserv field of an IP packet
        based on a local policy with a specific set of DSCPs (see <xref
        target="observed-re-marking"/>).
        </t>
        <t><xref target="RFC2474" sectionFormat="of" section="3"/> recommends:
        "Packets received with an unrecognized codepoint <bcp14>SHOULD</bcp14>
        be forwarded as if they were marked for the Default behavior, and
        their codepoints should not be changed."  Some networks might not
        follow this recommendation and instead re-mark packets with these
        codepoints to the default class: CS0 (0x00).  This re-marking is
        sometimes performed using a Multi-Field (MF) classifier <xref
        target="RFC2475"/> <xref target="RFC3290"/> <xref target="RFC4594"/>.
        </t>
        <t>	
        If re-marking occurs, packets are forwarded using the PHB specified
        for the resulting DSCP in that domain.  As an example, re-marking
        traffic AF31, AF32, and AF33 all to a single DSCP, e.g., AF11, stops
        any drop probability differentiation, which may have been expressed by
        these three DSCPs. If such a re-marked packet further traverses other
        domains, it would receive treatment as specified by the domain's
        operator corresponding to the re-marked codepoint. Bleaching (see
        <xref target="observed-re-marking"/>) is a specific example of this
        observed re-marking behavior that re-marks to CS0 (0x00) (see <xref
        target="Bleaching"/>).</t>
      </section>
    </section>
    <section anchor="lowerlayers">
      <name>Interpretation of the IP DSCP at Lower Layers</name>
      <t>Transmission systems and subnetworks can, and do, utilize the
      Diffserv field in an IP packet to set a QoS-related field or function at
      the lower layer.  A lower layer could also implement a
      traffic-conditioning function that could re-mark the DSCP used at the IP
      layer.  This function is constrained by designs that utilize fewer than
      6 bits to express the service class and, therefore, infer a mapping to a
      smaller L2 QoS field, for example, the 3-bit Priority Code Point (PCP) field in an IEEE
      Ethernet 802.1Q header, the 3-bit User Priority (UP) field, or the 3-bit Traffic Class
      field of Multi-Protocol Label Switching (MPLS).  A Treatment Aggregate
      (TA) <xref target="RFC5127"/> is an optional intermediary mapping group
      of BAs to PHBs.
      </t>
      <section>
        <name>Mapping Specified for IEEE 802</name>
        <t>The IEEE specifies standards that include mappings for DSCPs to
        lower layer elements.</t>
        <section>
          <name>Mapping Specified for IEEE 802.1</name>
          <t>IEEE 802.1Q specified a 3-bit PCP field, which includes a tag
          that allows Ethernet frames to be marked as one of eight priority
          values <xref target="IEEE-802.1Q"/>. Use of this field is
          described by various documents, including IEEE P802.1p and IEEE
          802.1D.</t>
          <t>The mapping specified in <xref target="IEEE-802.1Q"/>
          revises a previous standard, <xref target="IEEE-802.1D"/>, in
          an effort to align with Diffserv practice <xref target="RFC4594"/>.
          In 802.1Q, the traffic types are specified to match the first three
          bits of a suitable DSCP (e.g., the first three bits of the Expedited Forwarding (EF) DSCP
          are mapped to a PCP of 5).</t> <t> In this mapping, PCP0 is used to
          indicate the default Best Effort treatment, and PCP1 indicates a
          background traffic class.  The remaining PCP values
          indicate increasing priority.  Internet control traffic can be
          marked as CS6, and network control is marked as CS7.</t>
          <t>Other re-marking behaviors have also been implemented in Ethernet
          equipment.  Historically, a previous standard, <xref
          target="IEEE-802.1D"/>, used both PCP1 (Background) and PCP2
          (Spare) to indicate lower priority than PCP0, and some other devices
          do not assign a lower priority to PCP1.</t>
        </section>
        <section anchor="mapping_for_802.11">
          <name>Mapping Specified for IEEE 802.11</name>
          <t><xref target="RFC8325" sectionFormat="of" section="6"/> provides
          a brief overview of IEEE 802.11 QoS. The IEEE <xref
          target="IEEE-802.11">802.11 standards</xref> provide Media
          Access Control (MAC) functions to support QoS in WLANs using Access
          Categories (ACs). The upstream UP in the 802.11 header has a 3-bit QoS
          value. A DSCP can be mapped to the UP. <xref target="RFC8622"/>
          added a mapping for the LE DSCP to
          AC_BK (Background).</t>
          <t>Most current Wi-Fi implementations use a default mapping that
          maps the first three bits of the DSCP to the 802.11 UP value. This
          is an example of equipment still classifying on ToS Precedence
          (which could be seen as a simple method to map IP layer Diffserv to
          layers offering only 3-bit QoS codepoints). Then, in turn, this is
          mapped to the four Wi-Fi Multimedia (WMM) Access Categories. The
          Wi-Fi Alliance has also specified a more flexible mapping that
          follows <xref target="RFC8325"/> and provides functions at an Access
          Point (AP) to re-mark packets as well as a QoS Map that maps each
          DSCP to an AC <xref target="WIFI-ALLIANCE"/>.</t>


<figure anchor="fig4">
<name>DSCP Bits Commonly Mapped to the UP in 802.11</name>
<artwork><![CDATA[
+-+-+-+-+-+-+
|5|4|3|2|1|0|
+-+-+-+-+-+-+
|x x x|. . .|
+-+-+-+-+-+-+
]]></artwork>
</figure>

<t>The bit positions marked 'x' are mapped
to the 3-bit UP value, while the ones marked '.' are ignored.</t>

          <t><xref target="RFC8325"/> notes inconsistencies that
          can result from such re-marking and recommends a different mapping
          to perform this re-marking, dependent on the direction in which a
          packet is forwarded.  It provides recommendations for mapping a DSCP
          to an IEEE 802.11 UP for interconnection between wired and wireless
          networks.  The recommendation in <xref target="mapping_for_802.11"/> maps network control
          traffic, CS6 and CS7, as well as unassigned DSCPs, to UP 0 when
          forwarding in the upstream direction (wireless-to-wired).  It also
          recommends mapping CS6 and CS7 traffic to UP 7 when forwarding in
          the downstream direction (<xref target="RFC8325" sectionFormat="of" section="4.1"/>).</t>
          <t>For other UPs, <xref target="RFC8325"/> recommends a mapping in
          the upstream direction (wireless-to-wired interconnections) that derives the DSCP from the value of the
          UP multiplied by 8.  This mapping, currently used by
          some Access Points (APs), can result in a specific DSCP re-marking behavior:</t>

	  <blockquote>wherein DSCP values are derived from UP values by
	  multiplying the UP values by 8 (i.e., shifting the three UP bits to
	  the left and adding three additional zeros to generate a DSCP
	  value).  This derived DSCP value is then used for QoS treatment
	  between the wireless AP and the nearest classification and marking
	  policy enforcement point (which may be the centralized wireless LAN
	  controller, relatively deep within the network).  Alternatively, in
	  the case where there is no other classification and marking policy
	  enforcement point, then this derived DSCP value will be used on the
	  remainder of the Internet path.</blockquote>
	
	  <t>This can result in re-marking by Bleach-low (see <xref
	  target="observed-re-marking"/>).</t>

<figure anchor="fig5">
<name>Bits in the Diffserv Field Modified by Re-marking Observed as a Result of UP-to-DSCP Mapping in Some 802.11 Networks</name>
<artwork><![CDATA[
+-+-+-+-+-+-+
|5|4|3|2|1|0|
+-+-+-+-+-+-+
|x x x|0 0 0|
+-+-+-+-+-+-+
]]></artwork>
</figure>

          <t>An alternative to UP-to-DSCP remapping uses the DSCP value of a
          downstream IP packet (e.g., the Control and Provisioning of Wireless
          Access Points, CAPWAP, protocol <xref target="RFC5415"/> maps an IP
          packet Diffserv field to the Diffserv field of the outer IP header
          in a CAPWAP tunnel).</t>
          <t>Some current constraints of Wi-Fi mapping are discussed in <xref
          target="RFC8325" sectionFormat="of" section="2"/>. A QoS profile can
          be used to limit the maximum DSCP value used for the upstream and
          downstream traffic.</t>
        </section>
      </section>
      <section anchor="mpls">
        <name>Diffserv and MPLS</name>
        <t>Multi-Protocol Label Switching (MPLS) specified eight MPLS Traffic
        Classes (TCs), which restrict the number of different treatments <xref
        target="RFC5129"/>.  <xref target="RFC5127"/> describes the
        aggregation of Diffserv service classes and introduces four Diffserv TAs.  Traffic
        marked with multiple DSCPs can be forwarded in a single MPLS TC.</t>
        <t>There are three Label Switching Router (LSR) models: the Pipe, the
        Short Pipe, and the Uniform Model <xref target="RFC3270"/>.  In the
        Uniform and Pipe models, the egress MPLS router forwards traffic based
        on the received MPLS TC. The Uniform Model includes an egress DSCP
        rewrite. With the Short Pipe Model, the egress MPLS router forwards
        traffic based on the Diffserv DSCP as present at the egress router. If
        the domain supports IP and MPLS QoS differentiation, controlled
        behavior requires the DSCP of an (outer) IP header to be assigned or
        re-written by all domain ingress routers to conform with the domain's
        internal Diffserv deployment.  Note that the Short Pipe Model is
        prevalent in MPLS domains.
        </t>
        <section>
          <name>Mapping Specified for MPLS</name>
          <t><xref target="RFC3270"/> defines a flexible solution
          for support of Diffserv over MPLS networks. This allows an MPLS
          network administrator to select how BAs (marked by DSCPs) are mapped
          onto Label Switched Paths (LSPs) to best match the Diffserv, Traffic
          Engineering, and protection objectives within their particular
          network.</t>
          <t>Mappings from the IP DSCP to the MPLS header are defined in
          <xref target="RFC3270" sectionFormat="of" section="4.2"/>.</t>
          <t>The Pipe Model conveys the "LSP Diff-Serv Information"
          to the LSP Egress so that its forwarding treatment can be based on
          the IP DSCP.</t>
          <t>When Penultimate Hop Popping (PHP) is used, the Penultimate LSR
          needs to be aware of the encapsulation mapping for a PHB to the
          label corresponding to the exposed header to perform Diffserv
          Information Encoding (<xref target="RFC3270" sectionFormat="of"
          section="2.5.2"/>).</t>
        </section>
        <section>
          <name>Mapping Specified for MPLS Short Pipe</name>
          <t>The Short Pipe Model is an optional variation of the Pipe Model
          <xref target="RFC3270"/>.</t>
          <t><xref target="ITU-T-Y.1566">ITU-T Y.1566</xref> further defined a
          set of four common QoS classes and four auxiliary classes to which a
          DSCP can be mapped when interconnecting Ethernet, IP, and MPLS
          networks. <xref target="RFC8100"/> describes four
          TAs for interconnection with four defined DSCPs.
          This was motivated by the requirements of MPLS network operators
          that use Short Pipe tunnels but can be applicable to other
          networks, both MPLS and non-MPLS.</t>
          <t><xref target="RFC8100"/> recommends preserving the notion of
          end-to-end service classes and recommends a set of standard DSCPs
          mapped to a small set of standard PHBs at interconnection.  The key
          requirement is that the DSCP at the network ingress is restored at
          the network egress.  The current version of <xref target="RFC8100"/>
          limits the number of DSCPs to 6, and 3 more are suggested for
          extension.  <xref target="RFC8100"/> respects the deployment of PHB
          groups for DS domain-internal use, which limits the number of
          acceptable external DSCPs (and possibilities for their transparent
          transport or restoration at network boundaries).  In this design,
          packets marked with DSCPs not part of the codepoint scheme <xref
          target="RFC8100"/> are treated as unexpected and will possibly be
          re-marked (a Re-mark-DSCP, see <xref target="observed-re-marking"/>
          behavior) or dealt with via additional agreements among the
          operators of the interconnected networks.  <xref target="RFC8100"/>
          can be extended to support up to 32 DSCPs by future standards. <xref
          target="RFC8100"/> is operated by at least one Tier 1 backbone
          provider.  Use of the MPLS Short Pipe Model favors re-marking
          unexpected DSCP values to zero in the absence of additional
          agreements, as explained in <xref target="RFC8100"/>. This can
          result in bleaching (see <xref target="observed-re-marking"/>).
          </t>

<table anchor="table5" align="center">
  <name>The Short Pipe MPLS Mapping from <xref target="RFC8100"/></name>
  <thead>
    <tr>
      <th>Treatment Aggregate <xref target="RFC8100"/></th>
      <th align="center">DSCP</th>
    </tr>
  </thead>
    <tbody>
    <tr>
      <td>Telephony&nbsp;Service&nbsp;Treatment&nbsp;Aggregate</td>
      <td align="center">EF<br/>VA</td>
    </tr>
    <tr>
      <td>Bulk Real-Time Treatment Aggregate</td>
      <td align="center">AF41<br/>(AF42)*<br/>(AF43)*</td>
    </tr>
    <tr>
      <td>Assured Elastic Treatment Aggregate</td>
      <td align="center">AF31<br/>AF32<br/>(AF33)**</td>
    </tr>
    <tr>
      <td>Default / Elastic Treatment Aggregate</td>
      <td align="center">BE/CS0</td>
    </tr>
    <tr>
      <td>Network Control: Local Use (LU)</td>
      <td align="center">CS6</td>
    </tr>
  </tbody>
</table>

        <dl spacing="normal" newline="false">
	    <dt>*</dt>
	    <dd>May be added</dd>
	    <dt>**</dt>
	    <dd>Reserved for the extension of PHBs</dd>
	</dl>

        </section>
      </section>
      <section>
        <name>Mapping Specified for Mobile Networks</name>
        <t>Mobile LTE and 5G standards have evolved from older Universal
        Mobile Telecommunications System (UMTS) standards and support
        Diffserv. LTE (4G) and 5G standards <xref target="SA-5G"/> identify
        traffic classes at the interface between User Equipment (UE) and the
        mobile Packet Core network by QCI (QoS Class Identifiers) and 5QI (5G
        QoS Identifier). The 3GPP standards do not define or recommend any
        specific mapping between each QCI or 5QI and Diffserv (and mobile QCIs
        are based on several criteria service class definitions). The way
        packets are mapped at the Packet Data Network Gateway (P-GW) boundary
        is determined by network operators. However, TS 23.107 (version
        16.0.0, applies to LTE and below) mandates that Differentiated
        Services, defined by the IETF, shall be used to interoperate with IP
        backbone networks.</t>
        <t>The GSM Association (GSMA) has defined four aggregated classes and
        seven associated PHBs in their guidelines for IP Packet eXchange (IPX) Provider networks
        <xref target="GSMA-IR.34"/>.  This was previously specified as the
        "Inter-Service Provider IP Backbone Guidelines" and provides a mobile
        ISP to ISP QoS mapping mechanism and interconnection with other IP
        networks in the general Internet. If provided an IP VPN, the operator
        is free to apply its DS domain-internal codepoint scheme at outer
        headers and inner IPX DSCPs may be transported transparently.  The
        guidelines also describe a case where the DSCP marking from a Service
        Provider cannot be trusted (depending on the agreement between the
        Service Provider and its IPX Provider). In this situation, the IPX
        Provider can re-mark the DSCP value to a static default value.
        </t>

<table anchor="table6" align="center">
  <name>The PHB Mapping Recommended in the Guidelines Recommended in <xref
  target="GSMA-IR.34"/></name>
  <thead>
    <tr>
      <th><t>QoS Class in <xref target="GSMA-IR.34"/></t></th>
      <th>PHB</th>
    </tr>
  </thead>
    <tbody>
    <tr>
      <td>Conversational</td>
      <td>EF</td>
    </tr>
    <tr>
      <td>Streaming</td>
      <td>AF41</td>
    </tr>
    <tr>
      <td rowspan="4"><t>Interactive</t><t>(ordered by priority, AF3 highest)</t></td>
      <td>AF31</td>
    </tr>
    <tr>
      <td>AF32</td>
    </tr>
    <tr>
      <td>AF21</td>
    </tr>
    <tr>
      <td>AF11</td>
    </tr>
    <tr>
      <td>Background</td>
      <td>CS0</td>
    </tr>
  </tbody>
</table>

      </section>
      <section>
        <name>Mapping Specified for Carrier Ethernet</name>
        <t>MEF Forum (MEF) provides a mapping of DSCPs at
        the IP layer to quality of service markings in the Ethernet frame
        headers <xref target="MEF-23.1"/>.</t>
      </section>
      <section>
        <name>Re-marking as a Side Effect of Another Policy</name>
        <t>This includes any other re-marking that does not happen as a result
        of traffic conditioning, such as policies and L2 procedures that
        result in re-marking traffic as a side effect of other functions
        (e.g., in response to Distributed Denial of Service, DDoS).</t>
      </section>
      <section>
        <name>Summary</name>
        <t>This section has discussed the various ways in which DSCP
        re-marking behaviors can arise from interactions with lower
        layers.</t>
        <t> A provider service path may consist of sections where multiple and
        changing layers use their own code points to determine differentiated
        forwarding (e.g., IP to MPLS to IP to Ethernet to Wi-Fi).</t>
      </section>
    </section>
    <section>
      <name>Considerations for DSCP Selection</name>
      <t>This section provides advice for the assignment of a new DSCP value.
      It is intended to aid the IETF and IESG in considering a request for a
      new DSCP.  This section identifies known issues that might influence the
      finally assigned DSCP and provides a summary of considerations for
      assignment of a new DSCP.</t>
      <section>
        <name>Effect of Bleaching and Re-marking to a Single DSCP</name>
        <t><xref target="observed-re-marking"/> describes re-marking of the
        DSCP.  New DSCP assignments should consider the impact of bleaching or
        re-marking (see <xref target="observed-re-marking"/>) to a single
        DSCP, which can limit the ability to provide the expected treatment
        end-to-end.  This is particularly important for cases where the
        codepoint is intended to result in lower than Best Effort treatment,
        as was the case when defining the LE PHB <xref target="RFC8622"/>.
        Forwarding LE using the default PHB is in line with <xref
        target="RFC8622"/>, but it is recommended to maintain the distinct LE
        DSCP codepoint end-to-end to allow for differentiated treatment by
        domains supporting LE. Rewriting the LE DSCP to the default class
        (CS0) results in an undesired promotion of the priority for LE traffic
        in such a domain.  Bleaching the lower three bits of the DSCP (both
        Bleach-low and Bleach-some-low in <xref
        target="observed-re-marking"/>), as well as re-marking to a particular
        DSCP, can result in similar changes of priority relative to traffic
        that is marked with other DSCPs.
        </t>
      </section>
      <section>
        <name>Where the Proposed DSCP &gt; 0x07 (7)</name>
	<t>This considers a proposed DSCP with a codepoint larger than 7.</t>
        <t>Although the IETF specifications require systems to use DSCP
        marking semantics in place of methods based on the former ToS field,
        the current recommendation is that any new assignment where the DSCP
        is greater than 0x07 should consider the semantics associated with the
        resulting DSCP when the ToS Precedence is bleached
        (Bleach-ToS-Precedence and Bleach-some-ToS, <xref
        target="observed-re-marking"/>) or ToS Precedence Re-marking
        (Re-mark-ToS, <xref target="observed-re-marking"/>) is experienced. For
        example, it can be desirable to avoid choosing a DSCP that could be
        re-marked to LE, <xref target="RFC8622">Lower Effort</xref>, which
        could otherwise potentially result in a priority inversion in the
        treatment.</t>

        <section>
          <name>Where the Proposed DSCP&amp;0x07=0x01</name>
	  <t>This considers a proposed DSCP where the least significant 3 bits together represent a value of 1 (i.e., 0b001).</t>
          <t>As a consequence of assigning the LE PHB <xref
          target="RFC8622"/>, the IETF allocated the DSCP 0b000001 from Pool
          3.</t>
          <t>When making assignments where the DSCP has a format "0bxxx001",
          the case of Bleach-ToS-Precedence (<xref
          target="observed-re-marking"/>) of a DSCP to a value of 0x01 needs
          to be considered. ToS Precedence Bleaching will result in demoting
          the traffic to the Lower Effort PHB. Care should be taken
          to consider the implications of re-marking when choosing to assign a
          DSCP with this format.</t>
        </section>
      </section>
      <section>
        <name>Where the Proposed DSCP &lt;= 0x07 (7)</name>
	<t>This considers a proposed DSCP where the DSCP is less than or equal to 7.</t>
        <t>ToS Precedence Bleaching or ToS Precedence Re-marking can
        unintentionally result in extra traffic aggregated to the same
        DSCP. For example, after experiencing ToS Precedence Bleaching, all
        traffic marked AF11, AF21, AF31, and AF41 would be aggregated with
        traffic marked with DSCP 2 (0x02), increasing the volume of traffic
        that receives the treatment associated with DSCP 2.  New DSCP
        assignments should consider unexpected consequences arising from this
        observed re-marking behavior.</t>
      </section>
      <section anchor="networks">
        <name>Impact on Deployed Infrastructure</name>
        <t>Behavior of deployed PHBs and conditioning treatments also needs to
        be considered when assigning a new DSCP. Network operators have
        choices when it comes to configuring Diffserv support within their
        domains, and the observed re-marking behaviors described in the
        previous section can result from different configurations and
        approaches:</t>
        <dl newline="true" spacing="normal">
          <dt>Networks not re-marking Diffserv:</dt>
          <dd>A network that either does not implement PHBs or implements one
          or more PHBs while restoring the DSCP field at network egress with
          the value at network ingress. Operators in this category pass all
          DSCPs transparently.</dd>
          <dt>Networks that condition the DSCP:</dt>
          <dd>A network that implements more than one PHB and enforces Service
          Level Agreements (SLAs) with its peers. Operators in this category
          use conditioning to ensure that only traffic that matches a policy
          is permitted to use a specific DSCP (see <xref target="RFC8100"/>).
          Operators need to classify the received traffic, assign it to a
          corresponding PHB, and could re-mark the DSCP to a value that is
          appropriate for the domain's deployed Diffserv infrastructure.</dd>
          <dt>Networks that re-mark in some other way, which includes:</dt>
          <dd>
            <ol spacing="normal" type="1">
	      <li>Networks containing misconfigured devices that do not comply
	      with the relevant RFCs.</li>
              <li>Networks containing devices that implement an obsolete
              specification or contain software bugs.</li>
              <li>Networks containing devices that re-mark the DSCP as a
              result of lower layer interactions.</li>
            </ol>
          </dd>
        </dl>
        <t> The DSCP re-marking corresponding to the Bleach-ToS-Precedence
        (<xref target="observed-re-marking"/>)
        observed behavior can arise for various reasons, one of which is old
        equipment that precedes Diffserv.  The same re-marking can also arise
        in some cases when traffic conditioning is provided by Diffserv
        routers at operator boundaries or as a result of misconfiguration.
        </t>
      </section>
      <section>
        <name>Considerations to Guide the Discussion of a Proposed New
        DSCP</name>
        <t>A series of questions emerge that need to be answered when
        considering a proposal to the IETF that requests a new assignment.
        These questions include:</t>
        <ul spacing="normal">
          <li>Is the request for Local Use within a Diffserv domain that does
          not require interconnection with other Diffserv domains? This
          request can use DSCPs in Pool 2 for Local or Experimental Use,
          without any IETF specification for the DSCP or associated PHB.</li>
          <li>What are the characteristics of the proposed service class?
          What are the characteristics of the traffic to be carried? What are
          the expectations for treatment? </li>
          <li>Service classes <xref target="RFC4594"/> that can utilize
          existing PHBs should use assigned DSCPs to mark their traffic: Could
          the request be met by using an existing IETF DSCP?</li>
          <li>Specification of a new recommended DSCP requires Standards
          Action.  <xref target="RFC2474"/> states: "Each standardized PHB
          <bcp14>MUST</bcp14> have an associated <bcp14>RECOMMENDED</bcp14>
          codepoint". If approved, new IETF assignments are normally made by
          IANA in Pool 1, but the IETF can request assignments to be made from
          Pool 3 <xref target="RFC8436"/>.  Does the Internet Draft contain an
          appropriate request to IANA?</li>
          <li>The value selected for a new DSCP can impact the ability of an
          operator to apply logical functions (e.g., a bitwise mask) to
          related codepoints when configuring Diffserv.  A suitable value can
          simplify configurations by aggregating classification on a range of
          DSCPs. This classification based on DSCP ranges can increase the
          comprehensibility of documenting forwarding differentiation.</li>
          <li> <xref target="mpls"/> describes examples of treatment
          aggregation. What are the effects of treatment aggregation on the
          proposed DSCP? </li>
          <li> <xref target="lowerlayers"/> describes some observed treatments
          by layers below IP. What are the implications of the treatments and
          mapping described in <xref target="lowerlayers"/> on the proposed
          DSCP? </li>
          <li>DSCPs are assigned to PHBs and can be used to enable nodes along
          an end-to-end path to classify the packet for a suitable PHB.  <xref
          target="observed-re-marking"/> describes some observed re-marking
          behavior, and <xref target="networks"/> identifies root causes for
          why this re-marking is observed.  What is the expected effect of
          currently-deployed re-marking on the service, end-to-end or
          otherwise?</li>
        </ul>
      </section>
    </section>
    <section anchor="IANA">
      <name>IANA Considerations</name>
<t>IANA has added the following text as a note at the top of the "Differentiated Services Field Codepoints (DSCP)" registry <xref target="DSCP-registry"/>: "See RFC 9435 for considerations when assigning a new codepoint from the DSCP registry."
</t>
</section>
    <section anchor="Security">
      <name>Security Considerations</name>
      <t>The security considerations are discussed in the security
      considerations of each cited RFC.</t>
    </section>
  </middle>
  <back>

<displayreference target="I-D.ietf-tsvwg-nqb" to="NQB-PHB"/>
<displayreference target="I-D.learmonth-intarea-rfc1226-bis" to="AX.25-over-IP"/>

    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2474.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2475.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3260.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3290.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4594.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5129.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8100.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8436.xml"/>


        <reference anchor="DSCP-registry" target="https://www.iana.org/assignments/dscp-registry/">
          <front>
            <title>Differentiated Services Field Codepoints (DSCP)</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>

      </references>

      <references>
        <name>Informative References</name>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.0791.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1122.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.1349.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2597.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3086.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3246.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>

<reference anchor="RFC3270" target="https://www.rfc-editor.org/info/rfc3270">
<front>
<title>
Multi-Protocol Label Switching (MPLS) Support of Differentiated Services
</title>
<author fullname="F. Le Faucheur" initials="F." surname="Le Faucheur" role="editor"/>
<author fullname="L. Wu" initials="L." surname="Wu"/>
<author fullname="B. Davie" initials="B." surname="Davie"/>
<author fullname="S. Davari" initials="S." surname="Davari"/>
<author fullname="P. Vaananen" initials="P." surname="Vaananen"/>
<author fullname="R. Krishnan" initials="R." surname="Krishnan"/>
<author fullname="P. Cheval" initials="P." surname="Cheval"/>
<author fullname="J. Heinanen" initials="J." surname="Heinanen"/>
<date month="May" year="2002"/>
</front>
<seriesInfo name="RFC" value="3270"/>
<seriesInfo name="DOI" value="10.17487/RFC3270"/>
</reference>

      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3662.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5127.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5160.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5415.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5865.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8325.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8622.xml"/>

      <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-tsvwg-nqb.xml"/>

      <reference anchor="Kol10" target="https://lists.freebsd.org/pipermail/freebsd-stable/2010-July/057710.html">
          <front>
            <title>Subject: bogus DSCP value for ssh</title>
            <author initials="A." surname="Kolu"/>
            <date day="12" month="July" year="2010"/>
          </front>
	  <refcontent>message to the freebsd-stable mailing list</refcontent>
        </reference>

        <reference anchor="Cus17">
          <front>
            <title>Exploring DSCP modification pathologies in mobile edge
          networks</title>
            <author initials="A." surname="Custura"/>
            <author initials="A." surname="Venne"/>
            <author initials="G." surname="Fairhurst"/>
            <date month="June" year="2017"/>
          </front>
          <seriesInfo name="DOI" value="10.23919/TMA.2017.8002923"/>
	  <refcontent>2017 Network Traffic Measurement and Analysis Conference (TMA)</refcontent>
        </reference>

        <reference anchor="Bar18">
          <front>
            <title>Can WebRTC QoS Work? A DSCP Measurement Study</title>
            <author initials="R." surname="Barik"/>
            <author initials="M." surname="Welzl"/>
            <author initials="A." surname="Elmokashfi"/>
            <author initials="T." surname="Dreibholz"/>
            <author initials="S." surname="Gjessing"/>
            <date month="September" year="2018"/>
          </front>
	  <seriesInfo name="DOI" value="10.1109/ITC30.2018.00034"/>
	  <refcontent>2018 30th International Teletraffic Congress (ITC 30)</refcontent>
        </reference>

        <reference anchor="SA-5G">
          <front>
            <title>System architecture for the 5G System (5GS)</title>
            <author>
              <organization>3GPP</organization>
            </author>
            <date year="2019"/>
          </front>
          <seriesInfo name="TS" value="23.501"/>
        </reference>

        <reference anchor="GSMA-IR.34" target="https://www.gsma.com/newsroom/wp-content/uploads/IR.34-v17.0.pdf">
          <front>
            <title>Guidelines for IPX Provider networks (Previously
            Inter-Service Provider IP Backbone Guidelines)</title>
            <author>
              <organization>GSM Association</organization>
            </author>
            <date month="May" year="2021"/>
          </front>
	  <refcontent>Version 17.0, IR.34</refcontent>
        </reference>

        <reference anchor="ITU-T-Y.1566" target="https://www.itu.int/rec/T-REC-Y.1566/en">
          <front>
            <title>Quality of service mapping and interconnection between
            Ethernet, Internet Protocol and multiprotocol label switching
            networks</title>
            <author>
              <organization>ITU-T Recommendation</organization>
            </author>
            <date month="July" year="2012"/>
          </front>
          <seriesInfo name="ITU-T" value="Y.1566"/>
        </reference>

        <reference anchor="IEEE-802.11" target="https://standards.ieee.org/ieee/802.11/7028/">
          <front>
            <title>IEEE Standard for Information Technology -
            Telecommunications and Information Exchange Between Systems -
            Local and Metropolitan Area Networks - Specific Requirements -
            Part 11: Wireless LAN Medium Access Control (MAC) and Physical
            Layer (PHY) Specifications</title>
            <author>
              <organization>IEEE</organization>
            </author>
            <date month="February" year="2021"/>
          </front>
	  <seriesInfo name="DOI" value="10.1109/IEEESTD.2021.9363693"/>
          <seriesInfo name="IEEE Standard" value="802.11"/>
        </reference>

        <reference anchor="WIFI-ALLIANCE">
          <front>
            <title>Wi-Fi QoS Management Specification Version 2.0
            </title>
            <author>
              <organization>Wi-Fi Alliance</organization>
            </author>
            <date year="2021"/>
          </front>
        </reference>

        <reference anchor="IEEE-802.1Q">
          <front>
            <title>IEEE Standard for Local and Metropolitan Area
            Network--Bridges and Bridged Networks</title>
            <author>
              <organization>IEEE</organization>
            </author>
            <date month="July" year="2018"/>
          </front>
          <seriesInfo name="IEEE Standard" value="802.1Q-2018"/>
	  <seriesInfo name="DOI" value="10.1109/IEEESTD.2018.8403927"/>
        </reference>

        <reference anchor="IEEE-802.1D">
          <front>
            <title>IEEE Standard for Local and metropolitan area
            network--Media Access Control (MAC) Bridges</title>
            <author>
              <organization>IEEE</organization>
            </author>
            <date month="June" year="2004"/>
          </front>
          <seriesInfo name="IEEE Standard" value="802.1D-2004"/>
	  <seriesInfo name="DOI" value="10.1109/IEEESTD.2004.94569"/>
        </reference>

        <reference anchor="IETF115-IEPG" target="https://datatracker.ietf.org/meeting/115/materials/slides-115-iepg-sessa-considerations-for-assigning-dscps-01">
          <front>
            <title>Real-world DSCP Traversal Measurements</title>
            <author initials="A." surname="Custura">
              <organization>University of Aberdeen, UK</organization>
            </author>
	    <date month="November" year="2022"/>
          </front>
        </reference>

        <reference anchor="MEF-23.1" target="https://mef.net/Assets/Technical_Specifications/PDF/MEF_23.1.pdf">
          <front>
            <title>Implementation Agreement MEF 23.1 Carrier Ethernet Class of Service - Phase 2</title>
            <author>
              <organization>MEF</organization>
            </author>
            <date month="January" year="2012"/>
          </front>
          <seriesInfo name="MEF" value="23.1"/>
        </reference>

<!-- [I-D.learmonth-rfc1226-bis] replaced by [I-D.learmonth-intarea-rfc1226-bis] IESG state Expired -->

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.learmonth-intarea-rfc1226-bis.xml"/>

      </references>
    </references>


    <section anchor="Acknowledgements" numbered="false" toc="default">
      <name>Acknowledgements</name>
      <t>The authors acknowledge the helpful discussions and analysis by
      <contact fullname="Greg White"/> and <contact fullname="Thomas
      Fossati"/> in a draft concerning NQB. <contact fullname="Ruediger
      Geib"/> and <contact fullname="Brian Carpenter"/> contributed comments,
      along with other members of the TSVWG.</t>
    </section>

  </back>

</rfc>
