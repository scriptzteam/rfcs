<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE rfc [
 <!ENTITY nbsp    "&#160;">
 <!ENTITY zwsp   "&#8203;">
 <!ENTITY nbhy   "&#8209;">
 <!ENTITY wj     "&#8288;">
]> 

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-ietf-lisp-rfc6830bis-38" number="9300" obsoletes="6830" updates=""
submissionType="IETF" category="std" consensus="true" xml:lang="en" tocInclude="true"
symRefs="true" sortRefs="true" version="3">

  <!-- xml2rfc v2v3 conversion 3.6.0 -->

<front>
    <title abbrev="LISP">The Locator/ID Separation Protocol (LISP)</title>
    <seriesInfo name="RFC" value="9300"/>
    <author initials="D" surname="Farinacci" fullname="Dino Farinacci">
      <organization>lispers.net</organization>
      <address>
	<postal>
	  <city>San Jose</city>
	  <region>CA</region>
	  <country>United States of America</country>
	</postal>
        <email>farinacci@gmail.com</email>
      </address>
    </author>
    <author initials="V" surname="Fuller" fullname="Vince Fuller">
      <organization>vaf.net Internet Consulting</organization>
      <address>
        <email>vince.fuller@gmail.com</email>
      </address>
    </author>
    <author initials="D" surname="Meyer" fullname="Dave Meyer">
      <organization>1-4-5.net</organization>
      <address>
        <email>dmm@1-4-5.net</email>
      </address>
    </author>
    <author initials="D" surname="Lewis" fullname="Darrel Lewis">
      <organization>Cisco Systems</organization>
      <address>
        <postal>
          <city>San Jose</city>
          <region>CA</region>
          <country>United States of America</country>
        </postal>
        <email>darlewis@cisco.com</email>
      </address>
    </author>
    <author initials="A" surname="Cabellos" fullname="Albert Cabellos" role="editor">
      <organization>Universitat Politecnica de Catalunya</organization>
      <address>
        <postal>
          <street>c/ Jordi Girona s/n</street>
          <city>Barcelona</city>
	  <code>08034</code>
          <country>Spain</country>
        </postal>
        <email>acabello@ac.upc.edu</email>
      </address>
    </author>
    <date year="2022" month="October"/>
    <keyword>LISP data plane</keyword>
    <abstract>
      <t>This document describes the data plane protocol for the
      Locator/ID Separation Protocol (LISP). LISP defines two
      namespaces: Endpoint Identifiers (EIDs), which identify end hosts;
      and Routing Locators (RLOCs), which identify network attachment
      points. With this, LISP effectively separates control from data
      and allows routers to create overlay networks. LISP-capable
      routers exchange encapsulated packets according to EID-to-RLOC
      mappings stored in a local Map-Cache.</t>
      <t>LISP requires no change to either host protocol stacks or
      underlay routers and offers Traffic Engineering (TE),
      multihoming, and mobility, among other features.</t>
      <t>This document obsoletes RFC 6830.</t>
    </abstract>
  </front>
  <middle>
    <section numbered="true" toc="default">
      <name>Introduction</name>
      <t>This document describes the Locator/ID Separation
  Protocol (LISP). LISP is an encapsulation protocol built around the
  fundamental idea of separating the topological location of a network
  attachment point from the node's identity <xref target="CHIAPPA" format="default"/>. As a result, LISP creates two namespaces: Endpoint Identifiers
  (EIDs), which are used to identify end hosts (e.g., nodes or Virtual
  Machines); and routable Routing Locators (RLOCs), which are used to identify
  network attachment points.  LISP then defines functions for mapping
  between the two namespaces and for encapsulating traffic
  originated by devices using non-routable EIDs for transport across a
  network infrastructure that routes and forwards using RLOCs. LISP
  encapsulation uses a dynamic form of tunneling where no static provisioning
  is required or necessary.</t>
  <t>LISP is an overlay protocol that separates control from data; this
  document specifies the data plane as well as how LISP-capable
  routers (Tunnel Routers) exchange packets by encapsulating them to
  the appropriate location. Tunnel Routers are equipped with a cache,
  called the Map-Cache, that contains EID-to-RLOC mappings.  The Map-Cache
  is populated using the LISP control plane protocol <xref target="RFC9301" format="default"/>.</t>
      <t>LISP does not require changes to either the host protocol stack or
  underlay routers. By separating the EID from the RLOC space, LISP
  offers native Traffic Engineering (TE), multihoming, and mobility, among
  other features.</t>
      <t>Creation of LISP was initially motivated by discussions during
  the IAB-sponsored Routing and Addressing Workshop held in Amsterdam
  in October 2006 (see <xref target="RFC4984" format="default"/>).</t>
      <t>This document specifies the LISP data plane encapsulation and
  other LISP forwarding node functionality while <xref target="RFC9301" format="default"/> specifies the LISP control
  plane. LISP deployment guidelines can be found in <xref target="RFC7215" format="default"/>, and <xref target="RFC6835" format="default"/> describes
  considerations for network operational management.  Finally, <xref target="RFC9299" format="default"/> describes the LISP architecture.</t>
      <t>This document obsoletes RFC 6830.</t>
      <section anchor="soa" numbered="true" toc="default">
        <name>Scope of Applicability</name>
        <t>LISP was originally developed to address the Internet-wide
    route scaling problem <xref target="RFC4984" format="default"/>.
     While there are a number of approaches of
     interest for that problem, as LISP has been developed and refined, a
     large number of other ways to use LISP have been found and are being
     implemented. As such, the design and development of
    LISP have changed so as to focus on these use cases. The common
    property of these uses is a large set of cooperating entities
    seeking to communicate over the public Internet or other large
    underlay IP infrastructures while keeping the addressing and
    topology of the cooperating entities separate from the underlay
    and Internet topology, routing, and addressing.</t>
      </section>
    </section>
    <section numbered="true" toc="default">
      <name>Requirements Notation</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
    </section>
    <section anchor="DEFINITIONS" numbered="true" toc="default">
      <name>Definitions of Terms</name>
      <dl newline="false" spacing="normal">
        <dt>Address Family Identifier (AFI): </dt>
        <dd>"AFI" is a term used
	to describe an address encoding in a packet. An address family is an address
	format found in data plane packet headers,
	for example, an IPv4 address or an IPv6 address. See <xref target="AFN" format="default"/>, <xref target="RFC2453" format="default"/>, <xref target="RFC2677" format="default"/>, and <xref target="RFC4760" format="default"/> for details. An AFI
    value of 0 used in this specification indicates an unspecified
    encoded address where the length of the address is 0 octets
    following the 16-bit AFI value of 0.</dd>
        <dt>Anycast Address:</dt>
        <dd>"Anycast address" refers to the same
      IPv4 or IPv6 address configured
    and used on multiple systems at the same time. An EID or RLOC can
    be an anycast address in each of their own address spaces.</dd>
        <dt>Client-side:</dt>
        <dd>"Client-side" is a term used in this
    document to indicate a connection initiation attempt by an end-system
    represented by an EID.</dd>
        <dt>Egress Tunnel Router (ETR): </dt>
        <dd>An ETR is a router that
    accepts an IP packet where the destination address in the "outer"
    IP header is one of its own RLOCs. The router strips the "outer"
    header and forwards the packet based on the next IP header
    found. In general, an ETR receives LISP-encapsulated IP packets
    from the Internet on one side and sends decapsulated IP packets to
    site end-systems on the other side. ETR functionality does not
    have to be limited to a router device.  A server host can be the
    endpoint of a LISP tunnel as well.</dd>
        <dt>EID-to-RLOC Database: </dt>
        <dd>The EID-to-RLOC Database is a
    distributed database that contains all known EID-Prefix-to-RLOC
    mappings.  Each potential ETR typically contains a small piece of
    the database: the EID-to-RLOC mappings for the EID-Prefixes
    "behind" the router. These map to one of the router's own IP
    addresses that are routable on the underlay.

    Note that there <bcp14>MAY</bcp14> be transient conditions when the EID-Prefix
    for the LISP site and Locator-Set for each EID-Prefix may not be the
    same on all ETRs. This has no negative implications, since a
    partial set of Locators can be used.</dd>
        <dt>EID-to-RLOC Map-Cache: </dt>
        <dd>The EID-to-RLOC Map-Cache is a
    generally short-lived, on-demand table in an Ingress Tunnel Router (ITR) that stores, tracks, and
    is responsible for timing out and otherwise validating EID-to-RLOC
    mappings. This cache is distinct from the full "database" of
    EID-to-RLOC mappings; it is dynamic, local to the ITR(s), and
    relatively small, while the database is distributed, relatively
    static, and much more widely scoped to LISP nodes.</dd>
        <dt>EID-Prefix: </dt>
        <dd>An EID-Prefix is a power-of-two block
    of EIDs that are allocated to a site by an address allocation
    authority.  EID-Prefixes are associated with a set of RLOC
    addresses. EID-Prefix allocations can be broken up into smaller
    blocks when an RLOC-Set is to be associated with the larger
    EID-Prefix block.</dd>
        <dt>End-System: </dt>
        <dd>An end-system is an IPv4 or IPv6 device
    that originates packets with a single IPv4 or IPv6 header. The
    end-system supplies an EID value for the destination address field
    of the IP header when communicating outside of its routing domain.
    An end-system can be a host computer, a switch or router device,
    or any network appliance.</dd>
        <dt>Endpoint ID (EID): </dt>
        <dd>An EID is a 32-bit (for IPv4) or
    128-bit (for IPv6) value that identifies a host. EIDs are generally
    only found in the source and destination
    address fields of the first (innermost) LISP header of a
    packet. The host obtains a destination
    EID through a Domain Name System (DNS)  <xref target="RFC1034" format="default"/>
    lookup or Session Initiation Protocol (SIP) <xref target="RFC3261"
    format="default"/> exchange. This
    behavior does not change when LISP is in use. The
    source EID is obtained via existing mechanisms used to set a
    host's "local" IP address. An EID used on the public Internet <bcp14>MUST</bcp14>
    have the same properties as any other IP address used in that
    manner; this means, among other things, that it <bcp14>MUST</bcp14> be
    unique. An EID is allocated to a host from an EID-Prefix block
    associated with the site where the host is located.  An EID can be
    used by a host to refer to other hosts. Note that EID blocks <bcp14>MAY</bcp14>
    be assigned in a hierarchical manner, independent of the network
    topology, to facilitate scaling of the mapping database. In
    addition, an EID block assigned to a site <bcp14>MAY</bcp14> have site-local
    structure (subnetting) for routing within the site; this structure
    is not visible to the underlay routing system. In theory, the bit
    string that represents an EID for one device can represent an RLOC
    for a different device. When discussing other Locator/ID separation proposals, any
    references to an EID in this document will refer to a LISP EID.
	</dd>
        <dt>Ingress Tunnel Router (ITR): </dt>
        <dd>An ITR is a router
    that resides in a LISP site. Packets sent by sources inside of the
    LISP site to destinations outside of the site are candidates for
    encapsulation by the ITR. The ITR treats the IP destination
    address as an EID and performs an EID-to-RLOC mapping lookup. The
    router then prepends an "outer" IP header with one of its routable
    RLOCs (in the RLOC space) in the source address field and the
    result of the mapping lookup in the destination address field.
    Note that this destination RLOC may be an intermediate, proxy
    device that has better knowledge of the EID-to-RLOC mapping closer
    to the destination EID. In general, an ITR receives IP packets
    from site end-systems on one side and sends LISP-encapsulated IP
    packets toward the Internet on the other side.</dd>
        <dt>LISP Header: </dt>
        <dd>"LISP header" is a term used in this document to refer
    to the outer IPv4 or IPv6 header, a UDP header, and a LISP-
    specific 8-octet header, all of which follow the UDP header.  An
    ITR prepends LISP headers on packets, and an ETR strips them.</dd>
        <dt>LISP Router: </dt>
        <dd>A LISP router is a router that
    performs the functions of any or all of the following: ITRs, ETRs, Re-encapsulating Tunneling Routers (RTRs),
    Proxy-ITRs (PITRs), or Proxy-ETRs (PETRs).</dd>
        <dt>LISP Site:</dt>
        <dd>A LISP site is a set of routers in an edge
    network that are under a single technical administration. LISP
    routers that reside in the edge network are the demarcation points
    to separate the edge network from the core network.</dd>
        <dt>Locator-Status-Bits (LSBs):</dt>
        <dd> Locator-Status-Bits are
    present in the LISP header. They are used by ITRs to inform ETRs
    about the up/down status of all ETRs at the local site. These bits
    are used as a hint to convey up/down router status and not path
    reachability status. The LSBs can be verified by use of one of the
    Locator reachability algorithms described in <xref target="loc-reach" format="default"/>. An ETR <bcp14>MUST</bcp14> rate limit the action it takes
    when it detects changes in the Locator-Status-Bits.</dd>
        <dt>Proxy-ETR (PETR): </dt>
        <dd>A PETR is defined and described
    in <xref target="RFC6832" format="default"/>. A PETR acts like an ETR but does so
    on behalf of LISP sites that send packets to destinations at
    non-LISP sites.</dd>
        <dt>Proxy-ITR (PITR): </dt>
        <dd>A PITR is defined and described
    in <xref target="RFC6832" format="default"/>. A PITR acts like an ITR but does so
    on behalf of non-LISP sites that send packets to destinations at
    LISP sites.</dd>
        <dt>Recursive Tunneling: </dt>
        <dd>Recursive Tunneling occurs
    when a packet has more than one LISP IP header. Additional layers
    of tunneling <bcp14>MAY</bcp14> be employed to implement Traffic Engineering or
    other rerouting as needed. When this is done, an additional
    "outer" LISP header is added, and the original RLOCs are preserved
    in the "inner" header.</dd>
        <dt>Re-encapsulating Tunneling Router (RTR): </dt>
        <dd>
    An RTR acts like an ETR to remove a LISP header, then acts as an
    ITR to prepend a new LISP header. This is known as
    Re-encapsulating Tunneling. Doing this allows a packet to be
    rerouted by the RTR without adding the overhead of additional
    tunnel headers. When using multiple mapping database systems, care
    must be taken to not create re-encapsulation loops through
    misconfiguration.</dd>
        <dt>Route-Returnability:</dt>
        <dd>Route-returnability is an
    assumption that the underlying routing system will deliver packets
    to the destination. When combined with a nonce that is provided by
    a sender and returned by a receiver, this limits off-path data
    insertion. A route-returnability check is verified when a message
    is sent with a nonce, another message is returned with the same
    nonce, and the destination of the original message appears as the
    source of the returned message.</dd>
        <dt>Routing Locator (RLOC): </dt>
        <dd>An RLOC is an IPv4 address <xref target="RFC0791" format="default"/> or IPv6 address <xref target="RFC8200" format="default"/> of
    an Egress Tunnel Router (ETR). An RLOC is the output of an
    EID-to-RLOC mapping lookup. An EID maps to zero or more
    RLOCs. Typically, RLOCs are numbered from blocks that
    are assigned to a site at each point to which it attaches to the
    underlay network, where the topology is defined by the connectivity
    of provider networks. Multiple RLOCs can be assigned to the same
    ETR device or to multiple ETR devices at a site.</dd>
        <dt>Server-side:</dt>
        <dd>"Server-side" is a term used in this
    document to indicate that a connection initiation attempt is being
    accepted for a destination EID.</dd>
        <dt>xTR: </dt>
        <dd>An xTR is a reference to an ITR or ETR when
    direction of data flow is not part of the context description.
    "xTR" refers to the router that is the tunnel endpoint and is used
    synonymously with the term "Tunnel Router". For example, "An xTR
    can be located at the Customer Edge (CE) router" indicates both
    ITR and ETR functionality at the CE router.</dd>
      </dl>
    </section>
    <section anchor="OVERVIEW" numbered="true" toc="default">
      <name>Basic Overview</name>
      <t>One key concept of LISP is that end-systems operate the same way
      when LISP is not in use as well as when LISP is in use. The IP addresses that
      hosts use for tracking sockets
  and connections, and for sending and receiving packets, do not
  change. In LISP terminology, these IP addresses are called Endpoint
  Identifiers (EIDs).</t>
      <t>Routers continue to forward packets based on IP destination
  addresses. When a packet is LISP encapsulated, these addresses are
  referred to as RLOCs. Most routers along a path
  between two hosts will not change; they continue to perform
  routing/forwarding lookups on the destination addresses. For routers
  between the source host and the ITR as well as routers from the ETR
  to the destination host, the destination address is an EID. For the
  routers between the ITR and the ETR, the destination address is an
  RLOC.</t>
      <t>Another key LISP concept is the "Tunnel Router". A Tunnel Router
  prepends LISP headers on host-originated packets and strips them
  prior to final delivery to their destination. The IP addresses in
  this "outer header" are RLOCs. During end-to-end packet
  exchange between two Internet hosts, an ITR prepends a new LISP
  header to each packet, and an ETR strips the new header. The ITR
  performs EID-to-RLOC lookups to determine the routing path to the
  ETR, which has the RLOC as one of its IP addresses. </t>
      <t>Some basic rules governing LISP are:</t>
      <ul spacing="normal">
        <li>End-systems only send to addresses that are EIDs.  EIDs are
      typically IP addresses assigned to hosts (other types of EIDs are
      supported by LISP; see <xref target="RFC8060" format="default"/> for further
      information). End-systems don't know that addresses are EIDs
      versus RLOCs but assume that packets get to their intended
      destinations.  In a system where LISP is deployed, LISP routers
      intercept EID-addressed packets and assist in delivering them
      across the network core where EIDs cannot be routed.  The
      procedure a host uses to send IP packets does not change.</li>
      <li>LISP routers prepend and strip outer headers with RLOC addresses. See  <xref target="MOSTLY" format="default"/> for details.</li>
        <li>RLOCs are always IP addresses assigned to routers, preferably
      topologically oriented addresses from provider Classless
      Inter-Domain Routing (CIDR) blocks. </li>
        <li>When a router originates packets, it <bcp14>MAY</bcp14> use as a source
      address either an EID or RLOC. When acting as a host (e.g., when
      terminating a transport session such as Secure Shell (SSH),
      TELNET, or the Simple Network Management Protocol (SNMP)), it
      <bcp14>MAY</bcp14> use an EID that is explicitly assigned for that purpose. An
      EID that identifies the router as a host <bcp14>MUST NOT</bcp14> be used as an
      RLOC; an EID is only routable within the scope of a site.  A
      typical BGP configuration might demonstrate this "hybrid"
      EID/RLOC usage where a router could use its "host-like" EID to
      terminate internal BGP (iBGP) sessions to other routers in a site while at the
      same time using RLOCs to terminate external BGP (eBGP) sessions to routers
      outside the site.</li>
        <li>Packets with EIDs in them are not expected to be delivered
      end to end in the absence of an EID-to-RLOC mapping
      operation. They are expected to be used locally for intra-site
      communication or to be encapsulated for inter-site
      communication.</li>
        <li>EIDs <bcp14>MAY</bcp14> also be structured (subnetted) in a manner suitable
      for local routing within an Autonomous System (AS).</li>
      </ul>
      <t>An additional LISP header <bcp14>MAY</bcp14> be prepended to packets by a
    TE-ITR when rerouting of the path for a packet is desired. A
    potential use case for this would be an ISP router that needs to
    perform Traffic Engineering for packets flowing through its
    network. In such a situation, termed "Recursive Tunneling", an ISP
    transit acts as an additional ITR, and the destination RLOC it
    uses for the new prepended header would be either a TE-ETR within
    the ISP (along an intra-ISP traffic-engineered path) or a TE-ETR
    within another ISP (an inter-ISP traffic-engineered path, where an
      agreement to build such a path exists). </t>
      <t>In order to avoid excessive packet overhead as well as possible
    encapsulation loops, it is  <bcp14>RECOMMENDED</bcp14> that a maximum of two
    LISP headers can be prepended to a packet. For initial LISP
    deployments, it is assumed that two headers is sufficient, where
    the first prepended header is used at a site for separation of location and identity and the second prepended header is used inside a
    service provider for Traffic Engineering purposes.</t>

      <t>Tunnel Routers can be placed fairly flexibly in a multi-AS
    topology. For example, the ITR for a particular end-to-end packet
    exchange might be the first-hop or default router within a site
    for the source host. Similarly, the ETR might be the last-hop
    router directly connected to the destination host. As another
    example, perhaps for a VPN service outsourced to an ISP by a site,
    the ITR could be the site's border router at the service
    provider attachment point. Mixing and matching of site-operated,
    ISP-operated, and other Tunnel Routers is allowed for maximum
    flexibility. </t>
      <section anchor="DPI" numbered="true" toc="default">
        <name>Deployment on the Public Internet</name>
        <t>Several of the mechanisms in this document are intended for deployment in controlled,
           trusted environments and are insecure for use over the public Internet.
           In particular, on the public Internet, xTRs:</t>
        <ul spacing="normal">
          <li><bcp14>MUST</bcp14> set the N-, L-, E-, and V-bits in the LISP header (<xref target="header" format="default"/>) to zero.</li>
          <li><bcp14>MUST NOT</bcp14> use Locator-Status-Bits and Echo-Nonce, as described in <xref target="loc-reach" format="default"/>, for RLOC reachability.
             Instead, they <bcp14>MUST</bcp14> rely solely on control plane methods.</li>
          <li><bcp14>MUST NOT</bcp14> use gleaning or Locator-Status-Bits and Map-Versioning, as described in <xref target="update_mapping" format="default"/>, to update the EID-to-RLOC mappings.
               Instead, they <bcp14>MUST</bcp14> rely solely on control plane methods.</li>
        </ul>
      </section>
      <section anchor="MOSTLY" numbered="true" toc="default">
        <name>Packet Flow Sequence</name>
        <t>This section provides an example of the unicast packet flow,
      also including control plane information as specified in <xref target="RFC9301" format="default"/>.  The example also assumes
      the following conditions:</t>
        <ul spacing="normal">
          <li>Source host "host1.abc.example.com" is sending a
        packet to "host2.xyz.example.com", exactly as it would if the site was
        not using LISP.</li>
          <li>Each site is multihomed, so each Tunnel Router has an
        address (RLOC) assigned from the service provider address
        block for each provider to which that particular Tunnel Router
        is attached.</li>
          <li>The ITR(s) and ETR(s) are directly connected to the source
        and destination, respectively, but the source and destination
        can be located anywhere in the LISP site.</li>
          <li>A Map-Request is sent for an external destination when the
        destination is not found in the forwarding table or matches a
        default route. Map-Requests are sent to the mapping database
        system by using the LISP control plane protocol documented in
        <xref target="RFC9301" format="default"/>.</li>
          <li>Map-Replies are sent on the underlying routing system
        topology, using the
        control plane protocol <xref target="RFC9301" format="default"/>.</li>
        </ul>
        <t>Client host1.abc.example.com wants to communicate with
       server host2.xyz.example.com:</t>
        <ol spacing="normal" type="1">
	  <li>host1.abc.example.com wants to open a TCP connection to
         host2.xyz.example.com. It does a DNS lookup on
         host2.xyz.example.com. An A/AAAA record is returned. This
         address is the destination EID. The locally assigned address
         of host1.abc.example.com is used as the source EID. An IPv4
         or IPv6 packet is built and forwarded through the LISP site
         as a normal IP packet until it reaches a LISP ITR.</li>
          <li>The LISP ITR must be able to map the destination EID to an
         RLOC of one of the ETRs at the destination site. A method
         for doing this is to send a LISP Map-Request, as specified in
         <xref target="RFC9301" format="default"/>.</li>
          <li>The Mapping System helps forward the Map-Request to the
         corresponding ETR. When the Map-Request arrives at one of the
         ETRs at the destination site, it will process the packet as a
         control message.</li>
          <li>The ETR looks at the destination EID of the Map-Request
         and matches it against the prefixes in the ETR's configured
         EID-to-RLOC mapping database.  This is the list of
         EID-Prefixes the ETR is supporting for the site it resides
         in. If there is no match, the Map-Request is
         dropped. Otherwise, a LISP Map-Reply is returned to the
         ITR.</li>
          <li>The ITR receives the Map-Reply message, parses the message,
		 and stores the mapping information from the packet. This information
		 is stored in the ITR's EID-to-RLOC Map-Cache.  Note that the
         Map-Cache is an on-demand cache. An ITR will manage its
         Map-Cache in such a way that optimizes for its resource
         constraints.</li>
          <li>Subsequent packets from host1.abc.example.com to
         host2.xyz.example.com will have a LISP header prepended by
         the ITR using the appropriate RLOC as the LISP header
         destination address learned from the ETR. Note that the
         packet <bcp14>MAY</bcp14> be sent to a different ETR than the one that
         returned the Map-Reply due to the source site's hashing
         policy or the destination site's Locator-Set policy.</li>
          <li>The ETR receives these packets directly (since the
         destination address is one of its assigned IP addresses),
         checks the validity of the addresses, strips the LISP header,
         and forwards packets to the attached destination host.</li>
          <li>In order to defer the need for a mapping lookup in the
          reverse direction, it is <bcp14>OPTIONAL</bcp14> for an ETR to
	  create a cache entry
         that maps the source EID (inner-header source IP address) to
         the source RLOC (outer-header source IP address) in a
         received LISP packet. Such a cache entry is termed a
         "glean mapping" and only contains a single RLOC for the EID
         in question.  More complete information about additional
         RLOCs <bcp14>SHOULD</bcp14> be verified by sending a LISP Map-Request for
         that EID. Both the ITR and the ETR <bcp14>MAY</bcp14> also influence the
         decision the other makes in selecting an RLOC.</li>
        </ol>
      </section>
    </section>
    <section numbered="true" toc="default">
      <name>LISP Encapsulation Details</name>
      <t>Since additional tunnel headers are prepended, the packet
    becomes larger and can exceed the MTU of any link traversed from
    the ITR to the ETR.  It is <bcp14>RECOMMENDED</bcp14> in IPv4 that packets do not
    get fragmented as they are encapsulated by the ITR. Instead, the
    packet is dropped and an ICMPv4 Unreachable / Fragmentation Needed
    message is returned to the source.</t>
      <t>In the case when fragmentation is needed, it is
    <bcp14>RECOMMENDED</bcp14> that implementations provide support for one of the
    proposed fragmentation and reassembly schemes. Two existing
    schemes are detailed in <xref target="fragment" format="default"/>.</t>
      <t>Since IPv4 or IPv6 addresses can be either EIDs or RLOCs, the
    LISP architecture supports IPv4 EIDs with IPv6 RLOCs (where the
    inner header is in IPv4 packet format and the outer header is in
    IPv6 packet format) or IPv6 EIDs with IPv4 RLOCs (where the inner
    header is in IPv6 packet format and the outer header is in IPv4
    packet format). The next sub-sections illustrate packet formats
    for the homogeneous case (IPv4-in-IPv4 and IPv6-in-IPv6), but all
    4 combinations <bcp14>MUST</bcp14> be supported. Additional types of EIDs are
    defined in <xref target="RFC8060" format="default"/>.</t>
      <t>As LISP uses UDP encapsulation to carry traffic between xTRs
    across the Internet, implementors should be aware of the
    provisions of <xref target="RFC8085" format="default"/>, especially those given in its
    Section <xref target="RFC8085" section="3.1.11" sectionFormat="bare"/> on congestion control for UDP tunneling.</t>
      <t>Implementors are encouraged to consider UDP checksum usage
    guidelines in <xref target="RFC8085" sectionFormat="of" section="3.4"/> when it is
    desirable to protect UDP and LISP headers against corruption.</t>
      <section anchor="header" numbered="true" toc="default">
        <name>LISP IPv4-in-IPv4 Header Format</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |Version|  IHL  |    DSCP   |ECN|          Total Length         |
 /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |         Identification        |Flags|      Fragment Offset    |
|   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
OH  |  Time to Live | Protocol = 17 |         Header Checksum       |
|   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |                    Source Routing Locator                     |
 \  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  \ |                 Destination Routing Locator                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |       Source Port = xxxx      |       Dest Port = 4341        |
UDP +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  \ |           UDP Length          |        UDP Checksum           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
L   |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
I \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
S / |                 Instance ID/Locator-Status-Bits               |
P   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |Version|  IHL  |    DSCP   |ECN|          Total Length         |
 /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |         Identification        |Flags|      Fragment Offset    |
|   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
IH  |  Time to Live |    Protocol   |         Header Checksum       |
|   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |                           Source EID                          |
 \  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  \ |                         Destination EID                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    IHL = IP-Header-Length
]]></artwork>
      </section>
      <section numbered="true" toc="default">
        <name>LISP IPv6-in-IPv6 Header Format</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |Version|    DSCP   |ECN|           Flow Label                  |
 /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |         Payload Length        | Next Header=17|   Hop Limit   |
v   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
O   +                                                               +
u   |                                                               |
t   +                     Source Routing Locator                    +
e   |                                                               |
r   +                                                               +
    |                                                               |
H   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
d   |                                                               |
r   +                                                               +
    |                                                               |
^   +                  Destination Routing Locator                  +
|   |                                                               |
 \  +                                                               +
  \ |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |       Source Port = xxxx      |       Dest Port = 4341        |
UDP +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  \ |           UDP Length          |        UDP Checksum           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
L   |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
I \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
S / |                 Instance ID/Locator-Status-Bits               |
P   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  / |Version|    DSCP   |ECN|           Flow Label                  |
 /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/   |         Payload Length        |  Next Header  |   Hop Limit   |
v   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
I   +                                                               +
n   |                                                               |
n   +                          Source EID                           +
e   |                                                               |
r   +                                                               +
    |                                                               |
H   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
d   |                                                               |
r   +                                                               +
    |                                                               |
^   +                        Destination EID                        +
\   |                                                               |
 \  +                                                               +
  \ |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
      </section>
      <section anchor="LRB" numbered="true" toc="default">
        <name>Tunnel Header Field Descriptions</name>
        <dl newline="false" spacing="normal">
          <dt>Inner Header (IH):</dt>
          <dd>The inner header is the header on the datagram
          received from the originating host <xref target="RFC0791" format="default"/>
            <xref target="RFC8200" format="default"/> <xref target="RFC2474" format="default"/>. The
          source and destination IP addresses are EIDs.</dd>
          <dt>Outer Header (OH):</dt>
          <dd>The outer header is a new
          header prepended by an ITR. The address fields contain RLOCs
          obtained from the ingress router's EID-to-RLOC Map-Cache. The IP
          protocol number is "UDP (17)" from <xref target="RFC0768" format="default"/>.  The setting of the Don't Fragment (DF)
          bit 'Flags' field is according to rules listed in Sections
          <xref target="MTU-STATELESS" format="counter"/> and <xref target="MTU-STATEFUL" format="counter"/>.</dd>
          <dt>UDP Header:</dt>
          <dd>The UDP header contains an ITR-selected source port when encapsulating a packet. See <xref target="loc-hash" format="default"/> for details on the hash algorithm used
          to select a source port based on the 5-tuple of the inner
          header. The destination port <bcp14>MUST</bcp14> be set to the well-known
          IANA-assigned port value 4341.</dd>
          <dt>UDP Checksum:</dt>
          <dd>The 'UDP Checksum' field <bcp14>SHOULD</bcp14>
          be transmitted as zero by an ITR for either IPv4 <xref target="RFC0768" format="default"/> or IPv6 encapsulation <xref target="RFC6935" format="default"/> <xref target="RFC6936" format="default"/>.  When a
          packet with a zero UDP checksum is received by an ETR, the
          ETR <bcp14>MUST</bcp14> accept the packet for decapsulation.  When an ITR
          transmits a non-zero value for the UDP checksum, it <bcp14>MUST</bcp14>
          send a correctly computed value in this field.  When an ETR
          receives a packet with a non-zero UDP checksum, it <bcp14>MAY</bcp14>
          choose to verify the checksum value.  If it chooses to
          perform such verification and the verification fails, the
          packet <bcp14>MUST</bcp14> be silently dropped.  If the ETR either chooses not to
          perform the verification or performs the verification
          successfully, the packet <bcp14>MUST</bcp14> be accepted for
          decapsulation. The handling of UDP zero checksums over IPv6
          for all tunneling protocols, including LISP, is subject to
          the applicability statement in <xref target="RFC6936" format="default"/>.</dd>
          <dt>UDP Length:</dt>
          <dd>The 'UDP Length' field is set for
          an IPv4-encapsulated packet to be the sum of the
          inner-header IPv4 Total Length plus the UDP and LISP header
          lengths.  For an IPv6-encapsulated packet, the 'UDP Length'
          field is the sum of the inner-header IPv6 Payload Length,
          the size of the IPv6 header (40 octets), and the size of the
          UDP and LISP headers.</dd>
          <dt>N:</dt>
          <dd>The N-bit is the nonce-present bit. When
          this bit is set to 1, the low-order 24 bits of the first 32
          bits of the LISP header contain a nonce. See <xref target="echo-nonce" format="default"/> for details. Both N- and V-bits <bcp14>MUST
          NOT</bcp14> be set in the same packet. If they are, a decapsulating
          ETR <bcp14>MUST</bcp14> treat the 'Nonce/Map-Version' field as having a
          nonce value present.</dd>
          <dt>L:</dt>
          <dd>The L-bit is the 'Locator-Status-Bits'
          field enabled bit.  When this bit is set to 1, the
          Locator-Status-Bits in the second 32&nbsp;bits of the LISP
          header are in use.</dd>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
 x 1 x x 0 x x x
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Locator-Status-Bits                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        <dl newline="false" spacing="normal">
          <dt>E:</dt>
          <dd>The E-bit is the Echo-Nonce-request bit.
          This bit <bcp14>MUST</bcp14> be ignored and has no meaning when the N-bit
          is set to 0.  When the N-bit is set to 1 and this bit is set
          to 1, an ITR is requesting that the nonce value in the
          'Nonce' field be echoed back in LISP-encapsulated packets
          when the ITR is also an ETR. See <xref target="echo-nonce" format="default"/>
          for details.</dd>
          <dt>V:</dt>
          <dd>The V-bit is the Map-Version present
          bit. When this bit is set to 1, the N-bit <bcp14>MUST</bcp14> be 0. Refer
          to <xref target="RFC9302" format="default"/> for more details on Database Map-Versioning. This
          bit indicates that the LISP header is encoded in this
          case&nbsp;as:</dd>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
 0 x 0 1 x x x x
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|N|L|E|V|I|R|K|K|  Source Map-Version   |   Dest Map-Version    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Instance ID/Locator-Status-Bits               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        <dl newline="false" spacing="normal">
          <dt>I:</dt>
          <dd>The I-bit is the Instance ID bit. See <xref target="instance" format="default"/> for more details. When this bit is set
          to 1, the 'Locator-Status-Bits' field is reduced to 8 bits
          and the high-order 24 bits are used as an Instance ID.  If
          the L-bit is set to 0, then the low-order 8&nbsp;bits are
          transmitted as zero and ignored on receipt. The format of
          the LISP header would look like this:</dd>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
 x x x x 1 x x x
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Instance ID                   |     LSBs      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        <dl newline="false" spacing="normal">
          <dt>R:</dt>
          <dd>The R-bit is a reserved and unassigned bit
          for future use. It <bcp14>MUST</bcp14> be set to 0 on transmit and <bcp14>MUST</bcp14> be
          ignored on receipt.</dd>
          <dt>KK:</dt>
          <dd>The KK-bits are a 2-bit field used when
          encapsulated packets are encrypted.  The field is set to 00
          when the packet is not encrypted.  See <xref target="RFC8061" format="default"/> for further information.</dd>
          <dt>LISP Nonce:</dt>
          <dd>The LISP 'Nonce' field is a 24-bit
          value that is randomly generated by an ITR when the N-bit is
          set to 1. Nonce generation algorithms are an implementation
          matter but are required to generate different nonces when
          sending to different RLOCs.  The nonce is also used when the E-bit is set to
          request the nonce value to be echoed by the other side when
          packets are returned. When the E-bit is clear but the N-bit
          is set, a remote ITR is either echoing a previously
          requested Echo-Nonce or providing a random nonce. See <xref target="echo-nonce" format="default"/> for more details. Finally, when
          both the N- and V-bits are not set (N=0, V=0), then both the 'Nonce'
          and 'Map-Version' fields are set to 0 and ignored on receipt.</dd>
          <dt>LISP Locator-Status-Bits (LSBs):</dt>
          <dd>When the
          L-bit is also set, the 'Locator-Status-Bits' field in the
          LISP header is set by an ITR to indicate to an ETR the
          up/down status of the Locators in the source site. Each RLOC
          in a Map-Reply is assigned an ordinal value from 0 to n-1
          (when there are n RLOCs in a mapping entry). The
          Locator-Status-Bits are numbered from 0 to n-1 from the
          least significant bit of the field.  The field is 32 bits
          when the I-bit is set to 0 and is 8 bits when the I-bit is
          set to 1. When a Locator-Status-Bit is set to 1, the ITR is
          indicating to the ETR that the RLOC associated with the bit
          ordinal has up status. See <xref target="loc-reach" format="default"/> for
          details on how an ITR can determine the status of the ETRs
          at the same site.  When a site has multiple EID-Prefixes
          that result in multiple mappings (where each could have a
          different Locator-Set), the Locator-Status-Bits setting in
          an encapsulated packet <bcp14>MUST</bcp14> reflect the mapping for the
          EID-Prefix that the inner-header source EID address
          matches (longest-match). If the LSB for an anycast Locator is set to 1, then
          there is at least one RLOC with that address, and the ETR is
          considered 'up'.</dd>
        </dl>
        <t>When doing ITR/PITR encapsulation:</t>
        <ul spacing="normal">
          <li>The outer-header 'Time to Live' field (or 'Hop Limit'
           field, in the case of IPv6) <bcp14>SHOULD</bcp14> be copied from the
           inner-header 'Time to Live' field. </li>
          <li>The outer-header IPv4 'Differentiated Services Code Point
	       (DSCP)' field (or 'Traffic Class' field, in the case of
	       IPv6) <bcp14>SHOULD</bcp14> be copied from the inner-header IPv4 'DSCP' field (or
	       'Traffic Class' field, in the case of IPv6) to the
	       outer header. Guidelines for this can be found in <xref target="RFC2983" format="default"/>.</li>
          <li>The IPv4 'Explicit Congestion Notification (ECN)' field and bits
           6 and 7 of the IPv6 'Traffic Class' field require special
           treatment in order to avoid discarding indications of
           congestion as specified in <xref target="RFC6040" format="default"/>.</li>
        </ul>
        <t>When doing ETR/PETR decapsulation:</t>
        <ul spacing="normal">
          <li>The inner-header IPv4 'Time to Live' field (or 'Hop Limit'
	      field, in the case of IPv6) <bcp14>MUST</bcp14> be copied from the
	      outer-header 'Time to Live'/'Hop Limit' field when the Time to Live / Hop Limit
	      value of the outer header is less than the Time to Live / Hop Limit
	      value of the inner header.  Failing to perform this check
	      can cause the Time to Live / Hop Limit of the inner header to increment
	      across encapsulation/decapsulation cycles.  This check is
	      also performed when doing initial encapsulation, when a
	      packet comes to an ITR or PITR destined for a LISP site.</li>
          <li>The outer-header IPv4 'Differentiated Services Code Point
	      (DSCP)' field (or 'Traffic Class' field, in the case of
	      IPv6) <bcp14>SHOULD</bcp14> be copied from the outer-header 'IPv4 DSCP' field (or
	      'Traffic Class' field, in the case of IPv6) to the
	      inner header. Guidelines for this can be found in <xref target="RFC2983" format="default"/>.</li>
          <li>The IPv4 'Explicit Congestion Notification (ECN)' field and bits
          6 and 7 of the IPv6 'Traffic Class' field require special
          treatment in order to avoid discarding indications of
          congestion as specified in <xref target="RFC6040" format="default"/>.  Note
          that implementations exist that copy the 'ECN' field from
          the outer header to the inner header, even though <xref target="RFC6040" format="default"/> does not recommend this behavior.  It is
          <bcp14>RECOMMENDED</bcp14> that implementations change to support the
          behavior discussed in <xref target="RFC6040" format="default"/>.</li>
        </ul>
        <t>Note that if an ETR/PETR is also an ITR/PITR and chooses to
        re-encapsulate after decapsulating, the net effect of this
        is that the new outer header will carry the same Time to
        Live as the old outer header minus 1.</t>
        <t>Copying the Time to Live serves two purposes:
        first, it preserves the distance the host intended the packet to
        travel; second, and more importantly, it provides for
        suppression of looping packets in the event there is a loop of
        concatenated tunnels due to misconfiguration.</t>
        <t> Some xTRs, PETRs, and PITRs perform re-encapsulation operations and
	need to treat ECN functions in a special way. Because the re-encapsulation
	operation is a
        sequence of two operations, namely a decapsulation followed by
        an encapsulation, the ECN bits <bcp14>MUST</bcp14> be treated as described
        above for these two operations.</t>
        <t>
		The LISP data plane protocol is not backwards compatible with
		<xref target="RFC6830" format="default"/> and does not have explicit support for introducing
		future protocol changes (e.g., an explicit version field). However,
		the LISP control plane <xref target="RFC9301" format="default"/> allows an ETR to register
		data plane capabilities by means of new LISP Canonical Address Format (LCAF) types <xref target="RFC8060" format="default"/>.
		In this way, an ITR can be made aware of the data plane capabilities
		of an ETR and encapsulate accordingly. The specification of the new
		LCAF types, the new LCAF mechanisms, and their use are out of the
		scope of this document.
        </t>
      </section>
    </section>
    <section anchor="Map-Cache" numbered="true" toc="default">
      <name>LISP EID-to-RLOC Map-Cache</name>
      <t>ITRs and PITRs maintain an on-demand cache, referred to as the LISP
     EID-to-RLOC Map-Cache, that contains mappings from EID-Prefixes
     to Locator-Sets. The cache is used to encapsulate packets from
     the EID space to the corresponding RLOC network attachment point.</t>
      <t>When an ITR/PITR receives a packet from inside of the LISP
     site to destinations outside of the site, a longest-prefix match
     lookup of the EID is done to the Map-Cache.</t>
      <t>When the lookup succeeds, the Locator-Set retrieved from the
     Map-Cache is used to send the packet to the EID's topological
     location.</t>
      <t>If the lookup fails, the ITR/PITR needs to retrieve the
     mapping using the LISP control plane protocol <xref target="RFC9301" format="default"/>. While the mapping is being retrieved,
	 the ITR/PITR can either drop or buffer the packets. This document does not have specific
	 recommendations about the action to be taken.
	 It is up to the deployer to consider whether or not it is desirable to buffer packets
	 and deploy a LISP implementation that offers the desired behavior. Once the mapping is resolved,
	 it is then stored in the local Map-Cache to forward subsequent packets addressed to
     the same EID-Prefix.</t>
      <t>The Map-Cache is a local cache of mappings; entries are
     expired based on the associated Time to Live. In addition,
     entries can be updated with more current information; see <xref target="update_mapping" format="default"/> for further information on
     this. Finally, the Map-Cache also contains reachability
     information about EIDs and RLOCs and uses LISP reachability
     information mechanisms to determine the reachability of RLOCs;
     see <xref target="loc-reach" format="default"/> for the specific mechanisms.</t>
    </section>
    <section anchor="fragment" numbered="true" toc="default">
      <name>Dealing with Large Encapsulated Packets</name>
      <t>This section proposes two mechanisms to deal with
    packets that exceed the Path MTU (PMTU) between the ITR and ETR.</t>
      <t>It is left to the implementor to decide if the stateless or
    stateful mechanism <bcp14>SHOULD</bcp14> be implemented. Both or neither can be
    used, since it is a local decision in the ITR regarding how
    to deal with MTU issues, and sites can interoperate with differing
    mechanisms.</t>
      <t>Both stateless and stateful mechanisms also apply to
    Re-encapsulating and Recursive Tunneling, so any actions
    below referring to an ITR also apply to a TE-ITR.</t>
      <section anchor="MTU-STATELESS" numbered="true" toc="default">
        <name>A Stateless Solution to MTU Handling</name>
        <t>An ITR stateless solution to handle MTU issues is described as
    follows:</t>
        <ol spacing="normal" type="1">
	  <li>Define H to be the size, in octets, of the outer header an ITR
    prepends to a packet. This includes the UDP and LISP header lengths.</li>
          <li>Define L to be the size, in octets, of the maximum-sized packet
    an ITR can send to an ETR without the need for the ITR or any
    intermediate routers to fragment the packet.
	The network administrator of the LISP deployment has to determine
	what the suitable value of L is, so as to make sure that no MTU issues arise.</li>
          <li>Define an architectural constant S for the maximum size of a
    packet, in octets, an ITR <bcp14>MUST</bcp14> receive from the source so the
    effective MTU can be met. That is, L = S + H.</li>
        </ol>
        <t>When an ITR receives a packet from a site-facing interface and
    adds H octets worth of encapsulation to yield a packet size
    greater than L octets (meaning the received packet size was
    greater than S octets from the source), it resolves the MTU issue
    by first splitting the original packet into 2 equal-sized
    fragments.  A LISP header is then prepended to each fragment. The
    size of the encapsulated fragments is then (S/2 + H), which is
    less than the ITR's estimate of the PMTU between the ITR and
    its correspondent ETR.</t>
        <t>When an ETR receives encapsulated fragments, it treats them
    as two individually encapsulated packets. It strips the LISP
    headers and then forwards each fragment to the destination host of
    the destination site.  The two fragments are reassembled at
    the destination host into the single IP datagram that was
    originated by the source host. Note that reassembly can happen
    at the ETR if the encapsulated packet was fragmented at or after the
    ITR.</t>
        <t>This behavior <bcp14>MUST</bcp14> be implemented by the ITR only when the source
    host originates a packet with the 'DF' field of the IP header set
    to 0.  When the 'DF' field of the IP header is set to 1 or the
    packet is an IPv6 packet originated by the source host, the ITR
    will drop the packet when the size (adding in the size of the
    encapsulation header) is greater than L and send an ICMPv4
    Unreachable / Fragmentation Needed or ICMPv6 Packet Too Big (PTB)
    message to the source with a value of S, where S is (L - H).</t>
        <t>When the outer-header encapsulation uses an IPv4 header, an
    implementation <bcp14>SHOULD</bcp14> set the DF bit to 1 so ETR fragment
    reassembly can be avoided. An implementation <bcp14>MAY</bcp14> set the DF
    bit in such headers to 0 if it has good reason to believe
    there are unresolvable PMTU issues between the sending ITR
    and the receiving ETR.</t>
        <t>It is <bcp14>RECOMMENDED</bcp14> that L be defined as 1500.
    Additional information about in-network MTU and fragmentation issues can be found in <xref target="RFC4459" format="default"/>.</t>
      </section>
      <section anchor="MTU-STATEFUL" numbered="true" toc="default">
        <name>A Stateful Solution to MTU Handling</name>
        <t>An ITR stateful solution to handle MTU issues is described as
    follows:</t>
        <ol spacing="normal" type="1">
	  <li>The ITR will keep state of the effective MTU for each Locator
        per Map-Cache entry. The effective MTU is what the core network
        can deliver along the path between the ITR and ETR.</li>
          <li>When an IPv4-encapsulated packet with the DF bit set to 1 exceeds what the core network
        can deliver, one of the intermediate routers on the path will
        send an ICMPv4
        Unreachable / Fragmentation Needed message to the ITR. The
        ITR will parse the ICMP message to determine which Locator is
        affected by the effective MTU change and then record the new
        effective MTU value in the Map-Cache entry.</li>
          <li>When a packet is received by the ITR from a source inside
        of the site and the size of the packet is greater than the
        effective MTU stored with the Map-Cache entry associated with
        the destination EID the packet is for, the ITR will send an
        ICMPv4 Unreachable / Fragmentation Needed message back to the source. The packet size
        advertised by the ITR in the ICMP message is the effective
        MTU minus the LISP encapsulation length.</li>
        </ol>
        <t>Even though this mechanism is stateful, it has advantages over
    the stateless IP fragmentation mechanism, by not involving the
    destination host with reassembly of ITR fragmented packets.</t>
        <t>Please note that using ICMP packets for PMTU discovery, as described
in <xref target="RFC1191" format="default"/> and <xref target="RFC8201" format="default"/>, can result in suboptimal behavior in the
presence of ICMP packet losses or off-path attackers that spoof ICMP. 
      Possible mitigations include ITRs and ETRs cooperating on MTU probe
      packets <xref target="RFC4821" format="default"/> <xref target="RFC8899" format="default"/> or ITRs
      storing the beginning of large packets to verify that they match
      the echoed packet in an ICMP Fragmentation Needed / PTB message.</t>
      </section>
    </section>
    <section anchor="instance" numbered="true" toc="default">
      <name>Using Virtualization and Segmentation with LISP</name>
      <t>There are several cases where segregation is needed at the
	EID level.  For instance, this is the case for deployments
	containing overlapping addresses, traffic isolation policies,
	or multi-tenant virtualization.  For these and other scenarios
	where segregation is needed, Instance IDs are used.</t>
      <t>An Instance ID can be carried in a LISP-encapsulated
        packet.  An ITR that prepends a LISP header will copy a
        24-bit value used by the LISP router to uniquely identify
        the address space. The value is copied to the 'Instance ID'
        field of the LISP header, and the I-bit is set to&nbsp;1.</t>
      <t>When an ETR decapsulates a packet, the Instance ID from the
        LISP header is used as a table identifier to locate the
        forwarding table to use for the inner destination EID
        lookup.</t>
      <t>For example, an 802.1Q VLAN tag or VPN identifier could be
        used as a 24-bit Instance ID. See <xref target="I-D.ietf-lisp-vpn" format="default"/>
        for details regarding LISP VPN use cases. Please note that the Instance ID
        is not protected; an on-path attacker can modify the tags and, for instance,
        allow communications between logically isolated VLANs.</t>
      <t>Participants within a LISP deployment must agree
          on the meaning of Instance ID values. The source and destination EIDs
          <bcp14>MUST</bcp14> belong to the same Instance ID.
      </t>
      <t>The Instance ID <bcp14>SHOULD NOT</bcp14> be used with overlapping IPv6 EID addresses.</t>
    </section>
    <section numbered="true" toc="default">
      <name>Routing Locator Selection</name>
      <t>The Map-Cache contains the state used by ITRs and PITRs to
		encapsulate packets.  When an ITR/PITR receives a packet from
		inside the LISP site to a destination outside of the site, a
		longest-prefix match lookup of the EID is done to the
		Map-Cache (see <xref target="Map-Cache" format="default"/>). The lookup
		returns a single Locator-Set containing a list of RLOCs
		corresponding to the EID's topological location.  Each RLOC in
		the Locator-Set is associated with a Priority and Weight;
		this information is used to select the RLOC to
		encapsulate.</t>
      <t>The RLOC with the lowest Priority is selected. An RLOC
		with Priority 255 means that it <bcp14>MUST NOT</bcp14> be used for
		forwarding. When multiple RLOCs have the same Priority, then
		the Weight states how to load-balance traffic among them.
		The value of the Weight represents the relative weight of
		the total packets that match the mapping entry.</t>
      <t>The following are different scenarios for choosing
        RLOCs and the controls that are available:</t>
      <ul spacing="normal">
        <li>The server-side returns one RLOC. The client-side can only
        use one RLOC. The server-side has complete control of the
        selection.</li>
        <li>The server-side returns a list of RLOCs where a subset
        of the list has the same best Priority. The client can only use
        the subset list according to the
        weighting assigned by the server-side. In this case, the
        server-side controls both the subset list and load splitting
        across its members. The client-side can use RLOCs outside
        of the subset list if it determines that the subset
        list is unreachable (unless RLOCs are set to a Priority of 255).
        Some sharing of control exists: the server-side determines
        the destination RLOC list and load distribution while the
        client-side has the option of using alternatives to this list if
        RLOCs in the list are unreachable.</li>
        <li>The server-side sets a Weight of zero for the RLOC subset
        list. In this case, the client-side can choose how the traffic
        load is spread across the subset list. See <xref target="loc-hash" format="default"/> for details on load-sharing mechanisms.
        Control is shared by the server-side determining the list and
        the client-side determining load distribution. Again, the
        client can use alternative RLOCs if the server-provided list
        of RLOCs is unreachable.</li>
        <li>Either side (more likely the server-side ETR) decides to "glean"
        the RLOCs. For example, if the server-side ETR gleans RLOCs, then
	the client-side ITR gives the server-side ETR responsibility for
	bidirectional RLOC reachability and preferability.  Server-side
          ETR gleaning of the client-side ITR RLOC is done by caching the
          inner-header source EID and the outer-header source RLOC of
          received packets. The client-side ITR controls how traffic is
	  returned and can, as an alternative, use an outer-header source
	  RLOC, which then can be added to the list the server-side ETR uses
	  to return traffic.  Since no Priority or Weights are provided
          using this method, the server-side ETR <bcp14>MUST</bcp14> assume that each
          client-side ITR RLOC uses the same best Priority with a Weight
          of zero.  In addition, since EID-Prefix encoding cannot be conveyed
          in data packets, the EID-to-RLOC Map-Cache on Tunnel Routers can grow
          very large. Gleaning has several important considerations.
          A "gleaned" Map-Cache entry is only stored and used for a <bcp14>RECOMMENDED</bcp14> period of 3 seconds,
          pending verification.  Verification <bcp14>MUST</bcp14> be performed by
          sending a Map-Request to the source EID (the inner-header IP source
          address) of the received encapsulated packet.  A reply to this
          "verifying Map-Request" is used to fully populate the Map-Cache entry
          for the "gleaned" EID and is stored and used for the time indicated
          in the 'Time to Live' field of a received Map-Reply.  When a verified Map-Cache entry is stored, data gleaning no longer occurs for subsequent
          packets that have a source EID that matches the EID-Prefix of the
          verified entry.  This "gleaning" mechanism <bcp14>MUST NOT</bcp14> be used over
          the public Internet and <bcp14>SHOULD</bcp14> only be used in trusted and closed
          deployments.  Refer to <xref target="SECURITY" format="default"/> for security issues regarding this
          mechanism.</li>
      </ul>
      <t>RLOCs that appear in EID-to-RLOC Map-Reply messages are
        assumed to be reachable when the R-bit <xref target="RFC9301" format="default"/> for the Locator record is set
        to 1.  When the R-bit is set to 0, an ITR or PITR <bcp14>MUST NOT</bcp14>
        encapsulate to the RLOC. Neither the information contained in
        a Map-Reply nor that stored in the mapping database system
        provides reachability information for RLOCs. Note that
        reachability is not part of the Mapping System and is
        determined using one or more of the RLOC
        reachability algorithms described in the next section.</t>
    </section>
    <section anchor="loc-reach" numbered="true" toc="default">
      <name>Routing Locator Reachability</name>
      <t>Several data plane mechanisms for determining RLOC
        reachability are currently defined. Please note that
        additional reachability mechanisms based on the control plane are
        defined in <xref target="RFC9301" format="default"/>.</t>
      <ol spacing="normal" type="1">
	<li>An ETR <bcp14>MAY</bcp14> examine the Locator-Status-Bits in the LISP
            header of an encapsulated data packet received from an
            ITR. If the ETR is also acting as an ITR and has
            traffic to return to the original ITR site, it can use
            this status information to help select an RLOC.</li>
        <li>When an ETR receives an encapsulated packet from an ITR,
            the source RLOC from the outer header of the packet is likely
            to be reachable. Please note that in some scenarios the
            RLOC from the outer header can be a spoofable field.</li>
        <li>An ITR/ETR pair can use the Echo-Noncing Locator
            reachability algorithms described in this section.</li>
      </ol>
      <t>When determining Locator up/down reachability by
        examining the Locator-Status-Bits from the LISP-encapsulated
        data packet, an ETR will receive an up-to-date status from an
        encapsulating ITR about reachability for all ETRs at the
        site.  CE-based ITRs at the source site can determine
        reachability relative to each other using the site IGP as
        follows:</t>
      <ul spacing="normal">
        <li>Under normal circumstances, each ITR will advertise
            a default route into the site IGP.</li>
        <li>If an ITR fails or if the upstream link to its Provider Edge
            fails, its default route will either time out or be
            withdrawn.</li>
      </ul>
      <t>Each ITR can thus observe the presence or lack of a
        default route originated by the others to determine the
        Locator-Status-Bits it sets for them.</t>
      <t>When ITRs at the site are not deployed in CE routers, the IGP
        can still be used to determine the reachability of Locators,
        provided they are injected into the IGP. This is
        typically done when a /32 address is configured on a loopback
        interface.</t>
      <t> RLOCs listed in a Map-Reply are numbered with ordinals
        0 to n-1.  The Locator-Status-Bits in a LISP-encapsulated
        packet are numbered from 0 to n-1 starting with the least
        significant bit. For example, if an RLOC listed in the 3rd
        position of the Map-Reply goes down (ordinal value 2),
        then all ITRs at the site will clear the 3rd least
        significant bit (xxxx x0xx) of the 'Locator-Status-Bits'
        field for the packets they encapsulate.</t>
      <t>When an xTR decides to use Locator-Status-Bits
          to affect reachability information, it acts as follows:
          ETRs decapsulating a packet will check for any change in
          the 'Locator-Status-Bits' field.  When a bit goes from 1 to 0, the
          ETR, if also acting as an ITR, will refrain from encapsulating
          packets to an RLOC that is indicated as down. It will only resume
          using that RLOC if the corresponding Locator-Status-Bit
          returns to a value of 1. Locator-Status-Bits are associated with a Locator-Set
          per EID-Prefix. Therefore, when a Locator becomes unreachable, the
          Locator-Status-Bit that corresponds to that Locator's position in the
          list returned by the last Map-Reply will be set to zero for that
          particular EID-Prefix.
      </t>
      <t>Locator-Status-Bits <bcp14>MUST NOT</bcp14> be used
		over the public Internet and <bcp14>SHOULD</bcp14> only be used  in trusted
		and closed deployments. In addition, Locator-Status-Bits
		<bcp14>SHOULD</bcp14> be coupled with Map-Versioning <xref target="RFC9302" format="default"/>
    to prevent race conditions where Locator-Status-Bits are interpreted as
    referring to different RLOCs than intended. Refer to <xref target="SECURITY" format="default"/>
		for security issues regarding this mechanism.</t>
      <t>If an ITR encapsulates a packet to an ETR and the packet is
        received and decapsulated by the ETR, it is implied, but not
        confirmed by the ITR, that the ETR's RLOC is reachable.  In
        most cases, the ETR can also reach the ITR but cannot assume
        this to be true, due to the possibility of path asymmetry. In
        the presence of unidirectional traffic flow from an ITR to an
        ETR, the ITR <bcp14>SHOULD NOT</bcp14> use the lack of return traffic as an
        indication that the ETR is unreachable. Instead, it <bcp14>MUST</bcp14> use
        an alternate mechanism to determine reachability.</t>
      <t>The security considerations of <xref target="SECURITY" format="default"/>
        related to data plane reachability apply to the data plane
        RLOC reachability mechanisms described in this section.</t>
      <section anchor="echo-nonce" numbered="true" toc="default">
        <name>Echo-Nonce Algorithm</name>
        <t>When data flows bidirectionally between Locators from
         different sites, a data plane mechanism called "nonce
         echoing" can be used to determine reachability between an ITR
         and ETR.  When an ITR wants to solicit a nonce echo, it sets
         the N- and E-bits and places a 24-bit nonce <xref target="RFC4086" format="default"/> in the LISP header of the next
         encapsulated data packet.</t>
        <t>When this packet is received by the ETR, the encapsulated
         packet is forwarded as normal. When the ETR is an xTR
         (co-located as an ITR), it then sends a data packet to the
         ITR (when it is an xTR co-located as an ETR) and includes the
         nonce received earlier with the N-bit set and E-bit
         cleared. The ITR sees this "echoed nonce" and knows that the
         path to and from the ETR is up.</t>
        <t>The ITR will set the E-bit and N-bit for every packet it
         sends while in the Echo-Nonce-request state.  The time the
         ITR waits to process the echoed nonce before it determines that
         the path is unreachable is variable and is a choice left for
         the implementation.</t>
        <t>If the ITR is receiving packets from the ETR but does not
         see the nonce echoed while being in the Echo-Nonce-request
         state, then the path to the ETR is unreachable. This decision
         <bcp14>MAY</bcp14> be overridden by other Locator reachability
         algorithms. Once the ITR determines that the path to the ETR
         is down, it can switch to another Locator for that
         EID-Prefix.</t>
        <t>Note that "ITR" and "ETR" are relative terms here. Both
         devices <bcp14>MUST</bcp14> be implementing both ITR and ETR functionality
         for the Echo-Nonce mechanism to operate.</t>
        <t>The ITR and ETR <bcp14>MAY</bcp14> both go into the Echo-Nonce-request
         state at the same time. The number of packets sent or the
         time during which Echo-Nonce request packets are sent is an
         implementation-specific setting. In this case, an xTR
         receiving the Echo-Nonce request packets will suspend
         the Echo-Nonce state and set up an 'Echo-Nonce-request-state' timer.
         After the 'Echo-Nonce-request-state' timer expires, it will resume
         the Echo-Nonce state.</t>
        <t>This mechanism does not completely solve the forward path
         reachability problem, as traffic may be unidirectional. That
         is, the ETR receiving traffic at a site <bcp14>MAY</bcp14> not be the same
         device as an ITR that transmits traffic from that site, or
         the site-to-site traffic is unidirectional so there is no ITR
         returning traffic.</t>
        <t>The Echo-Nonce algorithm is bilateral. That is, if one
         side sets the E-bit and the other side is not enabled for
         Echo-Noncing, then the echoing of the nonce does not occur
         and the requesting side may erroneously consider the Locator
         unreachable. An ITR <bcp14>SHOULD</bcp14> set the E-bit in an
         encapsulated data packet when it knows the ETR is enabled for
         Echo-Noncing. This is conveyed by the E-bit in the
         Map-Reply message.</t>
        <t>Many implementations default to not advertising that they are
         Echo-Nonce capable in Map-Reply messages, and so RLOC-Probing tends
         to be used for RLOC reachability.</t>
        <t>The Echo-Nonce mechanism <bcp14>MUST NOT</bcp14> be used
		over the public Internet and <bcp14>MUST</bcp14> only be used in trusted
		and closed deployments. Refer to <xref target="SECURITY" format="default"/> for
		security issues regarding this mechanism.</t>
      </section>
    </section>
    <section anchor="eid-reach" numbered="true" toc="default">
      <name>EID Reachability within a LISP Site</name>
      <t>A site <bcp14>MAY</bcp14> be multihomed using two or more ETRs.  The hosts
        and infrastructure within a site will be addressed using one
        or more EID-Prefixes that are mapped to the RLOCs of the
        relevant ETRs in the Mapping System.  One possible failure
        mode is for an ETR to lose reachability to one or more of the
        EID-Prefixes within its own site. When this occurs when the
        ETR sends Map-Replies, it can clear the R-bit associated with
        its own Locator. And when the ETR is also an ITR, it can clear
        its Locator-Status-Bit in the encapsulation data header.</t>
      <t>It is recognized that there are no simple solutions to the
        site partitioning problem because it is hard to know which
        part of the EID-Prefix range is partitioned and which Locators
        can reach any sub-ranges of the EID-Prefixes. Note that this
        is not a new problem introduced by the LISP architecture. At the time of
        this writing, this problem exists when a multihomed site uses BGP to
        advertise its reachability upstream.</t>
    </section>
    <section anchor="loc-hash" numbered="true" toc="default">
      <name>Routing Locator Hashing</name>
      <t>When an ETR provides an EID-to-RLOC mapping in a
          Map-Reply message that is stored in the Map-Cache of a
          requesting ITR, the Locator-Set for the EID-Prefix <bcp14>MAY</bcp14>
          contain different Priority and Weight values for each
          Routing Locator Address.  When more than one best Priority Locator
          exists, the ITR can decide how to load-share traffic against
          the corresponding Locators.</t>
      <t>The following hash algorithm <bcp14>MAY</bcp14> be used by an ITR to
          select a Locator for a packet destined to an EID for the
          EID-to-RLOC mapping:</t>
      <ol spacing="normal" type="1">
	<li>Either a source and destination address hash or the
            commonly used 5-tuple hash can be used.  The commonly used
            5-tuple hash includes the source and destination
            addresses; source and destination TCP, UDP, or Stream
            Control Transmission Protocol (SCTP) port numbers; and the
            IP protocol number field or IPv6 next-protocol fields of a
            packet that a host originates from within a LISP
            site. When a packet is not a TCP, UDP, or SCTP packet, the
            source and destination addresses only from the header are
            used to compute the hash.</li>
        <li>Take the hash value and divide it by the number of
            Locators stored in the Locator-Set for the EID-to-RLOC
            mapping.</li>
        <li>The remainder will yield a value of 0 to "number of
            Locators minus 1". Use the remainder to select the Locator
            in the Locator-Set.</li>
      </ol>
      <t>The specific hash algorithm the ITR uses for load-sharing
        is out of scope for this document and does not prevent
        interoperability.</t>
      <t>The source port <bcp14>SHOULD</bcp14> be the same for all packets belonging to the
		same flow. Also note that when a packet is LISP encapsulated, the source
        port number in the outer UDP header needs to be set. Selecting
        a hashed value allows core routers that are attached to Link
        Aggregation Groups (LAGs) to load-split the encapsulated
        packets across member links of such LAGs. Otherwise, core
        routers would see a single flow, since packets have a source
        address of the ITR, for packets that are originated by
        different EIDs at the source site. A suggested setting for the
        source port number computed by an ITR is a 5-tuple hash
        function on the inner header, as described above. The source
        port <bcp14>SHOULD</bcp14> be the same for all packets belonging to the same
        flow.</t>
      <t>Many core router implementations use a 5-tuple hash to decide
        how to balance packet load across members of a LAG. The 5-tuple
        hash includes the source and destination addresses of the packet
        and the source and destination ports when the protocol number in
        the packet is TCP or UDP. For this reason, UDP encoding is
        used for LISP encapsulation. In this scenario, when the outer header is IPv6, the flow label <bcp14>MAY</bcp14> also be
          set following the procedures specified in <xref target="RFC6438" format="default"/>. When the inner header
          is IPv6 and the flow label is not zero, it <bcp14>MAY</bcp14> be used to compute the hash.</t>
    </section>
    <section anchor="update_mapping" numbered="true" toc="default">
      <name>Changing the Contents of EID-to-RLOC Mappings</name>
      <t>Since the LISP architecture uses a caching scheme to
    retrieve and store EID-to-RLOC mappings, the only way an ITR
    can get a more up-to-date mapping is to re-request the
    mapping. However, the ITRs do not know when the mappings
    change, and the ETRs do not keep track of which ITRs
    requested their mappings. For scalability reasons, it is
    desirable to maintain this approach, but implementors need to provide a
    way for ETRs to change their mappings and inform the sites
    that are currently communicating with the ETR site using
    such mappings.</t>

      <t>This section defines two data plane mechanism for updating
  EID-to-RLOC mappings. Additionally, the Solicit-Map-Request
  (SMR) control plane updating mechanism is specified in <xref target="RFC9301" format="default"/>.</t>
      <section anchor="lsb-changing" numbered="true" toc="default">
        <name>Locator-Status-Bits</name>
        <t>Locator-Status-Bits (LSBs) can also be used to keep track of the
  Locator status (up or down) when EID-to-RLOC mappings are changing. When LSBs are used in a LISP deployment, all LISP Tunnel Routers <bcp14>MUST</bcp14> implement both ITR and ETR capabilities (therefore, all Tunnel Routers are effectively xTRs). In this section, the term "source xTR" is used to refer to the xTR setting the LSB and "destination xTR" is used to refer to the xTR receiving the LSB. The procedure is as follows:
        </t>
<ol spacing="normal" type="1">
        <li>When a Locator record is added or removed from the Locator-Set, the source xTR
  will signal this by sending an SMR control plane message <xref target="RFC9301" format="default"/> to the destination xTR. At this point, the source xTR <bcp14>MUST NOT</bcp14> use the LSB field, when the L-bit is 0,
since the destination xTR site has outdated information.
The source xTR will set up a 'use-LSB' timer.</li>
        <li>As defined in <xref target="RFC9301" format="default"/>,
upon reception of the SMR message, the destination xTR will retrieve the updated
EID-to-RLOC mappings by sending a Map-Request.</li>
        <li>When the 'use-LSB' timer expires, the source xTR can use the LSB again with the destination xTR to signal the Locator status (up or down).
  The specific value for the 'use-LSB' timer depends on the LISP deployment; the 'use-LSB' timer needs to be large enough
for the destination xTR to retrieve the updated EID-to-RLOC mappings. A <bcp14>RECOMMENDED</bcp14> value for the 'use-LSB' timer is 5 minutes.</li>
</ol>
      </section>
      <section anchor="map-versioning" numbered="true" toc="default">
        <name>Database Map-Versioning</name>
        <t>When there is unidirectional packet flow between an ITR and
    ETR, and the EID-to-RLOC mappings change on the ETR, it needs to
    inform the ITR so encapsulation to a removed Locator can stop
    and can instead be started to a new Locator in the
    Locator-Set.</t>
	<t>An ETR can send Map-Reply messages carrying a Map-Version Number <xref target="RFC9302"/> in
   an EID-Record.  This is known as the Destination Map-Version Number.
   ITRs include the Destination Map-Version Number in packets they
   encapsulate to the site.</t>
        <t>An ITR, when it encapsulates packets to ETRs, can convey its own Map-
   Version Number.  This is known as the Source Map-Version Number.</t>
        <t>When presented in EID-Records of Map-Register messages <xref target="RFC9301"/>, a Map-Version
   Number is a good way for the Map-Server <xref target="RFC9301"/> to assure that all ETRs for a
   site registering to it are synchronized according to the Map-Version
   Number.</t>
        <t>See <xref target="RFC9302" format="default"/> for a more
    detailed analysis and description of Database
    Map-Versioning.</t>
      </section>
    </section>
    <section anchor="multicast" numbered="true" toc="default">
      <name>Multicast Considerations</name>
      <t>A multicast group address, as defined in the original Internet
       architecture, is an identifier of a grouping of topologically
       independent receiver host locations.  The address encoding itself
       does not determine the location of the receiver(s).  The multicast
       routing protocol and the network-based state the protocol creates
       determine where the receivers are located.</t>
      <t>In the context of LISP, a multicast group address is both an
       EID and an RLOC.  Therefore, no specific semantic or
       action needs to be taken for a destination address, as it would
       appear in an IP header.  Therefore, a group address that
       appears in an inner IP header built by a source host will be
       used as the destination EID.  The outer IP header (the
       destination RLOC address), prepended by a LISP
       router, can use the same group address as the destination
       RLOC, use a multicast or unicast RLOC
       obtained from a Mapping System lookup, or use other means to
       determine the group address mapping.</t>
      <t>With respect to the source RLOC address, the ITR
       prepends its own IP address as the source address of the outer
       IP header, just like it would if the destination EID was a
       unicast address. This source RLOC address, like any
       other RLOC address, <bcp14>MUST</bcp14> be routable on the underlay.</t>
      <t>There are two approaches for LISP-Multicast <xref target="RFC6831" format="default"/>: one that uses
       native multicast routing in the underlay with no support from
       the Mapping System and another that uses only unicast routing
       in the underlay with support from the Mapping System. See <xref target="RFC6831" format="default"/> and <xref target="RFC8378" format="default"/>, respectively,
       for details. Details for LISP-Multicast and interworking with
       non-LISP sites are described in <xref target="RFC6831" format="default"/> and
       <xref target="RFC6832" format="default"/>, respectively.</t>
    </section>
    <section anchor="PUNT" numbered="true" toc="default">
      <name>Router Performance Considerations</name>
      <t>LISP is designed to be very "hardware based and forwarding
        friendly". A few implementation techniques can be used to
        incrementally implement LISP:</t>
      <ul spacing="normal">
        <li>When a tunnel-encapsulated packet is received by an
            ETR, the outer destination address may not be the address
            of the router. This makes it challenging for the control
            plane to get packets from the hardware. This may be
            mitigated by creating special Forwarding Information Base
            (FIB) entries for the EID-Prefixes of EIDs served by the
            ETR (those for which the router provides an RLOC
            translation).  These FIB entries are marked with a flag
            indicating that control plane processing <bcp14>SHOULD</bcp14> be
            performed. The forwarding logic of testing for particular
            IP protocol number values is not necessary. There are a
            few proven cases where no changes to existing deployed
            hardware were needed to support the LISP data plane.</li>
        <li>On an ITR, prepending a new IP header consists of adding
            more octets to a Message Authentication Code (MAC) rewrite string and prepending the
            string as part of the outgoing encapsulation
            procedure.  Routers that support Generic Routing Encapsulation
            (GRE) tunneling <xref target="RFC2784" format="default"/> or 6to4 tunneling
            <xref target="RFC3056" format="default"/> may already support this
            action.</li>
        <li>A packet's source address or the interface on which the
            packet was received can be used to select
            Virtual Routing and Forwarding (VRF). The VRF system's routing table
            can be used to find EID-to-RLOC mappings.</li>
      </ul>
      <t>For performance issues related to Map-Cache management, see
        <xref target="SECURITY" format="default"/>.</t>
    </section>
    <section anchor="SECURITY" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>In what follows, we highlight security
  considerations that apply when LISP is deployed in environments such
  as those specified in <xref target="soa" format="default"/>.</t>
      <t>The optional gleaning mechanism is offered to directly obtain
  a mapping from the LISP-encapsulated packets. Specifically, an xTR
  can learn the EID-to-RLOC mapping by inspecting the source RLOC and
  source EID of an encapsulated packet and insert this new mapping
  into its Map-Cache. An off-path attacker can spoof the source EID
  address to divert the traffic sent to the victim's spoofed EID. If
  the attacker spoofs the source RLOC, it can mount a DoS attack by
  redirecting traffic to the spoofed victim's RLOC, potentially
  overloading it.</t>
      <t>The LISP data plane defines several mechanisms to monitor RLOC
  data plane reachability; in this context, Locator-Status-Bits,
  nonce-present bits, and Echo-Nonce bits of the LISP encapsulation header
  can be manipulated by an attacker to mount a DoS attack. An off-path
  attacker able to spoof the RLOC and/or nonce of a victim's xTR can
  manipulate such mechanisms to declare false information about the
  RLOC's reachability status.</t>
      <t>An example of such attacks is when an off-path attacker can exploit the
  Echo-Nonce mechanism by sending data packets to an ITR with a random
  nonce from an ETR's spoofed RLOC. Note that the attacker only has a small window
  of time within which to guess a valid nonce that the ITR is requesting to be echoed. The goal is to convince the ITR that the ETR's RLOC is
  reachable even when it may not be reachable. If the attack is
  successful, the ITR believes the wrong reachability status of the
  ETR's RLOC until RLOC-Probing detects the correct status. This time
  frame is on the order of tens of seconds.  This specific attack can
  be mitigated by preventing RLOC spoofing in the network by deploying
  Unicast Reverse Path Forwarding (uRPF) per <xref target="RFC8704" format="default">BCP 84</xref>. In order to exploit
  this vulnerability, the off-path attacker must also send Echo-Nonce
  packets at a high rate. If the nonces have never been requested by the
  ITR, it can protect itself from erroneous reachability attacks.</t>
      <t>A LISP-specific uRPF check is also possible. When decapsulating,
    an ETR can check that the source EID and RLOC are valid EID-to-RLOC
    mappings by checking the Mapping System.</t>
      <t>Map-Versioning is a data plane mechanism used to signal to a peering
  xTR that a local EID-to-RLOC mapping has been updated so that the
  peering xTR uses a LISP control plane signaling message to retrieve a
  fresh mapping.  This can be used by an attacker to forge the
  'Map-Version' field of a LISP-encapsulated header and force an
  excessive amount of signaling between xTRs that may overload them.
  Further security considerations on Map-Versioning can be found  in
      <xref target="RFC9302" format="default"/>.</t>
      <t>Locator-Status-Bits, the Echo-Nonce mechanism, and Map-Versioning <bcp14>MUST NOT</bcp14> be used
  over the public Internet and <bcp14>SHOULD</bcp14> only be used  in trusted
  and closed deployments. In addition, Locator-Status-Bits
  <bcp14>SHOULD</bcp14> be coupled with Map-Versioning to prevent race conditions
  where Locator-Status-Bits are interpreted as referring to different RLOCs than intended.</t>
      <t>LISP implementations and deployments that permit outer header fragments
  of IPv6 LISP-encapsulated packets as a means of dealing with MTU issues
  should also use implementation techniques in ETRs to prevent this
  from being a DoS attack vector. Limits on the number of fragments
  awaiting reassembly at an ETR, RTR, or PETR, and the rate of admitting
  such fragments, may be used.</t>
    </section>
    <section numbered="true" toc="default">
      <name>Network Management Considerations</name>
      <t>Considerations for network management tools exist so the LISP
  protocol suite can be operationally managed.  These mechanisms can
  be found in <xref target="RFC7052" format="default"/> and <xref target="RFC6835" format="default"/>.</t>
    </section>
    <section numbered="true" toc="default">
      <name>Changes since RFC 6830</name>
      <t>For implementation considerations, the following changes have been made
  to this document since <xref target="RFC6830" format="default"/> was published:</t>
      <ul spacing="normal">
        <li>It is no longer mandated that a maximum number of 2 LISP
    headers be prepended to a packet. If there is an application need
    for more than 2 LISP headers, an implementation can support
    more. However, it is <bcp14>RECOMMENDED</bcp14> that a maximum of 2 LISP
    headers can be prepended to a packet.</li>
        <li>The 3 reserved flag bits in the LISP header have been allocated
    for <xref target="RFC8061" format="default"/>. The low-order 2 bits of the 3-bit
    field (now named the KK-bits) are used as a key identifier. The 1
    remaining bit is still documented as reserved and unassigned.</li>
        <li>Data plane gleaning for creating Map-Cache entries has been
    made optional. Any ITR implementations that depend on or assume that the
    remote ETR is gleaning should not do so. This does not create any
    interoperability problems, since the control plane Map-Cache
    population procedures are unilateral and are the typical method
    for populating the Map-Cache.</li>
        <li>Most of the changes to this document, which reduce its
    length, are due to moving the LISP control plane messaging and
    procedures to <xref target="RFC9301" format="default"/>.</li>
      </ul>
    </section>
    <section anchor="IANA" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <t>This section provides guidance to the Internet Assigned Numbers
  Authority (IANA) regarding registration of values related to this
  data plane LISP specification, in accordance with <xref target="RFC8126" format="default">BCP 26</xref>.</t>
      <section numbered="true" toc="default">
        <name>LISP UDP Port Numbers</name>
        <t>IANA has allocated UDP port number 4341 for the
    LISP data plane. IANA has updated the description for UDP port
    4341 as follows:</t>
<table anchor="iana-port-number">
  <name></name>
  <thead>
    <tr>
      <th>Service Name</th>
      <th>Port Number</th>
      <th>Transport Protocol</th>
      <th>Description</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>lisp-data</td>
      <td>4341</td>
      <td>udp</td>
      <td>LISP Data Packets</td>
      <td>RFC 9300</td>
    </tr>
  </tbody>
</table>
      </section>
    </section>
  </middle>
  <back>

<displayreference target="I-D.ietf-lisp-vpn" to="LISP-VPN"/>

    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8704.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6040.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2474.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8200.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0768.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6438.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0791.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2983.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6830.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6831.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8378.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>

<reference anchor='RFC9301' target="https://www.rfc-editor.org/info/rfc9301">
<front>
<title>Locator/ID Separation Protocol (LISP) Control Plane</title>
<author initials='D' surname='Farinacci' fullname='Dino Farinacci'>
    <organization />
</author>
<author initials='F' surname='Maino' fullname='Fabio Maino'>
    <organization />
</author>
<author initials='V' surname='Fuller' fullname='Vince Fuller'>
    <organization />
</author>
<author initials='A' surname='Cabellos' fullname='Albert Cabellos' role='editor'> 
    <organization />
</author>
<date month='October' year='2022' />
</front>
<seriesInfo name="RFC" value="9301"/>
<seriesInfo name="DOI" value="10.17487/RFC9301"/>
</reference>

<reference anchor='RFC9302' target="https://www.rfc-editor.org/info/rfc9302">
<front>
<title>Locator/ID Separation Protocol (LISP) Map-Versioning</title>
<author initials='L' surname='Iannone' fullname='Luigi Iannone'>
    <organization />
</author>
<author initials='D' surname='Saucez' fullname='Damien Saucez'>
    <organization />
</author>
<author initials='O' surname='Bonaventure' fullname='Olivier Bonaventure'>
    <organization />
</author>
<date month='October' year='2022'/>
</front>
<seriesInfo name="RFC" value="9302"/>
<seriesInfo name="DOI" value="10.17487/RFC9302"/>
</reference>

      </references>

      <references>
        <name>Informative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1191.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8201.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8899.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4821.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2453.xml"/>
	<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2677.xml"/>
	<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4760.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4086.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4459.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8061.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7215.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7052.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3261.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2784.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3056.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4984.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6832.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6835.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8060.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6935.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6936.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8085.xml"/>

<reference anchor='RFC9299' target="https://www.rfc-editor.org/info/rfc9299">
<front>
<title>An Architectural Introduction to the Locator/ID Separation Protocol (LISP)</title>
<author initials='A' surname='Cabellos' fullname='Albert Cabellos'> 
    <organization />
</author>
<author initials='D' surname='Saucez' fullname='Damien Saucez' role='editor'> 
    <organization />
</author>
<date month='October' year='2022' />
</front>
<seriesInfo name="RFC" value="9299"/>
<seriesInfo name="DOI" value="10.17487/RFC9299"/>
</reference>

        <xi:include href="https://datatracker.ietf.org/doc/bibxml3/draft-ietf-lisp-vpn.xml"/>

        <reference anchor="CHIAPPA" target="http://mercury.lcs.mit.edu/~jnc/tech/endpoints.txt">
          <front>
            <title>Endpoints and Endpoint Names: A Proposed Enhancement to the Internet Architecture
            </title>
            <author initials="J." surname="Chiappa" fullname="J. Noel Chiappa">
              <organization/>
            </author>
            <date year="1999"/>
          </front>
        </reference>

        <reference anchor="AFN" target="http://www.iana.org/assignments/address-family-numbers">
          <front>
            <title>Address Family Numbers</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
	</reference>
      </references>
    </references>
    <section numbered="false" toc="default">
      <name>Acknowledgments</name>
      <t>An initial thank you goes to <contact fullname="Dave Oran"/> for planting the seeds for
  the initial ideas for LISP. His consultation continues to provide
  value to the LISP authors.</t>
      <t>A special and appreciative thank you goes to <contact fullname="Noel Chiappa"/> for
  providing architectural impetus over the past decades on separation
  of location and identity, as well as detailed reviews of the LISP
  architecture and documents, coupled with enthusiasm for making LISP
  a practical and incremental transition for the Internet.</t>
      <t>The original authors would like to gratefully acknowledge many people who
  have contributed discussions and ideas to the making of this
  proposal.  They include <contact fullname="Scott Brim"/>, <contact fullname="Andrew Partan"/>, <contact fullname="John Zwiebel"/>,
  <contact fullname="Jason Schiller"/>, <contact fullname="Lixia Zhang"/>, <contact fullname="Dorian Kim"/>, <contact fullname="Peter Schoenmaker"/>, <contact fullname="Vijay
  Gill"/>, <contact fullname="Geoff Huston"/>, <contact fullname="David Conrad"/>, <contact fullname="Mark Handley"/>, <contact fullname="Ron Bonica"/>, <contact fullname="Ted
  Seely"/>, <contact fullname="Mark Townsley"/>, <contact fullname="Chris Morrow"/>, <contact fullname="Brian Weis"/>, <contact fullname="Dave McGrew"/>, <contact fullname="Peter
  Lothberg"/>, <contact fullname="Dave Thaler"/>, <contact fullname="Eliot Lear"/>, <contact fullname="Shane Amante"/>, <contact fullname="Ved Kafle"/>, <contact fullname="Olivier
  Bonaventure"/>, <contact fullname="Luigi Iannone"/>, <contact fullname="Robin Whittle"/>, <contact fullname="Brian Carpenter"/>, <contact fullname="Joel
  Halpern"/>, <contact fullname="Terry Manderson"/>, <contact fullname="Roger Jorgensen"/>, <contact fullname="Ran Atkinson"/>, <contact fullname="Stig
  Venaas"/>, <contact fullname="Iljitsch van Beijnum"/>, <contact fullname="Roland Bless"/>, <contact fullname="Dana Blair"/>, <contact fullname="Bill Lynch"/>,
  <contact fullname="Marc Woolward"/>, <contact fullname="Damien Saucez"/>, <contact fullname="Damian Lezama"/>, <contact fullname="Attilla De Groot"/>,
  <contact fullname="Parantap Lahiri"/>, <contact fullname="David Black"/>, <contact fullname="Roque Gagliano"/>, <contact fullname="Isidor Kouvelas"/>,
  <contact fullname="Jesper Skriver"/>, <contact fullname="Fred Templin"/>, <contact fullname="Margaret Wasserman"/>, <contact fullname="Sam Hartman"/>,
  <contact fullname="Michael Hofling"/>, <contact fullname="Pedro Marques"/>, <contact fullname="Jari Arkko"/>, <contact fullname="Gregg Schudel"/>, <contact fullname="Srinivas
  Subramanian"/>, <contact fullname="Amit Jain"/>, <contact fullname="Xu Xiaohu"/>, <contact fullname="Dhirendra Trivedi"/>, <contact fullname="Yakov Rekhter"/>,
  <contact fullname="John Scudder"/>, <contact fullname="John Drake"/>, <contact fullname="Dimitri Papadimitriou"/>, <contact fullname="Ross Callon"/>, <contact fullname="Selina
  Heimlich"/>, <contact fullname="Job Snijders"/>, <contact fullname="Vina Ermagan"/>, <contact fullname="Fabio Maino"/>, <contact fullname="Victor Moreno"/>,
  <contact fullname="Chris White"/>, <contact fullname="Clarence Filsfils"/>, <contact fullname="Alia Atlas"/>, <contact fullname="Florin Coras"/>, and <contact fullname="Alberto
  Rodriguez"/>.</t>
      <t>This work originated in the Routing Research Group (RRG) of the
  IRTF. An individual submission was converted into the IETF LISP
  Working Group document that became this RFC.</t>
      <t>The LISP Working Group would like to give a special thanks to
  <contact fullname="Jari Arkko"/>, the Internet Area AD at the time that the set of LISP
  documents was being prepared for IESG Last Call, for his
  meticulous reviews and detailed commentaries on the 7 Working Group
  Last Call documents progressing toward Standards Track RFCs.</t>
      <t>The current authors would like to give a sincere thank you to the
  people who helped put LISP on the Standards Track in the IETF.  They
  include <contact fullname="Joel Halpern"/>, <contact fullname="Luigi Iannone"/>, <contact fullname="Deborah Brungard"/>, <contact fullname="Fabio Maino"/>,
  <contact fullname="Scott Bradner"/>, <contact fullname="Kyle Rose"/>, <contact fullname="Takeshi Takahashi"/>, <contact fullname="Sarah Banks"/>, <contact fullname="Pete Resnick"/>,
  <contact fullname="Colin Perkins"/>, <contact fullname="Mirja Khlewind"/>, <contact fullname="Francis Dupont"/>, <contact fullname="Benjamin Kaduk"/>, <contact fullname="Eric
  Rescorla"/>, <contact fullname="Alvaro Retana"/>, <contact fullname="Alexey Melnikov"/>, <contact fullname="Alissa Cooper"/>, <contact fullname="Suresh
  Krishnan"/>, <contact fullname="Alberto Rodriguez-Natal"/>, <contact fullname="Vina Ermagan"/>, <contact fullname="Mohamed Boucadair"/>,
  <contact fullname="Brian Trammell"/>, <contact fullname="Sabrina Tanamal"/>, and <contact fullname="John Drake"/>. The contributions
  they offered greatly added to the security, scale, and robustness of
  the LISP architecture and protocols.</t>
    </section>
  </back>
</rfc>
